<html><head></head><body>
		<div id="_idContainer041">
			<h1 id="_idParaDest-54" class="chapter-number"><a id="_idTextAnchor064"/><span class="koboSpan" id="kobo.1.1">3</span></h1>
			<h1 id="_idParaDest-55"><a id="_idTextAnchor065"/><span class="koboSpan" id="kobo.2.1">Data Profiling – Understanding Data Structure, Quality, and Distribution</span></h1>
			<p><strong class="bold"><span class="koboSpan" id="kobo.3.1">Data profiling</span></strong><span class="koboSpan" id="kobo.4.1"> refers to </span><a id="_idIndexMarker166"/><span class="koboSpan" id="kobo.5.1">scrutinizing, understanding, and validating datasets to learn more about their underlying structure, patterns, and quality. </span><span class="koboSpan" id="kobo.5.2">It is a critical step in data management and ingestion as it can enhance data quality and accuracy and ensure compliance with regulatory standards. </span><span class="koboSpan" id="kobo.5.3">In this chapter, you will learn how to perform profiling with different tools and how to change your tactics as the data </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">volume increases.</span></span></p>
			<p><span class="koboSpan" id="kobo.7.1">In this chapter, we will deep dive into the </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">following topics:</span></span></p>
			<ul>
				<li><span class="koboSpan" id="kobo.9.1">Understanding </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">data profiling</span></span></li>
				<li><span class="koboSpan" id="kobo.11.1">Data profiling with the </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">pandas profiler</span></span></li>
				<li><span class="koboSpan" id="kobo.13.1">Data validation with </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">Great Expectations</span></span></li>
				<li><span class="koboSpan" id="kobo.15.1">Comparing Great Expectations and the pandas profiler – when to </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">use what</span></span></li>
				<li><span class="koboSpan" id="kobo.17.1">How to profile big </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">data volumes</span></span></li>
			</ul>
			<h1 id="_idParaDest-56"><a id="_idTextAnchor066"/><span class="koboSpan" id="kobo.19.1">Technical requirements</span></h1>
			<p><span class="koboSpan" id="kobo.20.1">For this chapter, you will need to install a Python interpreter that can be downloaded and installed using the instructions given </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">here: </span></span><a href="https://www.python.org/downloads/"><span class="No-Break"><span class="koboSpan" id="kobo.22.1">https://www.python.org/downloads/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.23.1">.</span></span></p>
			<p><span class="koboSpan" id="kobo.24.1">You can find all the code for the chapter in the following GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">repository: </span></span><a href="https://github.com/PacktPublishing/Python-Data-Cleaning-and-Preparation-Best-Practices/tree/main/chapter03"><span class="No-Break"><span class="koboSpan" id="kobo.26.1">https://github.com/PacktPublishing/Python-Data-Cleaning-and-Preparation-Best-Practices/tree/main/chapter03</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.27.1">.</span></span></p>
			<h1 id="_idParaDest-57"><a id="_idTextAnchor067"/><span class="koboSpan" id="kobo.28.1">Understanding data profiling</span></h1>
			<p><span class="koboSpan" id="kobo.29.1">If you have </span><a id="_idIndexMarker167"/><span class="koboSpan" id="kobo.30.1">never heard of </span><strong class="bold"><span class="koboSpan" id="kobo.31.1">data profiling</span></strong><span class="koboSpan" id="kobo.32.1"> before starting this chapter, it is a comprehensive process that involves analyzing and examining data from various sources to gain insights into the structure, quality, and overall characteristics of a dataset. </span><span class="koboSpan" id="kobo.32.2">Let’s start by describing the main goals of </span><span class="No-Break"><span class="koboSpan" id="kobo.33.1">data profiling.</span></span></p>
			<h2 id="_idParaDest-58"><a id="_idTextAnchor068"/><span class="koboSpan" id="kobo.34.1">Identifying goals of data profiling</span></h2>
			<p><span class="koboSpan" id="kobo.35.1">Data profiling helps us understand the structure and quality of the data. </span><span class="koboSpan" id="kobo.35.2">As a result, we can get </span><a id="_idIndexMarker168"/><span class="koboSpan" id="kobo.36.1">a better idea of the best way to organize the different datasets, identify potential data integration challenges, assess data quality, and identify and address issues that may affect the reliability and trustworthiness of </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">the data.</span></span></p>
			<p><span class="koboSpan" id="kobo.38.1">Let’s deep dive into the three main goals of </span><span class="No-Break"><span class="koboSpan" id="kobo.39.1">data profilin</span><a id="_idTextAnchor069"/><span class="koboSpan" id="kobo.40.1">g.</span></span></p>
			<h3><span class="koboSpan" id="kobo.41.1">Data structure</span></h3>
			<p><span class="koboSpan" id="kobo.42.1">One of the main goals of data profiling is to understand the data’s structure. </span><span class="koboSpan" id="kobo.42.2">This entails examining </span><a id="_idIndexMarker169"/><span class="koboSpan" id="kobo.43.1">the data types, formats, and relationships between different </span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">data fields.</span></span></p>
			<p><span class="koboSpan" id="kobo.45.1">Here’s an example of a simple table structure. </span><span class="koboSpan" id="kobo.45.2">Consider a table named </span><strong class="source-inline"><span class="koboSpan" id="kobo.46.1">Employee</span></strong><span class="koboSpan" id="kobo.47.1"> that stores information about employees in </span><span class="No-Break"><span class="koboSpan" id="kobo.48.1">a company:</span></span></p>
			<table id="table001-2" class="No-Table-Style">
				<colgroup>
					<col/>
					<col/>
					<col/>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.49.1">EmployeeID</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.50.1">FirstName</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.51.1">LastName</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.52.1">Position</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.53.1">Department</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.54.1">Salary</span></strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="source-inline"><span class="koboSpan" id="kobo.55.1">1</span></strong></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.56.1">John</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.57.1">Doe</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.58.1">Software Eng</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.59.1">IT</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.60.1">75000</span></strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="source-inline"><span class="koboSpan" id="kobo.61.1">2</span></strong></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.62.1">Jane</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.63.1">Smith</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.64.1">Data Analyst</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.65.1">Analytics</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.66.1">60000</span></strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="source-inline"><span class="koboSpan" id="kobo.67.1">3</span></strong></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.68.1">Bob</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.69.1">Johnson</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.70.1">Project Manager</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.71.1">Project Management</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.72.1">85000</span></strong></span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p><span class="koboSpan" id="kobo.73.1">Let’s break this </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">table down:</span></span></p>
			<ul>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.75.1">EmployeeID</span></strong><span class="koboSpan" id="kobo.76.1">: A unique identifier for </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">each employee</span></span></li>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.78.1">FirstName</span></strong><span class="koboSpan" id="kobo.79.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.80.1">LastName</span></strong><span class="koboSpan" id="kobo.81.1"> are columns storing the first and last names </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">of employees</span></span></li>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.83.1">Position</span></strong><span class="koboSpan" id="kobo.84.1">: The job title or position of </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">the employee</span></span></li>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.86.1">Department</span></strong><span class="koboSpan" id="kobo.87.1">: The department in which the </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">employee works</span></span></li>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.89.1">Salary</span></strong><span class="koboSpan" id="kobo.90.1">: The salary of </span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">the employee</span></span></li>
			</ul>
			<p><span class="koboSpan" id="kobo.92.1">This table structure is organized into rows and columns. </span><span class="koboSpan" id="kobo.92.2">Each row represents a specific employee, and each column represents a different attribute or piece of information about the </span><a id="_idIndexMarker170"/><span class="koboSpan" id="kobo.93.1">employee. </span><span class="koboSpan" id="kobo.93.2">The table structure allows for easy querying, filtering, and joining of data. </span><span class="koboSpan" id="kobo.93.3">The values in each column adhere to a specific data type (e.g., integer, string, etc.), and relationships between tables can be established </span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">using keys.</span></span></p>
			<p><span class="koboSpan" id="kobo.95.1">This is a simplified example, but in real-world scenarios, tables can have more columns and </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">complex relationships.</span></span><a id="_idTextAnchor070"/></p>
			<h3><span class="koboSpan" id="kobo.97.1">Data quality</span></h3>
			<p><strong class="bold"><span class="koboSpan" id="kobo.98.1">Data quality</span></strong><span class="koboSpan" id="kobo.99.1"> involves evaluating the overall reliability and trustworthiness </span><a id="_idIndexMarker171"/><span class="koboSpan" id="kobo.100.1">of the data. </span><span class="koboSpan" id="kobo.100.2">Through data profiling, we can identify various data quality problems, including duplicate records, incorrect or inconsistent values, missing values, and outliers. </span><span class="koboSpan" id="kobo.100.3">By quantifying these issues, organizations gain an understanding of the extent to which the data can be trusted and relied upon </span><span class="No-Break"><span class="koboSpan" id="kobo.101.1">for analysis.</span></span><a id="_idTextAnchor071"/></p>
			<h3><span class="koboSpan" id="kobo.102.1">Data distribution</span></h3>
			<p><span class="koboSpan" id="kobo.103.1">Understanding data distribution within each field or column is another </span><a id="_idIndexMarker172"/><span class="koboSpan" id="kobo.104.1">key objective of data profiling. </span><span class="koboSpan" id="kobo.104.2">By analyzing data distribution, organizations gain insights into patterns, frequencies, and anomalies present in </span><span class="No-Break"><span class="koboSpan" id="kobo.105.1">the data.</span></span></p>
			<p><span class="koboSpan" id="kobo.106.1">Let’s imagine that we are working for an e-commerce company and we are collecting daily sales revenue data. </span><span class="koboSpan" id="kobo.106.2">By examining the distribution, we can identify trends </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">in sales:</span></span></p>
			<div>
				<div id="_idContainer013" class="IMG---Figure">
					<span class="koboSpan" id="kobo.108.1"><img src="image/B19801_03_1.jpg" alt="Figure 3.1 – Distribution of daily sales revenue"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.109.1">Figure 3.1 – Distribution of daily sales revenue</span></p>
			<p><span class="koboSpan" id="kobo.110.1">In this histogram, we can see that the sales data follows a normal distribution, indicating that data </span><a id="_idIndexMarker173"/><span class="koboSpan" id="kobo.111.1">near the mean is more frequent in occurrence than data far from the mean. </span><span class="koboSpan" id="kobo.111.2">In this way, we can understand the mean daily sales we can expect on a </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">regular day.</span></span></p>
			<p><span class="koboSpan" id="kobo.113.1">Now that we understand what challenges data profiling can deal with, let’s see the different ways you can go about performing </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">data profilin</span><a id="_idTextAnchor072"/><span class="koboSpan" id="kobo.115.1">g.</span></span></p>
			<h1 id="_idParaDest-59"><a id="_idTextAnchor073"/><span class="koboSpan" id="kobo.116.1">Exploratory data analysis options – profiler versus manual</span></h1>
			<p><span class="koboSpan" id="kobo.117.1">When </span><a id="_idIndexMarker174"/><span class="koboSpan" id="kobo.118.1">performing </span><strong class="bold"><span class="koboSpan" id="kobo.119.1">exploratory data analysis</span></strong><span class="koboSpan" id="kobo.120.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.121.1">EDA</span></strong><span class="koboSpan" id="kobo.122.1">), there are </span><a id="_idIndexMarker175"/><span class="koboSpan" id="kobo.123.1">different approaches you can take to understand </span><a id="_idIndexMarker176"/><span class="koboSpan" id="kobo.124.1">your data, including conducting manual analysis or using </span><span class="No-Break"><span class="koboSpan" id="kobo.125.1">a profiler.</span></span></p>
			<p><strong class="bold"><span class="koboSpan" id="kobo.126.1">Manual EDA</span></strong><span class="koboSpan" id="kobo.127.1"> involves </span><a id="_idIndexMarker177"/><span class="koboSpan" id="kobo.128.1">writing custom code or using general-purpose data analysis libraries (e.g., pandas in Python) to explore the data. </span><span class="koboSpan" id="kobo.128.2">It gives you more flexibility and control over the analysis process. </span><span class="koboSpan" id="kobo.128.3">You can customize the analysis based on your specific requirements and questions. </span><span class="koboSpan" id="kobo.128.4">Manual EDA allows for more in-depth exploration, including custom calculations, feature engineering, and advanced visualizations. </span><span class="koboSpan" id="kobo.128.5">It can be beneficial when dealing with complex data or when you have specific domain knowledge that you want to apply to </span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">the analysis.</span></span></p>
			<p><span class="koboSpan" id="kobo.130.1">A </span><strong class="bold"><span class="koboSpan" id="kobo.131.1">profiler</span></strong><span class="koboSpan" id="kobo.132.1"> is a tool or </span><a id="_idIndexMarker178"/><span class="koboSpan" id="kobo.133.1">library specifically designed for analyzing and summarizing data. </span><span class="koboSpan" id="kobo.133.2">It automates many EDA tasks and provides quick insights into the data’s structure, summary statistics, missing values, data types, and distributions. </span><span class="koboSpan" id="kobo.133.3">It can save you time by automating repetitive tasks and providing a comprehensive overview of </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">the dataset.</span></span></p>
			<p><span class="koboSpan" id="kobo.135.1">Let’s see more in detail when to </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">use what:</span></span></p>
			<table id="table002-1" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.137.1">Manual EDA</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.138.1">Data Profiling</span></strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.139.1">Pros</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.140.1">Flexibility </span><a id="_idIndexMarker179"/><span class="koboSpan" id="kobo.141.1">to explore data based on </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">specific needs</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.143.1">Automated </span><a id="_idIndexMarker180"/><span class="koboSpan" id="kobo.144.1">process for </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">quick insights</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.146.1">In-depth understanding of the data through </span><span class="No-Break"><span class="koboSpan" id="kobo.147.1">custom code</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.148.1">Consistent and standardized analysis </span><span class="No-Break"><span class="koboSpan" id="kobo.149.1">across datasets</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style" rowspan="2"/>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.150.1">Greater control over analysis techniques </span><span class="No-Break"><span class="koboSpan" id="kobo.151.1">and visuals</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.152.1">Automated visualizations and </span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">summary statistics</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.154.1">Identification of data quality issues </span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">and anomalies</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.156.1">Cons</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.157.1">A </span><a id="_idIndexMarker181"/><span class="koboSpan" id="kobo.158.1">time-consuming process requiring manual effort </span><span class="No-Break"><span class="koboSpan" id="kobo.159.1">and repetitive</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.160.1">Limited </span><a id="_idIndexMarker182"/><span class="koboSpan" id="kobo.161.1">customization options in </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">generated reports</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.163.1">Higher likelihood of human errors </span><span class="No-Break"><span class="koboSpan" id="kobo.164.1">or biases</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.165.1">May not capture complex relationships </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">or patterns</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.167.1">Lack of standardization across analysts </span><span class="No-Break"><span class="koboSpan" id="kobo.168.1">or teams</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.169.1">Less flexibility compared to </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">manual analysis</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.171.1">Manual EDA</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.172.1">Data Profiling</span></strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.173.1">Reliance on predefined algorithms </span><span class="No-Break"><span class="koboSpan" id="kobo.174.1">and techniques</span></span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><a id="_idTextAnchor074"/><span class="koboSpan" id="kobo.175.1">Table 3.1 – Comparison between Manual EDA versus using a profiler tool</span></p>
			<p><span class="koboSpan" id="kobo.176.1">As the data grows, manual EDA becomes increasingly time-consuming and prone to human error, leading to inconsistent results and potentially overlooked data issues. </span><span class="koboSpan" id="kobo.176.2">Manual </span><a id="_idIndexMarker183"/><span class="koboSpan" id="kobo.177.1">efforts also lack scalability and reproducibility, making it difficult to handle large datasets and collaborate effectively. </span><span class="koboSpan" id="kobo.177.2">That is why </span><a id="_idIndexMarker184"/><span class="koboSpan" id="kobo.178.1">for the rest of the chapter, we will focus on how you can use different profiling tools to perform EDA on the data; however, in practice, a combined approach is often implemented. </span><span class="koboSpan" id="kobo.178.2">We will also provide some insights on how to change your tools given the size of </span><span class="No-Break"><span class="koboSpan" id="kobo.179.1">your data.</span></span></p>
			<h1 id="_idParaDest-60"><a id="_idTextAnchor075"/><span class="koboSpan" id="kobo.180.1">Profiling data with pandas’ ydata_profiling</span></h1>
			<p><span class="koboSpan" id="kobo.181.1">Let’s </span><a id="_idIndexMarker185"/><span class="koboSpan" id="kobo.182.1">see an example in Python that showcases </span><a id="_idIndexMarker186"/><span class="koboSpan" id="kobo.183.1">data profiling using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.184.1">ProfileReport</span></strong><span class="koboSpan" id="kobo.185.1"> class from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.186.1">ydata-profiling</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.187.1"> library.</span></span></p>
			<p><span class="koboSpan" id="kobo.188.1">Let’s start with installing a few </span><span class="No-Break"><span class="koboSpan" id="kobo.189.1">libraries first:</span></span></p>
			<pre class="console"><span class="koboSpan" id="kobo.190.1">
pip install pandas
pip install ydata-profiling
pip install ipywidgets</span></pre>			<p><span class="koboSpan" id="kobo.191.1">In the following code example, we will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.192.1">iris</span></strong><span class="koboSpan" id="kobo.193.1"> dataset from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.194.1">seaborn</span></strong><span class="koboSpan" id="kobo.195.1"> library, which is an open </span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">source dataset.</span></span></p>
			<p><span class="koboSpan" id="kobo.197.1">Next, we are going to read the dataset and perform some initial EDA with </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.198.1">minimal code</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">!</span></span></p>
			<ol>
				<li><span class="koboSpan" id="kobo.200.1">We’ll start by importing the libraries and loading the dataset directly from its URL using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.201.1">read_csv()</span></strong><span class="koboSpan" id="kobo.202.1"> function </span><span class="No-Break"><span class="koboSpan" id="kobo.203.1">from pandas:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.204.1">
import pandas as pd
import ydata_profiling as pp</span></pre></li>				<li><span class="koboSpan" id="kobo.205.1">Load the </span><strong class="source-inline"><span class="koboSpan" id="kobo.206.1">iris</span></strong><span class="koboSpan" id="kobo.207.1"> dataset from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.208.1">seaborn</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.209.1"> library:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.210.1">
iris_data = pd.read_csv('https: //raw. </span><span class="koboSpan" id="kobo.210.2">githubusercontent .com/mwaskom/ seaborn-data/master/ iris.csv')</span></pre></li>				<li><span class="koboSpan" id="kobo.211.1">Next, we’ll </span><a id="_idIndexMarker187"/><span class="koboSpan" id="kobo.212.1">perform data profiling </span><a id="_idIndexMarker188"/><span class="koboSpan" id="kobo.213.1">by creating a profile report using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.214.1">ProfileReport()</span></strong><span class="koboSpan" id="kobo.215.1"> function </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">from </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.217.1">pandas_profiling</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.218.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.219.1">
profile = pp.ProfileReport(iris_data)</span></pre></li>				<li><span class="koboSpan" id="kobo.220.1">We’ll generate an HTML report using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.221.1">to_file()</span></strong><span class="koboSpan" id="kobo.222.1"> method, which exports the profiling results to an HTML file for easy sharing and </span><span class="No-Break"><span class="koboSpan" id="kobo.223.1">further analysis:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.224.1">
profile.to_file("data_profile_report.html")</span></pre></li>				<li><span class="koboSpan" id="kobo.225.1">Optionally, we can embed the report in </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">the notebook:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.227.1">
profile.to_notebook_iframe()</span></pre></li>				<li><span class="koboSpan" id="kobo.228.1">Writing the report to a JSON file is optional, but a </span><span class="No-Break"><span class="koboSpan" id="kobo.229.1">best practice:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.230.1">
profile.to_file(output_path+"/pandas_profiler.json")</span></pre></li>			</ol>
			<p><span class="koboSpan" id="kobo.231.1">Let’s explore the results of the profiler one </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">by one.</span></span></p>
			<h2 id="_idParaDest-61"><a id="_idTextAnchor076"/><span class="koboSpan" id="kobo.233.1">Overview</span></h2>
			<p><span class="koboSpan" id="kobo.234.1">The first </span><a id="_idIndexMarker189"/><span class="koboSpan" id="kobo.235.1">section in the profiling report is the </span><strong class="bold"><span class="koboSpan" id="kobo.236.1">Overview</span></strong><span class="koboSpan" id="kobo.237.1"> section. </span><span class="koboSpan" id="kobo.237.2">In the </span><strong class="bold"><span class="koboSpan" id="kobo.238.1">Overview</span></strong><span class="koboSpan" id="kobo.239.1"> section, you have multiple tabs, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.240.1">following figure:</span></span></p>
			<div>
				<div id="_idContainer014" class="IMG---Figure">
					<span class="koboSpan" id="kobo.241.1"><img src="image/B19801_03_2.jpg" alt="Figure 3.2 – Overview of pandas profiler results"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.242.1">Figure 3.2 – Overview of pandas profiler results</span></p>
			<p><span class="koboSpan" id="kobo.243.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.244.1">Overview</span></strong><span class="koboSpan" id="kobo.245.1"> tab of the profiler results, we can see </span><span class="No-Break"><span class="koboSpan" id="kobo.246.1">the following:</span></span></p>
			<ul>
				<li><strong class="bold"><span class="koboSpan" id="kobo.247.1">Number of variables</span></strong><span class="koboSpan" id="kobo.248.1">: The iris dataset has five variables – sepal length, sepal width, petal length, petal width, </span><span class="No-Break"><span class="koboSpan" id="kobo.249.1">and species</span></span></li>
				<li><strong class="bold"><span class="koboSpan" id="kobo.250.1">Number of observations</span></strong><span class="koboSpan" id="kobo.251.1">: The dataset contains </span><span class="No-Break"><span class="koboSpan" id="kobo.252.1">150 rows</span></span></li>
				<li><strong class="bold"><span class="koboSpan" id="kobo.253.1">Missing cells</span></strong><span class="koboSpan" id="kobo.254.1">: No missing values are present in the </span><span class="No-Break"><span class="koboSpan" id="kobo.255.1">iris dataset</span></span></li>
				<li><strong class="bold"><span class="koboSpan" id="kobo.256.1">Duplicate rows</span></strong><span class="koboSpan" id="kobo.257.1">: There is one </span><span class="No-Break"><span class="koboSpan" id="kobo.258.1">duplicate row</span></span></li>
			</ul>
			<p><span class="koboSpan" id="kobo.259.1">Then, we </span><a id="_idIndexMarker190"/><span class="koboSpan" id="kobo.260.1">have the </span><strong class="bold"><span class="koboSpan" id="kobo.261.1">Alerts</span></strong><span class="koboSpan" id="kobo.262.1"> tab, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">following screenshot:</span></span></p>
			<div>
				<div id="_idContainer015" class="IMG---Figure">
					<span class="koboSpan" id="kobo.264.1"><img src="image/B19801_03_3.jpg" alt="Figure 3.3 – The Alerts tab of the ydata_profiling profiler"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.265.1">Figure 3.3 – The Alerts tab of the ydata_profiling profiler</span></p>
			<p><span class="koboSpan" id="kobo.266.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.267.1">Alerts</span></strong><span class="koboSpan" id="kobo.268.1"> tab, we can see all the potential quality issues in our dataset, from high correlation </span><a id="_idIndexMarker191"/><span class="koboSpan" id="kobo.269.1">to missing values. </span><span class="koboSpan" id="kobo.269.2">The most amazing thing is that those alerts are being created by the profiler automatically when you perform the profile creation. </span><span class="koboSpan" id="kobo.269.3">Never forget to check the </span><strong class="bold"><span class="koboSpan" id="kobo.270.1">Alerts</span></strong><span class="koboSpan" id="kobo.271.1"> tab as it shows the summary of all the potential issues in your dataset. </span><span class="koboSpan" id="kobo.271.2">The following screenshot shows the profiling performed for </span><em class="italic"><span class="koboSpan" id="kobo.272.1">each</span></em><span class="koboSpan" id="kobo.273.1"> numerical feature in the dataset. </span><span class="koboSpan" id="kobo.273.2">Let’s see an example </span><span class="No-Break"><span class="koboSpan" id="kobo.274.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.275.1">sepal_length</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.276.1">:</span></span></p>
			<div>
				<div id="_idContainer016" class="IMG---Figure">
					<span class="koboSpan" id="kobo.277.1"><img src="image/B19801_03_4.jpg" alt="Figure 3.4 – Numerical feature profiling"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.278.1">Figure 3.4 – Numerical feature profiling</span></p>
			<p><span class="koboSpan" id="kobo.279.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.280.1">sepal_length</span></strong><span class="koboSpan" id="kobo.281.1"> part of the profile page, we can get more details about the specific numeric feature. </span><span class="koboSpan" id="kobo.281.2">A similar analysis is performed for all the other numeric features in the dataset. </span><span class="koboSpan" id="kobo.281.3">We can see that this feature has 35 different values and there are no missing values in the dataset for this feature. </span><span class="koboSpan" id="kobo.281.4">All the values are positive, which makes sense as this feature represents the length of the sepal and these values can range from 4.3 to 7.9. </span><span class="koboSpan" id="kobo.281.5">The histogram shows the distribution for </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">the feature.</span></span></p>
			<div>
				<div id="_idContainer017" class="IMG---Figure">
					<span class="koboSpan" id="kobo.283.1"><img src="image/B19801_03_5.jpg" alt="Figure 3.5 – Categorical feature profiling"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.284.1">Figure 3.5 – Categorical feature profiling</span></p>
			<p><span class="koboSpan" id="kobo.285.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.286.1">species</span></strong><span class="koboSpan" id="kobo.287.1"> part of the profile page, we can get more details about the specific categorical </span><a id="_idIndexMarker192"/><span class="koboSpan" id="kobo.288.1">feature. </span><span class="koboSpan" id="kobo.288.2">A similar analysis is performed for all the other categorical features in the dataset. </span><span class="koboSpan" id="kobo.288.3">We can see that this feature has three different values (</span><strong class="source-inline"><span class="koboSpan" id="kobo.289.1">sectosa</span></strong><span class="koboSpan" id="kobo.290.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.291.1">versicolor</span></strong><span class="koboSpan" id="kobo.292.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.293.1">virginica</span></strong><span class="koboSpan" id="kobo.294.1">) and there are no missing values in the data for this feature. </span><span class="koboSpan" id="kobo.294.2">From the graph, we can see that we have the same number of records for each value of the </span><span class="No-Break"><span class="koboSpan" id="kobo.295.1">feature (50).</span></span></p>
			<h2 id="_idParaDest-62"><a id="_idTextAnchor077"/><span class="koboSpan" id="kobo.296.1">Interactions</span></h2>
			<p><span class="koboSpan" id="kobo.297.1">Another section in the profiling report is an </span><strong class="bold"><span class="koboSpan" id="kobo.298.1">Interactions</span></strong><span class="koboSpan" id="kobo.299.1"> section, which visualizes the relationships </span><a id="_idIndexMarker193"/><span class="koboSpan" id="kobo.300.1">and potential interactions between different columns in the dataset. </span><span class="koboSpan" id="kobo.300.2">These charts are particularly useful for identifying potential correlations or dependencies between variables presented as </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.301.1">scatter plots</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">.</span></span></p>
			<p><span class="koboSpan" id="kobo.303.1">The following figure shows the interactions between different variables. </span><span class="koboSpan" id="kobo.303.2">This chart can be created for every different combination of </span><em class="italic"><span class="koboSpan" id="kobo.304.1">numeric</span></em><span class="koboSpan" id="kobo.305.1"> variables. </span><span class="koboSpan" id="kobo.305.2">Let’s see an example for petal length and </span><span class="No-Break"><span class="koboSpan" id="kobo.306.1">petal width.</span></span></p>
			<div>
				<div id="_idContainer018" class="IMG---Figure">
					<span class="koboSpan" id="kobo.307.1"><img src="image/B19801_03_6.jpg" alt="Figure 3.6 – Interaction chart between petal length and petal width"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.308.1">Figure 3.6 – Interaction chart between petal length and petal width</span></p>
			<p><span class="koboSpan" id="kobo.309.1">In the </span><a id="_idIndexMarker194"/><span class="koboSpan" id="kobo.310.1">interaction chart, we can see how one variable influences the other. </span><span class="koboSpan" id="kobo.310.2">For example, as the petal length increases, the petal width increases as well. </span><span class="koboSpan" id="kobo.310.3">So, there is a linear relationship between the two. </span><span class="koboSpan" id="kobo.310.4">Since there is a strong interaction between these two variables, it is a good idea to deep dive into this interaction and examine in more detail the correlation plots for </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">this pair.</span></span></p>
			<h2 id="_idParaDest-63"><a id="_idTextAnchor078"/><span class="koboSpan" id="kobo.312.1">Correlations</span></h2>
			<p><span class="koboSpan" id="kobo.313.1">A </span><strong class="bold"><span class="koboSpan" id="kobo.314.1">correlation matrix</span></strong><span class="koboSpan" id="kobo.315.1"> also </span><a id="_idIndexMarker195"/><span class="koboSpan" id="kobo.316.1">depicts the interactions between variables </span><a id="_idIndexMarker196"/><span class="koboSpan" id="kobo.317.1">where each cell represents the relationship between two columns. </span><span class="koboSpan" id="kobo.317.2">The cells are color-coded based on the strength or type of interaction detected between the corresponding column pairs. </span><span class="koboSpan" id="kobo.317.3">This helps in identifying how strongly two variables are related. </span><span class="koboSpan" id="kobo.317.4">Positive correlations are typically shown in one color (e.g., blue), while negative correlations are shown in another (e.g., red), with the intensity of the color indicating the strength of </span><span class="No-Break"><span class="koboSpan" id="kobo.318.1">the correlation.</span></span></p>
			<p><span class="koboSpan" id="kobo.319.1">For example, there might be a positive correlation between petal length and petal width, indicating that as the length of the petal increases, so does </span><span class="No-Break"><span class="koboSpan" id="kobo.320.1">the width.</span></span></p>
			<div>
				<div id="_idContainer019" class="IMG---Figure">
					<span class="koboSpan" id="kobo.321.1"><img src="image/B19801_03_7.jpg" alt="Figure 3.7 – Correlation chart between numeric variables"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.322.1">Figure 3.7 – Correlation chart between numeric variables</span></p>
			<p><span class="koboSpan" id="kobo.323.1">As we can see from the chart, the darker the color blue is, the stronger the correlation between the </span><a id="_idIndexMarker197"/><span class="koboSpan" id="kobo.324.1">variables. </span><span class="koboSpan" id="kobo.324.2">Petal length and petal width have more than 0.75 positive correlation, showing that as one increases the other increases too. </span><span class="koboSpan" id="kobo.324.3">This is something we need to be aware of before proceeding to any modeling exercise as we may not need to keep both variables in the dataset, as having one can predict the other. </span><span class="koboSpan" id="kobo.324.4">For instance, if two variables are highly correlated, you might drop one of them or create a new feature that encapsulates the information from both. </span><span class="koboSpan" id="kobo.324.5">In some cases, removing highly correlated features can lead to faster training times for some machine learning algorithms, as the algorithm doesn’t need to deal with redundant information; also, we can simplify models, making them easier to understand and less prone </span><span class="No-Break"><span class="koboSpan" id="kobo.325.1">to overfitting.</span></span></p>
			<p class="callout-heading"><span class="koboSpan" id="kobo.326.1">Note</span></p>
			<p class="callout"><strong class="bold"><span class="koboSpan" id="kobo.327.1">High correlation threshold</span></strong><span class="koboSpan" id="kobo.328.1">: Set a threshold for high correlation (e.g., 0.8 or 0.9). </span><span class="koboSpan" id="kobo.328.2">Variables </span><a id="_idIndexMarker198"/><span class="koboSpan" id="kobo.329.1">with correlation coefficients above this threshold are considered </span><span class="No-Break"><span class="koboSpan" id="kobo.330.1">highly correlated.</span></span></p>
			<h2 id="_idParaDest-64"><a id="_idTextAnchor079"/><span class="koboSpan" id="kobo.331.1">Missing values</span></h2>
			<p><span class="koboSpan" id="kobo.332.1">Another key </span><a id="_idIndexMarker199"/><span class="koboSpan" id="kobo.333.1">aspect of data quality is </span><strong class="bold"><span class="koboSpan" id="kobo.334.1">missing values</span></strong><span class="koboSpan" id="kobo.335.1">. </span><span class="koboSpan" id="kobo.335.2">It refers to the absence </span><a id="_idIndexMarker200"/><span class="koboSpan" id="kobo.336.1">of data in specific entries or variables within a dataset. </span><span class="koboSpan" id="kobo.336.2">They can occur for various reasons, such as data entry errors, sensor malfunctions, or errors in the ingestion process. </span><span class="koboSpan" id="kobo.336.3">If ignored, it can lead to biased and </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">inaccurate results.</span></span></p>
			<p><span class="koboSpan" id="kobo.338.1">The following figure shows the percentage of non-missing values for each column in </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">the data:</span></span></p>
			<div>
				<div id="_idContainer020" class="IMG---Figure">
					<span class="koboSpan" id="kobo.340.1"><img src="image/B19801_03_8.jpg" alt="Figure 3.8 – Percentage of non-missing values in the data"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.341.1">Figure 3.8 – Percentage of non-missing values in the data</span></p>
			<p><span class="koboSpan" id="kobo.342.1">In the present example, we can see that all the values in the dataset are complete and that all the features have 150 non-null values. </span><span class="koboSpan" id="kobo.342.2">So, that is good news for us and we can proceed to the </span><span class="No-Break"><span class="koboSpan" id="kobo.343.1">next check.</span></span></p>
			<h2 id="_idParaDest-65"><a id="_idTextAnchor080"/><span class="koboSpan" id="kobo.344.1">Duplicate rows</span></h2>
			<p><span class="koboSpan" id="kobo.345.1">A </span><strong class="bold"><span class="koboSpan" id="kobo.346.1">duplicate row</span></strong><span class="koboSpan" id="kobo.347.1"> in a </span><a id="_idIndexMarker201"/><span class="koboSpan" id="kobo.348.1">dataset refers to a row that is </span><a id="_idIndexMarker202"/><span class="koboSpan" id="kobo.349.1">identical to another row in every column. </span><span class="koboSpan" id="kobo.349.2">This means that for every column in the dataset, the values in the duplicate row are the same as those in the row it duplicates. </span><span class="koboSpan" id="kobo.349.3">Surfacing the presence and extent of duplicate rows helps us quickly identify potential data quality issues. </span><span class="koboSpan" id="kobo.349.4">As we’ve said, duplicate rows can arise due to various reasons, such as data integration problems, incorrect deduplication processes, or simply the nature of the data </span><span class="No-Break"><span class="koboSpan" id="kobo.350.1">collection process.</span></span></p>
			<p><span class="koboSpan" id="kobo.351.1">In a profiling report, we can see the duplicate rows under </span><strong class="bold"><span class="koboSpan" id="kobo.352.1">Most frequently occurring</span></strong><span class="koboSpan" id="kobo.353.1">, where a sample of the duplicates in the dataset </span><span class="No-Break"><span class="koboSpan" id="kobo.354.1">is presented.</span></span></p>
			<div>
				<div id="_idContainer021" class="IMG---Figure">
					<span class="koboSpan" id="kobo.355.1"><img src="image/B19801_03_9.jpg" alt="Figure 3.9 – Duplicate rows in the data"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.356.1">Figure 3.9 – Duplicate rows in the data</span></p>
			<p><span class="koboSpan" id="kobo.357.1">In general, to find the duplicate rows, you need to identify key columns or a combination </span><a id="_idIndexMarker203"/><span class="koboSpan" id="kobo.358.1">of columns that should be unique. </span><span class="koboSpan" id="kobo.358.2">Typically, we identify </span><a id="_idIndexMarker204"/><span class="koboSpan" id="kobo.359.1">duplicates based on all columns in the dataset. </span><span class="koboSpan" id="kobo.359.2">If there are duplicates, it indicates we have duplicate rows. </span><span class="koboSpan" id="kobo.359.3">There are only two duplicated rows in the dataset in our example, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.360.1">preceding figure.</span></span></p>
			<p><span class="koboSpan" id="kobo.361.1">At this stage of the analysis, we are not handling duplicates since our focus is on understanding the data’s structure and characteristics. </span><span class="koboSpan" id="kobo.361.2">However, we will need to investigate the nature and source of these duplicates. </span><span class="koboSpan" id="kobo.361.3">Given that they represent a small proportion of the data, we could simply drop one of each pair of </span><span class="No-Break"><span class="koboSpan" id="kobo.362.1">identical rows.</span></span></p>
			<h2 id="_idParaDest-66"><a id="_idTextAnchor081"/><span class="koboSpan" id="kobo.363.1">Sample dataset</span></h2>
			<p><span class="koboSpan" id="kobo.364.1">Sampling </span><a id="_idIndexMarker205"/><span class="koboSpan" id="kobo.365.1">refers to the process of selecting a subset of data from a larger dataset instead of working with the entire dataset. </span><span class="koboSpan" id="kobo.365.2">In the EDA step, we usually work on a sample of data as it can provide initial insights and help in formulating hypotheses before committing resources to a </span><span class="No-Break"><span class="koboSpan" id="kobo.366.1">full analysis.</span></span></p>
			<div>
				<div id="_idContainer022" class="IMG---Figure">
					<span class="koboSpan" id="kobo.367.1"><img src="image/B19801_03_10.jpg" alt="Figure 3.10 – Sample dataset"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.368.1">Figure 3.10 – Sample dataset</span></p>
			<p><span class="koboSpan" id="kobo.369.1">Now that </span><a id="_idIndexMarker206"/><span class="koboSpan" id="kobo.370.1">we’ve understood how to build data profiles with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.371.1">ydata_profiling</span></strong><span class="koboSpan" id="kobo.372.1"> library, let’s have a closer look at a very popular but </span><a id="_idIndexMarker207"/><span class="koboSpan" id="kobo.373.1">similar profiler called the </span><strong class="bold"><span class="koboSpan" id="kobo.374.1">pandas</span><a id="_idTextAnchor082"/> </strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.375.1">data profiler</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.376.1">.</span></span></p>
			<h1 id="_idParaDest-67"><a id="_idTextAnchor083"/><span class="koboSpan" id="kobo.377.1">Profiling high volumes of data with the pandas data profiler</span></h1>
			<p><strong class="bold"><span class="koboSpan" id="kobo.378.1">Pandas profiling</span></strong><span class="koboSpan" id="kobo.379.1"> is a </span><a id="_idIndexMarker208"/><span class="koboSpan" id="kobo.380.1">powerful library for generating detailed reports </span><a id="_idIndexMarker209"/><span class="koboSpan" id="kobo.381.1">on datasets. </span><span class="koboSpan" id="kobo.381.2">However, for large datasets, the profiling process can become time-consuming and memory-intensive. </span><span class="koboSpan" id="kobo.381.3">When dealing with large datasets, you may need to consider a few strategies to optimize the </span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">p</span><a id="_idTextAnchor084"/><span class="koboSpan" id="kobo.383.1">rofiling p</span><a id="_idTextAnchor085"/><span class="koboSpan" id="kobo.384.1">rocess:</span></span></p>
			<ul>
				<li><strong class="bold"><span class="koboSpan" id="kobo.385.1">Sampling</span></strong><span class="koboSpan" id="kobo.386.1">: Instead of profiling the entire dataset, you can take a random sample of the data to generate the report. </span><span class="koboSpan" id="kobo.386.2">This can significantly reduce the computation time and memory requirements while still providing a representative overview of </span><span class="No-Break"><span class="koboSpan" id="kobo.387.1">the dataset:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.388.1">
from ydata_profiling import ProfileReport
sample_df = iris_data.sample(n=1000)  # Adjust the sample size as per your needs
report = Profile</span><a id="_idTextAnchor086"/><span class="koboSpan" id="kobo.389.1">Report(sample_df)</span></pre></li>				<li><strong class="bold"><a id="_idTextAnchor087"/><span class="koboSpan" id="kobo.390.1">Subset selection</span></strong><span class="koboSpan" id="kobo.391.1">: If you’re interested in specific columns or subsets of the dataset, you can select only those columns for profiling. </span><span class="koboSpan" id="kobo.391.2">This reduces the computational load and narrows down the focus to the variables </span><span class="No-Break"><span class="koboSpan" id="kobo.392.1">of interest:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.393.1">
subset_df = iris_data [['sepal_length', 'sepal_width']]  # Select columns to profile
report = Profile</span><a id="_idTextAnchor088"/><span class="koboSpan" id="kobo.394.1">Report(subset_df)</span></pre></li>				<li><strong class="bold"><span class="koboSpan" id="kobo.395.1">Configuring </span><a id="_idTextAnchor089"/><span class="koboSpan" id="kobo.396.1">profiler options</span></strong><span class="koboSpan" id="kobo.397.1">: The pandas profiling library provides several configuration options that allow you to fine-tune the profiling process. </span><span class="koboSpan" id="kobo.397.2">You can adjust </span><a id="_idIndexMarker210"/><span class="koboSpan" id="kobo.398.1">these options to limit the depth of analysis, reduce computations, or skip certain time-consuming tasks if they are not necessary for </span><span class="No-Break"><span class="koboSpan" id="kobo.399.1">your analysis:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.400.1">
report = ProfileReport(df, minimal=True)  # Generat</span><a id="_idTextAnchor090"/><span class="koboSpan" id="kobo.401.1">e a minimal report</span></pre></li>				<li><strong class="bold"><span class="koboSpan" id="kobo.402.1">Parallel processing</span></strong><span class="koboSpan" id="kobo.403.1">: If your system supports parallel processing, you can leverage it to speed up the profiling process. </span><span class="koboSpan" id="kobo.403.2">By distributing the workload across multiple cores or machines, you can potentially reduce the time required for profiling </span><span class="No-Break"><span class="koboSpan" id="kobo.404.1">large datasets:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.405.1">
import multiprocessing
with multiprocessing.Pool() as pool:
    report = pool.map(ProfileReport, [df1, df2, df3])  # Profiling multiple Data</span><a id="_idTextAnchor091"/><span class="koboSpan" id="kobo.406.1">Frames in parallel</span></pre></li>				<li><strong class="bold"><span class="koboSpan" id="kobo.407.1">Incr</span><a id="_idTextAnchor092"/><span class="koboSpan" id="kobo.408.1">emental profiling</span></strong><span class="koboSpan" id="kobo.409.1">: If your dataset is too large to fit in memory, you can consider performing incremental profiling by splitting the data into smaller chunks and profiling them individually. </span><span class="koboSpan" id="kobo.409.2">You can then combine the profiling results to get an overview of the </span><span class="No-Break"><span class="koboSpan" id="kobo.410.1">entire dataset:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.411.1">
chunk_size = 10000
chunks = [df[i:i + chunk_size] for i in range(0, len(df), chunk_size)]
reports = [ProfileReport(chunk) for chunk in chunks]
combined_report = ProfileReport(pd.concat(reports))</span></pre></li>			</ul>
			<p class="callout-heading"><span class="koboSpan" id="kobo.412.1">Note</span></p>
			<p class="callout"><span class="koboSpan" id="kobo.413.1">Some of these strategies aim to optimize the profiling process for large datasets, but they may result in some loss of granularity and detail compared to profiling the entire dataset. </span><span class="koboSpan" id="kobo.413.2">It’s essential to strike a balance between computational efficiency and the level of insight required </span><a id="_idTextAnchor093"/><span class="koboSpan" id="kobo.414.1">for </span><span class="No-Break"><span class="koboSpan" id="kobo.415.1">your analysis.</span></span></p>
			<p><span class="koboSpan" id="kobo.416.1">The next </span><a id="_idIndexMarker211"/><span class="koboSpan" id="kobo.417.1">tool we are going to review is usually used in data-engineering heavy workflows as it provides a lot of flexibility, automation, and easy integration with </span><span class="No-Break"><span class="koboSpan" id="kobo.418.1">other tools.</span></span></p>
			<h1 id="_idParaDest-68"><a id="_idTextAnchor094"/><span class="koboSpan" id="kobo.419.1">Data validation with the Great Expectations library</span></h1>
			<p><strong class="bold"><span class="koboSpan" id="kobo.420.1">Great Expectations</span></strong><span class="koboSpan" id="kobo.421.1"> is </span><a id="_idIndexMarker212"/><span class="koboSpan" id="kobo.422.1">an open source Python library </span><a id="_idIndexMarker213"/><span class="koboSpan" id="kobo.423.1">that facilitates data validation </span><a id="_idIndexMarker214"/><span class="koboSpan" id="kobo.424.1">and documentation. </span><span class="koboSpan" id="kobo.424.2">It provides a framework for defining, managing, and executing data quality checks, making it easier to ensure data integrity and reliability throughout the data pipeline. </span><span class="koboSpan" id="kobo.424.3">Quality checks can be executed at different stages of the data life cycle, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.425.1">following diagram:</span></span></p>
			<div>
				<div id="_idContainer023" class="IMG---Figure">
					<span class="koboSpan" id="kobo.426.1"><img src="image/B19801_03_11.jpg" alt="Figure 3.11 – Quality checks at different stages of the data life cycle"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.427.1">Figure 3.11 – Quality checks at different stages of the data life cycle</span></p>
			<p><span class="koboSpan" id="kobo.428.1">Let’s </span><a id="_idIndexMarker215"/><span class="koboSpan" id="kobo.429.1">discuss each of the touch </span><a id="_idIndexMarker216"/><span class="koboSpan" id="kobo.430.1">points in the data life cycle where quality checks can be applied, as illustrated in the </span><span class="No-Break"><span class="koboSpan" id="kobo.431.1">preceding figure:</span></span></p>
			<ul>
				<li><strong class="bold"><span class="koboSpan" id="kobo.432.1">Data entry</span></strong><span class="koboSpan" id="kobo.433.1">: During data entry or data collection, checks are conducted to ensure </span><a id="_idIndexMarker217"/><span class="koboSpan" id="kobo.434.1">that the data is accurately captured and recorded. </span><span class="koboSpan" id="kobo.434.2">This can involve verifying the format, range, and type of data, as well as performing validation checks against predefined rules </span><span class="No-Break"><span class="koboSpan" id="kobo.435.1">or standards.</span></span></li>
				<li><strong class="bold"><span class="koboSpan" id="kobo.436.1">Data transformation</span></strong><span class="koboSpan" id="kobo.437.1">: If data undergoes any transformations or conversions, such as </span><a id="_idIndexMarker218"/><span class="koboSpan" id="kobo.438.1">data cleansing or data normalization, quality checks are performed to validate the accuracy of the transformed data. </span><span class="koboSpan" id="kobo.438.2">This helps ensure that the data retains its integrity throughout </span><span class="No-Break"><span class="koboSpan" id="kobo.439.1">the process.</span></span></li>
				<li><strong class="bold"><span class="koboSpan" id="kobo.440.1">Data integration</span></strong><span class="koboSpan" id="kobo.441.1">: When combining data from different sources or systems, data </span><a id="_idIndexMarker219"/><span class="koboSpan" id="kobo.442.1">quality checks are necessary to identify any inconsistencies or discrepancies. </span><span class="koboSpan" id="kobo.442.2">This may involve checking for duplicate records, resolving missing or mismatched data, and reconciling any </span><span class="No-Break"><span class="koboSpan" id="kobo.443.1">conflicting information.</span></span></li>
				<li><strong class="bold"><span class="koboSpan" id="kobo.444.1">Data consumption</span></strong><span class="koboSpan" id="kobo.445.1">: Prior to performing any data analysis or generating reports, it is </span><a id="_idIndexMarker220"/><span class="koboSpan" id="kobo.446.1">essential to run data quality checks to ensure the integrity of the data. </span><span class="koboSpan" id="kobo.446.2">This involves validating the data against predefined criteria, checking for outliers or anomalies, and verifying the overall quality of </span><span class="No-Break"><span class="koboSpan" id="kobo.447.1">the dataset.</span></span></li>
			</ul>
			<p><span class="koboSpan" id="kobo.448.1">Great Expectations allows you to set Expectations or rules for your data and then validate your data against these Expectations at any point in the data life cycle. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.449.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.450.1">.12</span></em><span class="koboSpan" id="kobo.451.1"> illustrates the features of this library in </span><span class="No-Break"><span class="koboSpan" id="kobo.452.1">more detail.</span></span></p>
			<div>
				<div id="_idContainer024" class="IMG---Figure">
					<span class="koboSpan" id="kobo.453.1"><img src="image/B19801_03_12.jpg" alt="Figure 3.12 – Great Expectations process from data collection to data quality results"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.454.1">Figure 3.12 – Great Expectations process from data collection to data quality results</span></p>
			<p><span class="koboSpan" id="kobo.455.1">As you can see, there </span><a id="_idIndexMarker221"/><span class="koboSpan" id="kobo.456.1">are three main steps </span><a id="_idIndexMarker222"/><span class="koboSpan" id="kobo.457.1">to be aware of when working with </span><span class="No-Break"><span class="koboSpan" id="kobo.458.1">Great Expectations:</span></span></p>
			<ul>
				<li><span class="koboSpan" id="kobo.459.1">Bringing/collecting all the data you want to apply </span><span class="No-Break"><span class="koboSpan" id="kobo.460.1">Expectations on</span></span></li>
				<li><span class="koboSpan" id="kobo.461.1">Writing the Expectations and applying them to the </span><span class="No-Break"><span class="koboSpan" id="kobo.462.1">different data</span></span></li>
				<li><span class="koboSpan" id="kobo.463.1">Enjoying the benefits of clean, high-quality, and trustworthy data coming </span><span class="No-Break"><span class="koboSpan" id="kobo.464.1">to life</span></span></li>
			</ul>
			<p><span class="koboSpan" id="kobo.465.1">In the next section, we will go through how to configure Great Expectat</span><a id="_idTextAnchor095"/><span class="koboSpan" id="kobo.466.1">ions to validate </span><span class="No-Break"><span class="koboSpan" id="kobo.467.1">the dataset.</span></span></p>
			<h2 id="_idParaDest-69"><a id="_idTextAnchor096"/><span class="koboSpan" id="kobo.468.1">Configuring Great Expectations for your project</span></h2>
			<p><span class="koboSpan" id="kobo.469.1">You can validate your data against the defined Expectations using Great Expectations. </span><span class="koboSpan" id="kobo.469.2">The library </span><a id="_idIndexMarker223"/><span class="koboSpan" id="kobo.470.1">provides functions to execute these validations and identify any inconsistencies or issues in </span><span class="No-Break"><span class="koboSpan" id="kobo.471.1">the data.</span></span></p>
			<p><span class="koboSpan" id="kobo.472.1">You will need to install the </span><strong class="source-inline"><span class="koboSpan" id="kobo.473.1">great-expectations</span></strong><span class="koboSpan" id="kobo.474.1"> library for data profiling. </span><span class="koboSpan" id="kobo.474.2">You can use the following command to install the library in any IDE or </span><span class="No-Break"><span class="koboSpan" id="kobo.475.1">a terminal:</span></span></p>
			<pre class="console"><span class="koboSpan" id="kobo.476.1">
pip instal</span><a id="_idTextAnchor097"/><span class="koboSpan" id="kobo.477.1">l great-expectations==0.18.16</span></pre>			<p><span class="koboSpan" id="kobo.478.1">This should install the library. </span><span class="koboSpan" id="kobo.478.2">We are going to use the same dataset as before so that we can showcase the difference between </span><span class="No-Break"><span class="koboSpan" id="kobo.479.1">the tools:</span></span></p>
			<ol>
				<li><span class="koboSpan" id="kobo.480.1">Let’s start by setting up your project. </span><span class="koboSpan" id="kobo.480.2">Open your terminal, navigate to the desired location where you want to set up your new project, and then set up a new folder by running the </span><span class="No-Break"><span class="koboSpan" id="kobo.481.1">following command:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.482.1">mkdir great_expectations</span></strong></pre></li>				<li><span class="koboSpan" id="kobo.483.1">Then, we will go into the newly created folder by typing </span><span class="No-Break"><span class="koboSpan" id="kobo.484.1">the following:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.485.1">cd great_expectations</span></strong></pre><p class="list-inset"><span class="koboSpan" id="kobo.486.1">The first command will create a folder named </span><strong class="source-inline"><span class="koboSpan" id="kobo.487.1">great_expectations</span></strong><span class="koboSpan" id="kobo.488.1"> in your project directory where we’ll store all the Expectations we are going to build. </span><span class="koboSpan" id="kobo.488.2">The second command will navigate you inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">great_expectations</span></strong><span class="koboSpan" id="kobo.490.1"> folder we </span><span class="No-Break"><span class="koboSpan" id="kobo.491.1">just created.</span></span></p></li>				<li><span class="koboSpan" id="kobo.492.1">Next, we will create some folders for our data and the code we will need to use to run our example. </span><span class="koboSpan" id="kobo.492.2">Make sure you are in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.493.1">great_expectations</span></strong><span class="koboSpan" id="kobo.494.1"> directory and run </span><span class="No-Break"><span class="koboSpan" id="kobo.495.1">the following:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.496.1">mkdir code</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.497.1">mkdir data</span></strong></pre><p class="list-inset"><span class="koboSpan" id="kobo.498.1">You should have created the following </span><span class="No-Break"><span class="koboSpan" id="kobo.499.1">project structure:</span></span></p></li>			</ol>
			<div>
				<div id="_idContainer025" class="IMG---Figure">
					<span class="koboSpan" id="kobo.500.1"><img src="image/B19801_03_13.jpg" alt="Figure 3.13 – Great Expectations project initialization"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.501.1">Figure 3.13 – Great Expectations project initialization</span></p>
			<ol>
				<li value="4"><span class="koboSpan" id="kobo.502.1">Next, we’ll run the following command to initialize a new Great Expectations project. </span><span class="koboSpan" id="kobo.502.2">Make sure you are in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.503.1">great_expectations</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.504.1"> folder:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.505.1">great_expectations init</span></strong></pre><p class="list-inset"><span class="koboSpan" id="kobo.506.1">The preceding command sets up the basic project structure, configuration files, and directories needed to start using Great Expectations. </span><span class="koboSpan" id="kobo.506.2">The initialization process </span><a id="_idIndexMarker224"/><span class="koboSpan" id="kobo.507.1">involves creating the necessary project files, such as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.508.1">great_expectations.yml</span></strong><span class="koboSpan" id="kobo.509.1"> configuration file, the Expectations and data directories, and other project-specific files. </span><span class="koboSpan" id="kobo.509.2">The initialization step is a one-time setup that allows you to define and manage your data Expectations, create validation checkpoints, and generate documentation using Great Expectations. </span><span class="koboSpan" id="kobo.509.3">It helps you establish a project-specific configuration and directory structure that enables you to organize your Expectations and maintain consistency across your data pipelines. </span><span class="koboSpan" id="kobo.509.4">Once you have initialized the project, you can define Expectations, validate data, and generate reports based on those Expectations using </span><span class="No-Break"><span class="koboSpan" id="kobo.510.1">Great Expectations.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.511.1">The preceding code will display the </span><span class="No-Break"><span class="koboSpan" id="kobo.512.1">following output:</span></span></p></li>			</ol>
			<div>
				<div id="_idContainer026" class="IMG---Figure">
					<span class="koboSpan" id="kobo.513.1"><img src="image/B19801_03_14.jpg" alt="Figure 3.14 – Great Expectations project initialization"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.514.1">Figure 3.14 – Great Expectations project initialization</span></p>
			<ol>
				<li value="5"><span class="koboSpan" id="kobo.515.1">Hit </span><em class="italic"><span class="koboSpan" id="kobo.516.1">Y</span></em><span class="koboSpan" id="kobo.517.1"> when prompted and Great Expectations will go ahead and build a project structure </span><a id="_idIndexMarker225"/><span class="koboSpan" id="kobo.518.1">for us in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.519.1">great_expectations</span></strong><span class="koboSpan" id="kobo.520.1"> folder. </span><span class="koboSpan" id="kobo.520.2">The folder structure will look like </span><span class="No-Break"><span class="koboSpan" id="kobo.521.1">the following:</span></span></li>
			</ol>
			<div>
				<div id="_idContainer027" class="IMG---Figure">
					<span class="koboSpan" id="kobo.522.1"><img src="image/B19801_03_15.jpg" alt="Figure 3.15 – Great Expectations folder structure"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.523.1">Figure 3.15 – Great Expectations folder structure</span></p>
			<p class="list-inset"><span class="koboSpan" id="kobo.524.1">The folder </span><a id="_idIndexMarker226"/><span class="koboSpan" id="kobo.525.1">structure of Great Expectations follows a specific convention to organize the configuration, Expectations, and data documentation related to your data pipeline. </span><span class="koboSpan" id="kobo.525.2">Let’s learn a little more about </span><span class="No-Break"><span class="koboSpan" id="kobo.526.1">the structure:</span></span></p>
			<ul>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.527.1">/uncommitted/</span></strong><span class="koboSpan" id="kobo.528.1">: This directory contains all the uncommitted configuration and validation files. </span><span class="koboSpan" id="kobo.528.2">It is where you define and modify Expectations, validations, and </span><span class="No-Break"><span class="koboSpan" id="kobo.529.1">data documentation.</span></span></li>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.530.1">/checkpoints/</span></strong><span class="koboSpan" id="kobo.531.1">: This directory stores checkpoint files, which hold the sets of Expectations to be validated against specific data batches. </span><span class="koboSpan" id="kobo.531.2">Checkpoints are useful for running validations on specific portions or subsets of </span><span class="No-Break"><span class="koboSpan" id="kobo.532.1">your data.</span></span></li>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.533.1">/expectations/</span></strong><span class="koboSpan" id="kobo.534.1">: This directory holds the Expectation Suites and Expectation files. </span><span class="koboSpan" id="kobo.534.2">An Expectation Suite is a collection of related Expectations, while Expectation files contain individual Expectations. </span><span class="koboSpan" id="kobo.534.3">You can create subdirectories within this folder to organize your Expectations based on a data source or </span><span class="No-Break"><span class="koboSpan" id="kobo.535.1">data asset.</span></span></li>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.536.1">/plugins/</span></strong><span class="koboSpan" id="kobo.537.1">: This folder is used to store custom plugins and extensions that you may develop to extend the functionality of </span><span class="No-Break"><span class="koboSpan" id="kobo.538.1">Great Expectations.</span></span></li>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.539.1">great_expectations.yml</span></strong><span class="koboSpan" id="kobo.540.1">: This configuration file stores the deployment settings for Great Expectations. </span><span class="koboSpan" id="kobo.540.2">It contains essential information and parameters that define how Great Expectations operates within your </span><span class="No-Break"><span class="koboSpan" id="kobo.541.1">deployment environment.</span></span></li>
			</ul>
			<p><span class="koboSpan" id="kobo.542.1">Now that </span><a id="_idIndexMarker227"/><span class="koboSpan" id="kobo.543.1">we’ve set up and initialized a Great Expectations project, let’s create our first data source using </span><span class="No-Break"><span class="koboSpan" id="kobo.544.1">Great Expectations.</span></span></p>
			<h2 id="_idParaDest-70"><span class="koboSpan" id="kobo.545.1">Create</span><a id="_idTextAnchor098"/><span class="koboSpan" id="kobo.546.1"> your first Great Expectations data source</span></h2>
			<p><span class="koboSpan" id="kobo.547.1">So far, we have created the project structure to create our Expectations. </span><span class="koboSpan" id="kobo.547.2">The next step is to get </span><a id="_idIndexMarker228"/><span class="koboSpan" id="kobo.548.1">some data to build Expectations on. </span><span class="koboSpan" id="kobo.548.2">In order to retrieve the dataset, go to the repository at </span><a href="https://github.com/PacktPublishing/Python-Data-Cleaning-and-Preparation-Best-Practices/tree/main/chapter03/great_expectations/code"><span class="koboSpan" id="kobo.549.1">https://github.com/PacktPublishing/Python-Data-Cleaning-and-Preparation-Best-Practices/tree/main/chapter03/great_expectations/code</span></a><span class="koboSpan" id="kobo.550.1">, get the </span><strong class="source-inline"><span class="koboSpan" id="kobo.551.1">1.data_set_up.py</span></strong><span class="koboSpan" id="kobo.552.1"> script, and save it under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.553.1">great_expectations/code/</span></strong><span class="koboSpan" id="kobo.554.1"> folder. </span><span class="koboSpan" id="kobo.554.2">Now, let’s write some test data to our folder by running the following Python script: </span><strong class="source-inline"><span class="koboSpan" id="kobo.555.1">great_expectations/code/1.data_set_up.py</span></strong><span class="koboSpan" id="kobo.556.1">. </span><span class="koboSpan" id="kobo.556.2">Here’s what the script </span><span class="No-Break"><span class="koboSpan" id="kobo.557.1">looks like:</span></span></p>
			<pre class="source-code"><span class="koboSpan" id="kobo.558.1">
import numpy as np
import pandas as pd
# Load the 'iris' dataset from seaborn library
iris_data = pd.read_csv('https ://raw.githubusercontent .com/mwaskom /seaborn-data /master/iris. </span><span class="koboSpan" id="kobo.558.2">csv')
iris_data.to_csv('../data/iris_data.csv', index=False)
print("File written! </span><span class="koboSpan" id="kobo.558.3">:)")</span></pre>			<p><span class="koboSpan" id="kobo.559.1">In your terminal, in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">great_expectations/code/</span></strong><span class="koboSpan" id="kobo.561.1"> directory, execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.562.1">following command:</span></span></p>
			<pre class="console"><span class="koboSpan" id="kobo.563.1">
python 1.data_set_up.py</span></pre>			<p><span class="koboSpan" id="kobo.564.1">This script performs a simple task of loading the </span><strong class="source-inline"><span class="koboSpan" id="kobo.565.1">iris</span></strong><span class="koboSpan" id="kobo.566.1"> dataset from a remote source, from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.567.1">seaborn</span></strong><span class="koboSpan" id="kobo.568.1"> library’s GitHub repository, using the pandas library. </span><span class="koboSpan" id="kobo.568.2">It then saves this dataset to a local file named </span><strong class="source-inline"><span class="koboSpan" id="kobo.569.1">iris_data.csv</span></strong><span class="koboSpan" id="kobo.570.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.571.1">great_expectations/data</span></strong><span class="koboSpan" id="kobo.572.1"> directory. </span><span class="koboSpan" id="kobo.572.2">Finally, it prints a confirmation message to indicate that the file has been </span><span class="No-Break"><span class="koboSpan" id="kobo.573.1">successfully saved.</span></span></p>
			<p><span class="koboSpan" id="kobo.574.1">Now, we need </span><a id="_idIndexMarker229"/><span class="koboSpan" id="kobo.575.1">to tell Great Expectations which data we want to use to build Great Expectations and where to find this data. </span><span class="koboSpan" id="kobo.575.2">In your terminal, execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">following command:</span></span></p>
			<pre class="console"><span class="koboSpan" id="kobo.577.1">
great_expectations datasource new</span></pre>			<p><span class="koboSpan" id="kobo.578.1">This will display the </span><span class="No-Break"><span class="koboSpan" id="kobo.579.1">following prompt:</span></span></p>
			<div>
				<div id="_idContainer028" class="IMG---Figure">
					<span class="koboSpan" id="kobo.580.1"><img src="image/B19801_03_16.jpg" alt="Figure 3.16 – Great Expectations file configuration"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.581.1">Figure 3.16 – Great Expectations file configuration</span></p>
			<p><span class="koboSpan" id="kobo.582.1">Follow the steps in the terminal, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.583.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.584.1">.16</span></em><span class="koboSpan" id="kobo.585.1">, making sure you choose option </span><strong class="source-inline"><span class="koboSpan" id="kobo.586.1">1</span></strong><span class="koboSpan" id="kobo.587.1"> as we are going to work with files and not SQL databases. </span><span class="koboSpan" id="kobo.587.2">Since our datasets are small enough to fit in memory, we can manipulate them with pandas. </span><span class="koboSpan" id="kobo.587.3">So, we’ll choose option </span><strong class="source-inline"><span class="koboSpan" id="kobo.588.1">1</span></strong><span class="koboSpan" id="kobo.589.1"> again. </span><span class="koboSpan" id="kobo.589.2">It will then prompt you to enter the path to the dataset file and since we saved our dataset in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.590.1">data</span></strong><span class="koboSpan" id="kobo.591.1"> folder, </span><span class="No-Break"><span class="koboSpan" id="kobo.592.1">enter </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.593.1">../data</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.594.1">.</span></span></p>
			<p><span class="koboSpan" id="kobo.595.1">After this step, Great Expectations automatically creates a Jupyter Notebook for us to explore! </span><span class="koboSpan" id="kobo.595.2">This notebook is stored at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.596.1">great_expectations/gx/uncommitted/datasource_new.ipynb</span></strong><span class="koboSpan" id="kobo.597.1"> path and after the execution, you can just delete it if you don’t want to maintain unnecessary code. </span><span class="koboSpan" id="kobo.597.2">The purpose of this notebook is to help you create a pandas data source configuration and avoid any </span><span class="No-Break"><span class="koboSpan" id="kobo.598.1">manual mistakes.</span></span></p>
			<p><span class="koboSpan" id="kobo.599.1">Let’s open the notebook, update </span><strong class="source-inline"><span class="koboSpan" id="kobo.600.1">datasource_name</span></strong><span class="koboSpan" id="kobo.601.1">, as shown in the following screenshot, and execute all the cells in </span><span class="No-Break"><span class="koboSpan" id="kobo.602.1">the notebook.</span></span></p>
			<div>
				<div id="_idContainer029" class="IMG---Figure">
					<span class="koboSpan" id="kobo.603.1"><img src="image/B19801_03_017.jpg" alt="Figure 3.17 – Great Expectations – customizing data source name"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.604.1">Figure 3.17 – Great Expectations – customizing data source name</span></p>
			<p><span class="koboSpan" id="kobo.605.1">We can </span><a id="_idIndexMarker230"/><span class="koboSpan" id="kobo.606.1">give it any name we want at this point, but to be consistent with the incoming data, let’s name it </span><strong class="source-inline"><span class="koboSpan" id="kobo.607.1">iris_data</span></strong><span class="koboSpan" id="kobo.608.1">. </span><span class="koboSpan" id="kobo.608.2">From now on, when we refer to </span><strong class="source-inline"><span class="koboSpan" id="kobo.609.1">iris_data</span></strong><span class="koboSpan" id="kobo.610.1">, we know we are working on the Expectations for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.611.1">iris</span></strong><span class="koboSpan" id="kobo.612.1"> data source we created in the </span><span class="No-Break"><span class="koboSpan" id="kobo.613.1">previous step.</span></span></p>
			<p class="callout-heading"><span class="koboSpan" id="kobo.614.1">Note</span></p>
			<p class="callout"><span class="koboSpan" id="kobo.615.1">Maintaining consistent and clear naming between Expectation validations and data sources enhances readability, reduces errors, and simplifies maintenance </span><span class="No-Break"><span class="koboSpan" id="kobo.616.1">and debugging!</span></span></p>
			<h2 id="_idParaDest-71"><a id="_idTextAnchor099"/><span class="koboSpan" id="kobo.617.1">Creating your first Great Expectations suite</span></h2>
			<p><span class="koboSpan" id="kobo.618.1">Now that we have declared which data source we want to build an Expectation for, let’s go ahead </span><a id="_idIndexMarker231"/><span class="koboSpan" id="kobo.619.1">and build the f</span><a id="_idTextAnchor100"/><span class="koboSpan" id="kobo.620.1">irst suite for our </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.621.1">iris</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.622.1"> dataset.</span></span></p>
			<p><span class="koboSpan" id="kobo.623.1">Open your terminal and execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.624.1">following command:</span></span></p>
			<pre class="console"><span class="koboSpan" id="kobo.625.1">
great_expectations suite new</span></pre>			<p><span class="koboSpan" id="kobo.626.1">There are multiple ways to create your Expectation Suite, as you can see from the </span><span class="No-Break"><span class="koboSpan" id="kobo.627.1">following figure.</span></span></p>
			<div>
				<div id="_idContainer030" class="IMG---Figure">
					<span class="koboSpan" id="kobo.628.1"><img src="image/B19801_03_18.jpg" alt="Figure 3.18 – Great Expectations – options for creating your suite"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.629.1">Figure 3.18 – Great Expectations – options for creating your suite</span></p>
			<p><span class="koboSpan" id="kobo.630.1">Let’s explore each of </span><span class="No-Break"><span class="koboSpan" id="kobo.631.1">the options:</span></span></p>
			<ul>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.632.1">Manually, without interacting with a sample batch of data (default)</span></strong><span class="koboSpan" id="kobo.633.1">: This approach involves manually defining Expectations and configuring the suite without directly interacting with a sample batch of data. </span><span class="koboSpan" id="kobo.633.2">Expectations are typically based on your knowledge of the data and the specific requirements of your project. </span><span class="koboSpan" id="kobo.633.3">You define Expectations by specifying conditions, ranges, patterns, and other criteria that you expect the data to meet. </span><span class="koboSpan" id="kobo.633.4">This approach requires a thorough understanding of the data and domain knowledge to define </span><span class="No-Break"><span class="koboSpan" id="kobo.634.1">accurate Expectations.</span></span></li>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.635.1">Interactively, with a sample batch of data</span></strong><span class="koboSpan" id="kobo.636.1">: In this approach, you load </span><a id="_idIndexMarker232"/><span class="koboSpan" id="kobo.637.1">a small representative batch of data into Great Expectations and use it to interactively define Expectations. </span><span class="koboSpan" id="kobo.637.2">This allows you to visually inspect the data, identify patterns, and explore various data statistics. </span><span class="koboSpan" id="kobo.637.3">You can iteratively build and refine Expectations based on your observations and understanding of </span><span class="No-Break"><span class="koboSpan" id="kobo.638.1">the data.</span></span></li>
				<li><strong class="source-inline"><span class="koboSpan" id="kobo.639.1">Automatically, using a Data Assistant</span></strong><span class="koboSpan" id="kobo.640.1">: Great Expectations provides a Data Assistant feature that automatically suggests Expectations based on the data. </span><span class="koboSpan" id="kobo.640.2">The Data Assistant analyzes the data and generates a set of suggested Expectations, which you can review and customize. </span><span class="koboSpan" id="kobo.640.3">This approach can be helpful when you have limited knowledge about the data or want to quickly generate a starting point for your Expectations. </span><span class="koboSpan" id="kobo.640.4">You can leverage the suggested Expectations as a foundation and further refine them based on your domain knowledge and specific requirements. </span><span class="koboSpan" id="kobo.640.5">The Data Assistant accelerates the process of building a suite by automating the initial </span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">Expectation generation.</span></span></li>
			</ul>
			<p><span class="koboSpan" id="kobo.642.1">In this example, we will use the third option to build the suite automatically. </span><span class="koboSpan" id="kobo.642.2">This functionality is similar to the one that pandas profiling offers and we have explored it before in the </span><em class="italic"><span class="koboSpan" id="kobo.643.1">Profiling data with pandas’ ydata_profiling</span></em><span class="koboSpan" id="kobo.644.1"> section. </span><span class="koboSpan" id="kobo.644.2">So, go ahead and choose option </span><strong class="source-inline"><span class="koboSpan" id="kobo.645.1">3</span></strong><span class="koboSpan" id="kobo.646.1"> in the terminal, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.647.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.648.1">.19</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.649.1">.</span></span></p>
			<div>
				<div id="_idContainer031" class="IMG---Figure">
					<span class="koboSpan" id="kobo.650.1"><img src="image/B19801_03_19.jpg" alt="Figure 3.19 – Great Expectations – the Data Assistant option"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.651.1">Figure 3.19 – Great Expectations – the Data Assistant option</span></p>
			<p><span class="koboSpan" id="kobo.652.1">As a next step, you will be asked to choose which data source you want to create the suite for, which is </span><a id="_idIndexMarker233"/><span class="koboSpan" id="kobo.653.1">the output from the previous step. </span><span class="koboSpan" id="kobo.653.2">Type </span><strong class="source-inline"><span class="koboSpan" id="kobo.654.1">1</span></strong><span class="koboSpan" id="kobo.655.1"> for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.656.1">iris_data</span></strong><span class="koboSpan" id="kobo.657.1"> source we built before and then input the name of the new Expectation </span><span class="No-Break"><span class="koboSpan" id="kobo.658.1">Suite: </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.659.1">expect_iris</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.660.1">.</span></span></p>
			<p><span class="koboSpan" id="kobo.661.1">After executing the preceding command, a new notebook will be created automatically at </span><strong class="source-inline"><span class="koboSpan" id="kobo.662.1">great_expectations/gx/uncommitted/edit_expect_iris.ipynb</span></strong><span class="koboSpan" id="kobo.663.1">. </span><span class="koboSpan" id="kobo.663.2">Open and read the notebook to understand the logic of the code; in summary, this notebook helps you choose columns and other factors from the data that you care about and lets the profiler create some Expectations for you that you can </span><span class="No-Break"><span class="koboSpan" id="kobo.664.1">adjust later.</span></span></p>
			<p><span class="koboSpan" id="kobo.665.1">You have the option to create Expectations for all the columns in your dataset or a subset of them, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.666.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.667.1">.20</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.668.1">.</span></span></p>
			<div>
				<div id="_idContainer032" class="IMG---Figure">
					<span class="koboSpan" id="kobo.669.1"><img src="image/B19801_03_20.jpg" alt="Figure 3.20 – Great Expectations – columns included in the Suite"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.670.1">Figure 3.20 – Great Expectations – columns included in the Suite</span></p>
			<p><span class="koboSpan" id="kobo.671.1">You can </span><a id="_idIndexMarker234"/><span class="koboSpan" id="kobo.672.1">add all the column names for which you do </span><em class="italic"><span class="koboSpan" id="kobo.673.1">not</span></em><span class="koboSpan" id="kobo.674.1"> want to create Expectations in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.675.1">exclude_column_name</span></strong><span class="koboSpan" id="kobo.676.1"> list. </span><span class="koboSpan" id="kobo.676.2">For any columns not added to the list, </span><strong class="source-inline"><span class="koboSpan" id="kobo.677.1">great_expectations</span></strong><span class="koboSpan" id="kobo.678.1"> will build Expectations for you. </span><span class="koboSpan" id="kobo.678.2">In our case, we want to create Expectations for all the columns, so we will leave the list empty, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.679.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.680.1">.21</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.681.1">.</span></span></p>
			<div>
				<div id="_idContainer033" class="IMG---Figure">
					<span class="koboSpan" id="kobo.682.1"><img src="image/B19801_03_21.jpg" alt="Figure 3.21 – Great Expectations – excluding columns from the Suite"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.683.1">Figure 3.21 – Great Expectations – excluding columns from the Suite</span></p>
			<p><span class="koboSpan" id="kobo.684.1">Remember to execute all the cells in the notebook and let’s have a look at all the different Expectations built automatically by </span><strong class="source-inline"><span class="koboSpan" id="kobo.685.1">great_expectations</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.686.1">for us.</span></span></p>
			<h2 id="_idParaDest-72"><a id="_idTextAnchor101"/><span class="koboSpan" id="kobo.687.1">Great Expectations Suite report</span></h2>
			<p><span class="koboSpan" id="kobo.688.1">Let’s have a look at the profiling created by </span><strong class="source-inline"><span class="koboSpan" id="kobo.689.1">great_expectations</span></strong><span class="koboSpan" id="kobo.690.1">. </span><span class="koboSpan" id="kobo.690.2">As you can see from </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.691.1">Figure 3</span></em></span><em class="italic"><span class="koboSpan" id="kobo.692.1">.22</span></em><span class="koboSpan" id="kobo.693.1">, 52 Expectations were created and all have successfully passed. </span><span class="koboSpan" id="kobo.693.2">We can monitor </span><a id="_idIndexMarker235"/><span class="koboSpan" id="kobo.694.1">the success percentage in the </span><strong class="bold"><span class="koboSpan" id="kobo.695.1">Overview</span></strong><span class="koboSpan" id="kobo.696.1"> tab to get a quick idea of how many Expectations pass every time a new data</span><a id="_idTextAnchor102"/><span class="koboSpan" id="kobo.697.1"> f</span><a id="_idTextAnchor103"/><span class="koboSpan" id="kobo.698.1">eed is coming to </span><span class="No-Break"><span class="koboSpan" id="kobo.699.1">your pipeline.</span></span></p>
			<div>
				<div id="_idContainer034" class="IMG---Figure">
					<span class="koboSpan" id="kobo.700.1"><img src="image/B19801_03_22.jpg" alt="Figure 3.22 – Report overview statistics"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.701.1">Figure 3.22 – Report overview statistics</span></p>
			<p><span class="koboSpan" id="kobo.702.1">Let’s have a closer look at what Expectations we are validating our data against. </span><span class="koboSpan" id="kobo.702.2">The first thing to consider is across-the-table or table-level Expectations, as show</span><a id="_idTextAnchor104"/><span class="koboSpan" id="kobo.703.1">n in the </span><span class="No-Break"><span class="koboSpan" id="kobo.704.1">following screenshot:</span></span></p>
			<div>
				<div id="_idContainer035" class="IMG---Figure">
					<span class="koboSpan" id="kobo.705.1"><img src="image/B19801_03_23.jpg" alt="Figure 3.23 – Table-level expectations"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.706.1">Figure 3.23 – Table-level expectations</span></p>
			<p><span class="koboSpan" id="kobo.707.1">These Expectations check if the columns in the dataset match a given set of column names and if the dataset has the expected number of columns. </span><span class="koboSpan" id="kobo.707.2">It can be useful for ensuring all expected columns are present in the incoming data. </span><span class="koboSpan" id="kobo.707.3">If the incoming data does not contain all the columns shown in the Expectations, then the process </span><span class="No-Break"><span class="koboSpan" id="kobo.708.1">will fail.</span></span></p>
			<div>
				<div id="_idContainer036" class="IMG---Figure">
					<span class="koboSpan" id="kobo.709.1"><img src="image/B19801_03_24.jpg" alt="Figure 3.24 – Column-level Expectations"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.710.1">Figure 3.24 – Column-level Expectations</span></p>
			<p><span class="koboSpan" id="kobo.711.1">The next set of Expectations is created for each of the columns in the table and we will refer to t</span><a id="_idTextAnchor105"/><span class="koboSpan" id="kobo.712.1">hem as </span><span class="No-Break"><span class="koboSpan" id="kobo.713.1">feature Expectations.</span></span></p>
			<div>
				<div id="_idContainer037" class="IMG---Figure">
					<span class="koboSpan" id="kobo.714.1"><img src="image/B19801_03_25.jpg" alt="Figure 3.25 – Feature-level Expectations"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.715.1">Figure 3.25 – Feature-level Expectations</span></p>
			<p><span class="koboSpan" id="kobo.716.1">These Expectations are checked separately for each column, and they can contain min and max </span><a id="_idIndexMarker236"/><span class="koboSpan" id="kobo.717.1">values for the feature, whether we accept null values in the column or not, and many others. </span><span class="koboSpan" id="kobo.717.2">Remember, up to this point, all the Expectations were built automatically by us using a tool that does not understand the business context of the data. </span><span class="koboSpan" id="kobo.717.3">So, remember to check the Expectations and update them based on the business understanding of the data, as we will show in the </span><span class="No-Break"><span class="koboSpan" id="kobo.718.1">next part.</span></span></p>
			<h2 id="_idParaDest-73"><span class="koboSpan" id="kobo.719.1">Man</span><a id="_idTextAnchor106"/><span class="koboSpan" id="kobo.720.1">ually edit Great Expectations</span></h2>
			<p><span class="koboSpan" id="kobo.721.1">While </span><a id="_idIndexMarker237"/><span class="koboSpan" id="kobo.722.1">automatically generated Expectations provide a good starting point, they may not be sufficient for production-ready data validation. </span><span class="koboSpan" id="kobo.722.2">At this stage, it is important to further refine and customize the suite. </span><span class="koboSpan" id="kobo.722.3">You have the option to edit the suite manually or interactively. </span><span class="koboSpan" id="kobo.722.4">In general, manual editing is preferred when you have a clear understanding of the expected data properties and want to define Expectations efficiently and precisely. </span><span class="koboSpan" id="kobo.722.5">Since we’ve already done a basic automatic profiling of the data, we will proceed with the manual </span><span class="No-Break"><span class="koboSpan" id="kobo.723.1">editing approach.</span></span></p>
			<p><span class="koboSpan" id="kobo.724.1">Open the terminal and execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.725.1">following command:</span></span></p>
			<pre class="console"><span class="koboSpan" id="kobo.726.1">
great_expectations suite edit expect_iris</span></pre>			<p><span class="koboSpan" id="kobo.727.1">You will be prompted to choose how you want to update the suite, either manually or interactively. </span><span class="koboSpan" id="kobo.727.2">We will proceed with </span><span class="No-Break"><span class="koboSpan" id="kobo.728.1">it manually.</span></span></p>
			<p><span class="koboSpan" id="kobo.729.1">Upon providing the necessary input, Great Expectations opens the Jupyter Notebook available at the following location: </span><strong class="source-inline"><span class="koboSpan" id="kobo.730.1">great_expectations/gx/uncommitted/edit_expect_iris.ipynb</span></strong><span class="koboSpan" id="kobo.731.1">. </span><span class="koboSpan" id="kobo.731.2">The notebook includes a comprehensive display of all the Expectations that were automatically </span><a id="_idIndexMarker238"/><span class="koboSpan" id="kobo.732.1">generated. </span><span class="koboSpan" id="kobo.732.2">This allows you to review and examine the Expectations in detail, providing you with a clear overview of the validation rules that Great Expectations has inferred from the data. </span><span class="koboSpan" id="kobo.732.3">Have a look at all the Expectations we created and update them as necessary. </span><span class="koboSpan" id="kobo.732.4">In case you don’t want to use notebooks, you can go open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.733.1">great_expectations/gx/expectations/expect_iris.json</span></strong><span class="koboSpan" id="kobo.734.1"> file and update </span><span class="No-Break"><span class="koboSpan" id="kobo.735.1">it there.</span></span></p>
			<h2 id="_idParaDest-74"><a id="_idTextAnchor107"/><span class="koboSpan" id="kobo.736.1">Checkpoints</span></h2>
			<p><span class="koboSpan" id="kobo.737.1">So far, we have established a connection to our training dataset and defined our Expectations </span><a id="_idIndexMarker239"/><span class="koboSpan" id="kobo.738.1">based on the training data. </span><span class="koboSpan" id="kobo.738.2">The next step is to apply these Expectations to our new stream of data in order to validate the new dataset and make sure it passes the checks. </span><span class="koboSpan" id="kobo.738.3">So, we need to create the connection between the Great Expectation suite and the new data to validate. </span><span class="koboSpan" id="kobo.738.4">We can do this with a checkpoint. </span><span class="koboSpan" id="kobo.738.5">To achieve this, we will first mock some test data to apply the Expectations. </span><span class="koboSpan" id="kobo.738.6">You can find the script at the following </span><span class="No-Break"><span class="koboSpan" id="kobo.739.1">location: </span></span><a href="https://github.com/PacktPublishing/Python-Data-Cleaning-and-Preparation-Best-Practices/blob/main/chapter03/great_expectations/code/2.mock_test_dataset.py"><span class="No-Break"><span class="koboSpan" id="kobo.740.1">https://github.com/PacktPublishing/Python-Data-Cleaning-and-Preparation-Best-Practices/blob/main/chapter03/great_expectations/code/2.mock_test_dataset.py</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.741.1">.</span></span></p>
			<p><span class="koboSpan" id="kobo.742.1">Save it under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.743.1">great_expectations/code/</span></strong><span class="koboSpan" id="kobo.744.1"> folder. </span><span class="koboSpan" id="kobo.744.2">The script takes care of saving the test file in the required location, which </span><span class="No-Break"><span class="koboSpan" id="kobo.745.1">is </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.746.1">great_expectations/data/</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.747.1">.</span></span></p>
			<p><span class="koboSpan" id="kobo.748.1">In your terminal, in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.749.1">great_expectations/code/</span></strong><span class="koboSpan" id="kobo.750.1"> directory, execute </span><span class="No-Break"><span class="koboSpan" id="kobo.751.1">the followi</span><a id="_idTextAnchor108"/><span class="koboSpan" id="kobo.752.1">ng:</span></span></p>
			<pre class="console"><span class="koboSpan" id="kobo.753.1">
python 2.mock_test_dataset.py</span></pre>			<p><span class="koboSpan" id="kobo.754.1">Let’s have a closer look at the code we just executed, starting with the </span><span class="No-Break"><span class="koboSpan" id="kobo.755.1">import statements:</span></span></p>
			<pre class="source-code"><span class="koboSpan" id="kobo.756.1">
import numpy as np
import pandas as pd</span></pre>			<p><span class="koboSpan" id="kobo.757.1">Load the </span><strong class="source-inline"><span class="koboSpan" id="kobo.758.1">iris</span></strong><span class="koboSpan" id="kobo.759.1"> dataset from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.760.1">seaborn</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.761.1"> library:</span></span></p>
			<pre class="source-code"><span class="koboSpan" id="kobo.762.1">
iris_data = pd.read_csv('https: //raw.githubusercontent.com/ mwaskom/seaborn-data /master/iris. </span><span class="koboSpan" id="kobo.762.2">csv')</span></pre>			<p><span class="koboSpan" id="kobo.763.1">We will do </span><a id="_idIndexMarker240"/><span class="koboSpan" id="kobo.764.1">some transformations that will fail the Expectations and, in this case, we will update the </span><strong class="source-inline"><span class="koboSpan" id="kobo.765.1">sepal_length</span></strong><span class="koboSpan" id="kobo.766.1"> values to </span><strong class="source-inline"><span class="koboSpan" id="kobo.767.1">60</span></strong><span class="koboSpan" id="kobo.768.1">, which will break </span><span class="No-Break"><span class="koboSpan" id="kobo.769.1">our Expectations:</span></span></p>
			<pre class="source-code"><span class="koboSpan" id="kobo.770.1">
iris_data['sepal_length'] = 60</span></pre>			<p><span class="koboSpan" id="kobo.771.1">We will also rename columns to showcase the change in column names and by extension to the expected schema of </span><span class="No-Break"><span class="koboSpan" id="kobo.772.1">the data:</span></span></p>
			<pre class="source-code"><span class="koboSpan" id="kobo.773.1">
iris_data.rename(columns={'petal_width': 'petal_w'}, inplace=True)</span></pre>			<p><span class="koboSpan" id="kobo.774.1">We will write DataFrame that will work as a new data feed to test our </span><span class="No-Break"><span class="koboSpan" id="kobo.775.1">Expectations against:</span></span></p>
			<pre class="source-code"><span class="koboSpan" id="kobo.776.1">
iris_data.to_csv('../data/iris_data_test.csv', index=False)
print("File written! </span><span class="koboSpan" id="kobo.776.2">:)")</span></pre>			<p><span class="koboSpan" id="kobo.777.1">Then, we need to create a checkpoint that will execute the Great Expectation Suite we created on the test dataset. </span><span class="koboSpan" id="kobo.777.2">To initiate the checkpoint, you can run the following command in </span><span class="No-Break"><span class="koboSpan" id="kobo.778.1">your terminal:</span></span></p>
			<pre class="console"><span class="koboSpan" id="kobo.779.1">
great_expectations checkpoint new expect_iris_ckpnt</span></pre>			<p><span class="koboSpan" id="kobo.780.1">Upon execution, Great Expectations automatically generates a Jupyter Notebook that provides valuable information about the checkpoint here: </span><strong class="source-inline"><span class="koboSpan" id="kobo.781.1">/great_expectations/gx/uncommitted/edit_checkpoint_expect_iris_ckpnt.ipynb</span></strong><span class="koboSpan" id="kobo.782.1">. </span><span class="koboSpan" id="kobo.782.2">This includes details about the data to which the checkpoint will be applied. </span><span class="koboSpan" id="kobo.782.3">Before executing the notebook, we need to update the file name and point it to the </span><a id="_idIndexMarker241"/><span class="koboSpan" id="kobo.783.1">test file, as </span><span class="No-Break"><span class="koboSpan" id="kobo.784.1">shown here:</span></span></p>
			<pre class="source-code"><span class="koboSpan" id="kobo.785.1">
my_checkpoint_name = "expect_iris_ckpnt" # This was populated from your CLI command.
</span><span class="koboSpan" id="kobo.785.2">yaml_config = f"""
name: {my_checkpoint_name}
config_version: 1.0
class_name: SimpleCheckpoint
run_name_template: "%Y%m%d-%H%M%S-my-run-name-template"
validations:
    - batch_request:
        datasource_name: iris_data.csv
        data_connector_name: default_inferred_data_connector_name
        data_asset_name: </span><strong class="bold"><span class="koboSpan" id="kobo.786.1">iris_data_test.csv</span></strong><span class="koboSpan" id="kobo.787.1">
        data_connector_query:
          index: -1
    expectation_suite_name: expect_iris
"""
print(yaml_config)</span></pre>			<p><span class="koboSpan" id="kobo.788.1">Uncomment the last two lines and then execute all the cells of </span><span class="No-Break"><span class="koboSpan" id="kobo.789.1">the notebook:</span></span></p>
			<pre class="source-code"><span class="koboSpan" id="kobo.790.1">
context.run_checkpoint(checkpoint_name=my_checkpoint_name)
context.open_data_docs()</span></pre>			<p><span class="koboSpan" id="kobo.791.1">The preceding notebook will apply the checkpoint to the new dataset and create a report of all the Expectations that have passed or failed. </span><span class="koboSpan" id="kobo.791.2">Let’s see </span><span class="No-Break"><span class="koboSpan" id="kobo.792.1">the results!</span></span></p>
			<div>
				<div id="_idContainer038" class="IMG---Figure">
					<span class="koboSpan" id="kobo.793.1"><img src="image/B19801_03_26.jpg" alt="Figure 3.26 – Expectations results"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.794.1">Figure 3.26 – Expectations results</span></p>
			<p><span class="koboSpan" id="kobo.795.1">As expected, our Expectations failed on the column names and on the petal width as it cannot find </span><a id="_idIndexMarker242"/><span class="koboSpan" id="kobo.796.1">the right column names because of </span><span class="No-Break"><span class="koboSpan" id="kobo.797.1">schema changes.</span></span></p>
			<div>
				<div id="_idContainer039" class="IMG---Figure">
					<span class="koboSpan" id="kobo.798.1"><img src="image/B19801_03_27.jpg" alt="Figure 3.27 – Expectations failures because of schema changes"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.799.1">Figure 3.27 – Expectations failures because of schema changes</span></p>
			<p><span class="koboSpan" id="kobo.800.1">It also alerted us about the </span><strong class="source-inline"><span class="koboSpan" id="kobo.801.1">sepal_length</span></strong><span class="koboSpan" id="kobo.802.1"> variable as all the values are unexpected and outside of the accepted range of values it has seen </span><span class="No-Break"><span class="koboSpan" id="kobo.803.1">so far!</span></span></p>
			<div>
				<div id="_idContainer040" class="IMG---Figure">
					<span class="koboSpan" id="kobo.804.1"><img src="image/B19801_03_28.jpg" alt="Figure 3.28 – Expectations failures because of out-of-range values"/></span>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.805.1">Figure 3.28 – Expectations failures because of out-of-range values</span></p>
			<p><span class="koboSpan" id="kobo.806.1">Can you see how many problems it could save us from? </span><span class="koboSpan" id="kobo.806.2">If this data was not checked and had been ingested, the subsequent processes and integration pipelines would fail, and a lot of work would be needed to try and identify which process failed and why. </span><span class="koboSpan" id="kobo.806.3">In our case, we know exactly where the problem started, and we have a clear idea of what we need to do to </span><span class="No-Break"><span class="koboSpan" id="kobo.807.1">fix it.</span></span></p>
			<p class="callout-heading"><span class="koboSpan" id="kobo.808.1">Note</span></p>
			<p class="callout"><span class="koboSpan" id="kobo.809.1">Checkpoints </span><a id="_idIndexMarker243"/><span class="koboSpan" id="kobo.810.1">are designed to be reusable, so you can run the same checkpoint configuration against multiple batches of data as they arrive. </span><span class="koboSpan" id="kobo.810.2">This allows you to consistently validate incoming data against the same set of Expectations. </span><span class="koboSpan" id="kobo.810.3">Additionally, checkpoints can be enhanced with various actions, such as sending notifications, updating data documentation (Data Docs), or triggering downstream processes based on the </span><span class="No-Break"><span class="koboSpan" id="kobo.811.1">validation results.</span></span></p>
			<p><span class="koboSpan" id="kobo.812.1">Now, if you are </span><a id="_idIndexMarker244"/><span class="koboSpan" id="kobo.813.1">impressed by the automation that Great Expectations provides and you wish to see how you can migrate all the pandas profiling you’ve been doing so far to Great Expectations Suites, then we’ve go</span><a id="_idTextAnchor109"/><span class="koboSpan" id="kobo.814.1">t you covered. </span><span class="koboSpan" id="kobo.814.2">Just </span><span class="No-Break"><span class="koboSpan" id="kobo.815.1">keep reading.</span></span></p>
			<h2 id="_idParaDest-75"><a id="_idTextAnchor110"/><span class="koboSpan" id="kobo.816.1">Using pandas profiler to build your Great Expectations Suite</span></h2>
			<p><span class="koboSpan" id="kobo.817.1">The pandas profiler has a functionality that allows you to build Expectation Suites out of a pandas </span><a id="_idIndexMarker245"/><span class="koboSpan" id="kobo.818.1">profiling exercise. </span><span class="koboSpan" id="kobo.818.2">Let’s look at the following </span><span class="No-Break"><span class="koboSpan" id="kobo.819.1">example </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.820.1">great_expectations/code/3.with_pandas_profiler.py</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.821.1">:</span></span></p>
			<pre class="source-code"><span class="koboSpan" id="kobo.822.1">
import pandas as pd
from ydata_profiling import ProfileReport
# Load the 'iris' dataset from seaborn library
iris_data = pd.read_csv('https: //raw.githubusercontent. </span><span class="koboSpan" id="kobo.822.2">com/mwaskom/seaborn-data /master/iris. </span><span class="koboSpan" id="kobo.822.3">csv')
# run Pandas Profiling
profile = ProfileReport(iris_data, title="Pandas Profiling Report", explorative=True)
# obtain an Expectation Suite from the profiling
suite = profile.to_expectation_suite(suite_name="my_pandas_profiling_suite")</span></pre>			<p><span class="koboSpan" id="kobo.823.1">In this code snippet, we have taken our data and have created a pandas profiling. </span><span class="koboSpan" id="kobo.823.2">Then, we </span><a id="_idIndexMarker246"/><span class="koboSpan" id="kobo.824.1">obtained an Expectation Suite from the report created previously. </span><span class="koboSpan" id="kobo.824.2">We can use this suite to further validate and check another batch </span><span class="No-Break"><span class="koboSpan" id="kobo.825.1">of data.</span></span></p>
			<p><span class="koboSpan" id="kobo.826.1">So far, we have reviewed different profiling tools and how they work. </span><span class="koboSpan" id="kobo.826.2">The next step is to get a better understanding of when to</span><a id="_idTextAnchor111"/><span class="koboSpan" id="kobo.827.1"> use which tool and where </span><span class="No-Break"><span class="koboSpan" id="kobo.828.1">to start.</span></span></p>
			<h1 id="_idParaDest-76"><a id="_idTextAnchor112"/><span class="koboSpan" id="kobo.829.1">Comparing Great Expectations and pandas profiler – when to use what</span></h1>
			<p><span class="koboSpan" id="kobo.830.1">Pandas profiling and </span><a id="_idIndexMarker247"/><span class="koboSpan" id="kobo.831.1">Great Expectations </span><a id="_idIndexMarker248"/><span class="koboSpan" id="kobo.832.1">are both valuable tools for data profiling and analysis, but they have different strengths and use cases. </span><span class="koboSpan" id="kobo.832.2">Here’s a comparison between the </span><span class="No-Break"><span class="koboSpan" id="kobo.833.1">two tools.</span></span></p>
			<table id="table003-1" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.834.1">Pandas Profiler</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.835.1">Great Expectations</span></strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.836.1">Data Exploration</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.837.1">Provides quick insights and exploratory </span><span class="No-Break"><span class="koboSpan" id="kobo.838.1">data summaries</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.839.1">Focuses on data validation </span><span class="No-Break"><span class="koboSpan" id="kobo.840.1">and documentation</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.841.1">Data Validation</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.842.1">Limited data </span><span class="No-Break"><span class="koboSpan" id="kobo.843.1">validation capabilities</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.844.1">Advanced data validation with explicit Expectations </span><span class="No-Break"><span class="koboSpan" id="kobo.845.1">and rules</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.846.1">Customization</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.847.1">Limited </span><span class="No-Break"><span class="koboSpan" id="kobo.848.1">customization options</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.849.1">Extensive customization for defining Expectations </span><span class="No-Break"><span class="koboSpan" id="kobo.850.1">and rules</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.851.1">Learning Curve</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.852.1">Relatively easy </span><span class="No-Break"><span class="koboSpan" id="kobo.853.1">to use</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.854.1">A steeper learning curve for defining Expectations </span><span class="No-Break"><span class="koboSpan" id="kobo.855.1">and configuration</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.856.1">Scalability</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.857.1">Suitable for small- to </span><span class="No-Break"><span class="koboSpan" id="kobo.858.1">medium-scale data</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.859.1">Scalable for big data environments with </span><span class="No-Break"><span class="koboSpan" id="kobo.860.1">distributed processing</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.861.1">Visualizations</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.862.1">Generates </span><span class="No-Break"><span class="koboSpan" id="kobo.863.1">interactive visualizations</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.864.1">Focuses more on validating and documenting data rather </span><span class="No-Break"><span class="koboSpan" id="kobo.865.1">than visuals</span></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.866.1">Use Case</span></strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.867.1">Quick data exploration and </span><span class="No-Break"><span class="koboSpan" id="kobo.868.1">initial insights</span></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="koboSpan" id="kobo.869.1">Data quality control and enforcing </span><span class="No-Break"><span class="koboSpan" id="kobo.870.1">data consistency</span></span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.871.1">Table 3.2 – Great Expectations and pandas profiler comparison</span></p>
			<p><span class="koboSpan" id="kobo.872.1">Pandas profiling is </span><a id="_idIndexMarker249"/><span class="koboSpan" id="kobo.873.1">well suited for quick data </span><a id="_idIndexMarker250"/><span class="koboSpan" id="kobo.874.1">exploration and initial insights, while Great Expectations excels in data validation, documentation, and enforcing data quality rules. </span><span class="koboSpan" id="kobo.874.2">Pandas profiling is more beginner-friendly and provides immediate insights, while Great Expectations offers more advanced customization options and scalability for larger datasets. </span><span class="koboSpan" id="kobo.874.3">The choice between the two depends on the specific requirements of the project and the level of data quality </span><span class="No-Break"><span class="koboSpan" id="kobo.875.1">control needed.</span></span></p>
			<p><span class="koboSpan" id="kobo.876.1">As the volume of data increases, we need to make sure that the choice of tools we’ve made can scale as well. </span><span class="koboSpan" id="kobo.876.2">Let’s have a look at how we can do this with </span><span class="No-Break"><span class="koboSpan" id="kobo.877.1">Great Expectations.</span></span><a id="_idTextAnchor113"/></p>
			<h2 id="_idParaDest-77"><a id="_idTextAnchor114"/><span class="koboSpan" id="kobo.878.1">Great Expectations and big data</span></h2>
			<p><span class="koboSpan" id="kobo.879.1">While Great Expectations can be used effectively with smaller datasets, it also provides mechanisms </span><a id="_idIndexMarker251"/><span class="koboSpan" id="kobo.880.1">to address the challenges associated with scaling data validation and documentation for big data environments. </span><span class="koboSpan" id="kobo.880.2">Here are some considerations for scaling Great Expectations as data </span><span class="No-Break"><span class="koboSpan" id="kobo.881.1">size increases:</span></span></p>
			<ul>
				<li><strong class="bold"><span class="koboSpan" id="kobo.882.1">Distributed processing frameworks</span></strong><span class="koboSpan" id="kobo.883.1">: Great Expectations integrates seamlessly with popular distributed processing frameworks, such as Apache Spark. </span><span class="koboSpan" id="kobo.883.2">By leveraging the parallel processing capabilities of these frameworks, Great Expectations can distribute the data validation workload across a cluster, allowing for efficient processing </span><span class="No-Break"><span class="koboSpan" id="kobo.884.1">and scalability.</span></span></li>
				<li><strong class="bold"><span class="koboSpan" id="kobo.885.1">Partitioning and sampling</span></strong><span class="koboSpan" id="kobo.886.1">: Great Expectations simplifies the process of partitioning and sampling large datasets and enhancing performances and scalability. </span><span class="koboSpan" id="kobo.886.2">Unlike the manual partitioning required in tools such as pandas profiling, Great Expectations automates the creation of data subsets or partitions for profiling and validation. </span><span class="koboSpan" id="kobo.886.3">This feature allows you to validate specific subsets or partitions of the data, rather than processing the entire dataset at once. </span><span class="koboSpan" id="kobo.886.4">By automating the partitioning process, Great Expectations streamlines the profiling </span><a id="_idIndexMarker252"/><span class="koboSpan" id="kobo.887.1">workflow and eliminates the need for manual chunk creation, saving time </span><span class="No-Break"><span class="koboSpan" id="kobo.888.1">and effort.</span></span></li>
				<li><strong class="bold"><span class="koboSpan" id="kobo.889.1">Incremental validation</span></strong><span class="koboSpan" id="kobo.890.1">: Instead of revalidating the entire big dataset every time, Great Expectations supports incremental validation. </span><span class="koboSpan" id="kobo.890.2">This means that as new data is ingested or processed, only the relevant portions or changes need to be validated, reducing the overall validation time and effort. </span><span class="koboSpan" id="kobo.890.3">This is a great trick to reduce the time it takes to check the whole data and optimize </span><span class="No-Break"><span class="koboSpan" id="kobo.891.1">for cost!</span></span></li>
				<li><strong class="bold"><span class="koboSpan" id="kobo.892.1">Caching and memoization</span></strong><span class="koboSpan" id="kobo.893.1">: Great Expectations incorporates caching and memoization techniques to optimize performance when repeatedly executing the same validations. </span><span class="koboSpan" id="kobo.893.2">This can be particularly beneficial when working with large datasets, as previously computed results can be stored and reused, minimizing </span><span class="No-Break"><span class="koboSpan" id="kobo.894.1">redundant computations.</span></span></li>
				<li><strong class="bold"><span class="koboSpan" id="kobo.895.1">Cloud-based infrastructure</span></strong><span class="koboSpan" id="kobo.896.1">: Leveraging cloud-based infrastructure and services can enhance scalability for Great Expectations. </span><span class="koboSpan" id="kobo.896.2">By leveraging cloud computing platforms, such as AWS or Azure, you can dynamically scale resources to handle increased data volumes and </span><span class="No-Break"><span class="koboSpan" id="kobo.897.1">processing demands</span></span></li>
				<li><strong class="bold"><span class="koboSpan" id="kobo.898.1">Efficient data storage</span></strong><span class="koboSpan" id="kobo.899.1">: Choosing appropriate data storage technologies optimized for big data, such as distributed file systems or columnar databases, can improve the performance and scalability of Great Expectations. </span><span class="koboSpan" id="kobo.899.2">These technologies are designed to handle large-scale data efficiently and provide faster access for validation and </span><span class="No-Break"><span class="koboSpan" id="kobo.900.1">processing tasks.</span></span></li>
			</ul>
			<p class="callout-heading"><span class="koboSpan" id="kobo.901.1">Note</span></p>
			<p class="callout"><span class="koboSpan" id="kobo.902.1">While Great Expectations offers scalability options, the specific scalability measures may depend on the underlying infrastructure, data storage systems, and distributed processing frameworks employed in your big </span><span class="No-Break"><span class="koboSpan" id="kobo.903.1">data environment.</span></span></p>
			<h1 id="_idParaDest-78"><a id="_idTextAnchor115"/><span class="koboSpan" id="kobo.904.1">Summary</span></h1>
			<p><span class="koboSpan" id="kobo.905.1">This chapter detailed how data profiling is crucial for ensuring the quality, integrity, and reliability of datasets. </span><span class="koboSpan" id="kobo.905.2">The process involves in-depth analysis to understand the structure, patterns, and potential issues within the data. </span><span class="koboSpan" id="kobo.905.3">For effective profiling, tools such as pandas profiling and Great Expectations offer powerful solutions. </span><span class="koboSpan" id="kobo.905.4">Pandas profiling automates the generation of comprehensive reports, providing valuable insights into data characteristics. </span><span class="koboSpan" id="kobo.905.5">Great Expectations, on the other hand, facilitates the creation of data quality Expectations and allows for systematic validation. </span><span class="koboSpan" id="kobo.905.6">While these tools excel in smaller datasets, scaling profiling to big data requires specialized approaches. </span><span class="koboSpan" id="kobo.905.7">Learning the tips and tricks, such as data sampling and parallel processing, enables efficient and scalable profiling on </span><span class="No-Break"><span class="koboSpan" id="kobo.906.1">large datasets.</span></span></p>
			<p><span class="koboSpan" id="kobo.907.1">In the next chapter, we will focus on how to clean and manipulate data to make sure it is in the right format to pass Expectations and be </span><span class="No-Break"><span class="koboSpan" id="kobo.908.1">successfully ingested.</span></span></p>
		</div>
	</body></html>