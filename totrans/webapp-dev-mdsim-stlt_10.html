<html><head></head><body>
<div id="_idContainer227">
<h1 class="chapter-number" id="_idParaDest-109"><a id="_idTextAnchor109"/><span class="koboSpan" id="kobo.1.1">10</span></h1>
<h1 id="_idParaDest-110"><a id="_idTextAnchor110"/><span class="koboSpan" id="kobo.2.1">Utilizing Pretrained Models to Create Specialized and Personalized Web Applications</span></h1>
<p><span class="koboSpan" id="kobo.3.1">So far, we have used Streamlit’s components and libraries, made in Python, to create and build up our web application. </span><span class="koboSpan" id="kobo.3.2">However, with Streamlit, we can do </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">even more.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">This incredible </span><a id="_idIndexMarker349"/><span class="koboSpan" id="kobo.6.1">framework is extremely powerful when used with </span><strong class="bold"><span class="koboSpan" id="kobo.7.1">artificial intelligence</span></strong><span class="koboSpan" id="kobo.8.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.9.1">AI</span></strong><span class="koboSpan" id="kobo.10.1">) models to make predictions. </span><span class="koboSpan" id="kobo.10.2">Developing </span><strong class="bold"><span class="koboSpan" id="kobo.11.1">machine learning</span></strong><span class="koboSpan" id="kobo.12.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.13.1">ML</span></strong><span class="koboSpan" id="kobo.14.1">) models or </span><a id="_idIndexMarker350"/><span class="koboSpan" id="kobo.15.1">neural networks is something very complex and outside the scope of this book, but considering that there are a lot of pretrained models available that perform well to provide solutions for many different use cases, knowing how to use them in our web application to increase their effectiveness and usefulness is something </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">very important.</span></span></p>
<p><span class="koboSpan" id="kobo.17.1">Simply put, importing and using pretrained ML models in Streamlit is an advanced technique for creating very powerful web applications. </span><span class="koboSpan" id="kobo.17.2">Users can import any kind of pretrained model and use it to make predictions on new data within their Streamlit web apps. </span><span class="koboSpan" id="kobo.17.3">This opens a world of new, more customized, and specialized applications tailored to any kind of </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">specific needs.</span></span></p>
<p><span class="koboSpan" id="kobo.19.1">In this chapter, we’ll cover the following </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">main topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.21.1">Understanding the benefits of pretrained </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">ML models</span></span></li>
<li><span class="koboSpan" id="kobo.23.1">Creating customized web apps to improve </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">user experience</span></span></li>
<li><span class="koboSpan" id="kobo.25.1">Utilizing predictions </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">from ML</span></span></li>
</ul>
<h1 id="_idParaDest-111"><a id="_idTextAnchor111"/><span class="koboSpan" id="kobo.27.1">Technical requirements</span></h1>
<ul>
<li><span class="koboSpan" id="kobo.28.1">In this chapter, we will be using the following libraries, packages, </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">and tools:</span></span><ul><li><span class="No-Break"><span class="koboSpan" id="kobo.30.1">Sublime Text</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.31.1">Python 3</span></span></li><li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.32.1">pipenv</span></strong></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.33.1">Streamlit</span></span></li><li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.34.1">OpenCV</span></strong></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.35.1">Pillow</span></span></li><li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.36.1">numpy</span></strong></span></li><li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.37.1">tensorflow</span></strong></span></li></ul></li>
<li><span class="koboSpan" id="kobo.38.1">The code for this chapter can be found in this book’s GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.39.1">repository: </span></span><a href="https://github.com/PacktPublishing/Web-App-Development-Made-Simple-with-Streamlit/tree/7c29f4eca8b189b4f711cc8f724c6dee9dba60ab/Chapter10"><span class="No-Break"><span class="koboSpan" id="kobo.40.1">https://github.com/PacktPublishing/Web-App-Development-Made-Simple-with-Streamlit/tree/7c29f4eca8b189b4f711cc8f724c6dee9dba60ab/Chapter10</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.41.1">.</span></span></li>
</ul>
<h1 id="_idParaDest-112"><a id="_idTextAnchor112"/><span class="koboSpan" id="kobo.42.1">Understanding the benefits of pretrained ML models</span></h1>
<p><span class="koboSpan" id="kobo.43.1">In this short section, I will try to clarify why using pretrained ML models inside our web applications can be a very good and </span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">valuable idea.</span></span></p>
<p><span class="koboSpan" id="kobo.45.1">ML has rapidly </span><a id="_idIndexMarker351"/><span class="koboSpan" id="kobo.46.1">evolved in recent years, offering unprecedented opportunities to enhance web applications with intelligent and predictive features. </span><span class="koboSpan" id="kobo.46.2">Streamlit, a popular Python library for creating interactive web applications, has gained immense popularity due to its simplicity and flexibility. </span><span class="koboSpan" id="kobo.46.3">When combined with pretrained ML models, Streamlit can empower developers to build web applications that leverage the vast potential </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">of AI.</span></span></p>
<p><span class="koboSpan" id="kobo.48.1">Pretrained ML models are models that have been trained on large datasets for various tasks, such as image recognition, natural language processing, and more. </span><span class="koboSpan" id="kobo.48.2">These models have learned rich data representations and can be fine-tuned for specific applications. </span><span class="koboSpan" id="kobo.48.3">Incorporating pretrained models into Streamlit web applications can significantly enhance their capabilities and provide a seamless </span><span class="No-Break"><span class="koboSpan" id="kobo.49.1">user experience.</span></span></p>
<p><span class="koboSpan" id="kobo.50.1">Here are some of the key benefits associated with using pretrained </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">AI models:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.52.1">Efficient development</span></strong><span class="koboSpan" id="kobo.53.1">: One of the primary benefits of using pretrained models is the reduction in development time. </span><span class="koboSpan" id="kobo.53.2">Instead of starting from scratch and training a model from the ground up, developers can leverage existing pretrained models, saving both time and resources. </span><span class="koboSpan" id="kobo.53.3">Streamlit’s straightforward interface complements this efficiency by enabling developers to quickly integrate these models into </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">their applications.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.55.1">Improved user experience</span></strong><span class="koboSpan" id="kobo.56.1">: Pretrained models bring state-of-the-art capabilities to web applications, enabling features such as image recognition, sentiment analysis, and language translation. </span><span class="koboSpan" id="kobo.56.2">Users can interact with the application </span><a id="_idIndexMarker352"/><span class="koboSpan" id="kobo.57.1">more naturally, making it more engaging and user-friendly. </span><span class="koboSpan" id="kobo.57.2">For example, a product recommendation system powered by a pretrained model can enhance the shopping experience on an e-commerce website built </span><span class="No-Break"><span class="koboSpan" id="kobo.58.1">with Streamlit.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.59.1">Scalability and performance</span></strong><span class="koboSpan" id="kobo.60.1">: Pretrained models are often designed to handle complex tasks, making them suitable for a wide range of applications. </span><span class="koboSpan" id="kobo.60.2">Streamlit’s ability to efficiently serve web applications makes it a perfect companion for pretrained models. </span><span class="koboSpan" id="kobo.60.3">Whether it’s processing large datasets or performing real-time predictions, the combination of Streamlit and pretrained models ensures high scalability </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">and performance.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.62.1">Customization and fine-tuning</span></strong><span class="koboSpan" id="kobo.63.1">: While pretrained models provide a solid foundation, developers can fine-tune these models to adapt them to specific requirements. </span><span class="koboSpan" id="kobo.63.2">Streamlit’s flexibility allows for the easy integration of customized models and tailored user interfaces. </span><span class="koboSpan" id="kobo.63.3">This combination empowers developers to create unique and highly </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">specialized applications.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.65.1">The potential </span><a id="_idIndexMarker353"/><span class="koboSpan" id="kobo.66.1">applications of pretrained ML models within Streamlit-based web applications are vast and diverse. </span><span class="koboSpan" id="kobo.66.2">Here are </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">some examples:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.68.1">Healthcare</span></strong><span class="koboSpan" id="kobo.69.1">: Streamlit applications can utilize pretrained models for medical image analysis, disease diagnosis, and patient risk prediction, providing valuable tools for </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">healthcare professionals</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.71.1">E-commerce</span></strong><span class="koboSpan" id="kobo.72.1">: Recommender systems powered by pretrained models can enhance product discovery, boosting sales and </span><span class="No-Break"><span class="koboSpan" id="kobo.73.1">user satisfaction</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.74.1">Natural language processing</span></strong><span class="koboSpan" id="kobo.75.1">: Sentiment analysis, chatbots, and language translation can </span><a id="_idIndexMarker354"/><span class="koboSpan" id="kobo.76.1">improve user interactions in various applications, from customer support to social </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">media platforms</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.78.1">Finance</span></strong><span class="koboSpan" id="kobo.79.1">: Fraud detection, credit scoring, and stock market prediction can benefit from the predictive power of pretrained models, helping businesses make </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">informed decisions</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.81.1">To summarize, the fusion of pretrained ML models and Streamlit-based web applications represents a promising frontier in the world of AI-driven development. </span><span class="koboSpan" id="kobo.81.2">This synergy allows developers to create intelligent and interactive web applications quickly and efficiently. </span><span class="koboSpan" id="kobo.81.3">As technology advances, this combination’s potential applications are limited only by our imagination. </span><span class="koboSpan" id="kobo.81.4">By harnessing the power of pretrained models within Streamlit, we can deliver cutting-edge solutions that transform the way we interact with web applications, making them smarter, more engaging, and more useful to users across </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">various domains.</span></span></p>
<h1 id="_idParaDest-113"><a id="_idTextAnchor113"/><span class="koboSpan" id="kobo.83.1">Creating customized web apps to improve user experience</span></h1>
<p><span class="koboSpan" id="kobo.84.1">Now, it’s </span><a id="_idIndexMarker355"/><span class="koboSpan" id="kobo.85.1">time to complete our </span><em class="italic"><span class="koboSpan" id="kobo.86.1">Covid-19 Detection Tool</span></em><span class="koboSpan" id="kobo.87.1"> web application. </span><span class="koboSpan" id="kobo.87.2">So far, we have implemented several features, such as </span><strong class="bold"><span class="koboSpan" id="kobo.88.1">Image Enhancement</span></strong><span class="koboSpan" id="kobo.89.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.90.1">Disclaimer and Info</span></strong><span class="koboSpan" id="kobo.91.1">, but we are still missing the </span><strong class="bold"><span class="koboSpan" id="kobo.92.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.93.1"> section. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.94.1">Figure 10</span></em></span><em class="italic"><span class="koboSpan" id="kobo.95.1">.1</span></em><span class="koboSpan" id="kobo.96.1"> shows what we have completed </span><span class="No-Break"><span class="koboSpan" id="kobo.97.1">so far:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer213">
<span class="koboSpan" id="kobo.98.1"><img alt="Figure 10.1: The Covid-19 Detection Tool web app we’ve developed so far" src="image/B21147_10_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.99.1">Figure 10.1: The Covid-19 Detection Tool web app we’ve developed so far</span></p>
<p><span class="koboSpan" id="kobo.100.1">As I mentioned in </span><a href="B21147_09.xhtml#_idTextAnchor099"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.101.1">Chapter 9</span></em></span></a><span class="koboSpan" id="kobo.102.1">, the task of </span><strong class="bold"><span class="koboSpan" id="kobo.103.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.104.1"> is to understand from a picture, specifically </span><a id="_idIndexMarker356"/><span class="koboSpan" id="kobo.105.1">from an X-ray of the chest, whether or not a patient </span><span class="No-Break"><span class="koboSpan" id="kobo.106.1">has Covid-19.</span></span></p>
<p><span class="koboSpan" id="kobo.107.1">This kind </span><a id="_idIndexMarker357"/><span class="koboSpan" id="kobo.108.1">of prediction can be performed using a pretrained AI model, which in our case is a </span><strong class="bold"><span class="koboSpan" id="kobo.109.1">convolutional neural network</span></strong><span class="koboSpan" id="kobo.110.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.111.1">CNN</span></strong><span class="koboSpan" id="kobo.112.1">). </span><span class="koboSpan" id="kobo.112.2">A CNN is a neural network with a peculiar structure or shape that performs very well regarding </span><a id="_idIndexMarker358"/><span class="koboSpan" id="kobo.113.1">tasks related to computer vision. </span><strong class="bold"><span class="koboSpan" id="kobo.114.1">Computer vision</span></strong><span class="koboSpan" id="kobo.115.1">, in a few words, means to make computers understand what’s going on with a picture, its content, the objects represented inside it, and </span><span class="No-Break"><span class="koboSpan" id="kobo.116.1">so on.</span></span></p>
<p><span class="koboSpan" id="kobo.117.1">So, let’s see how it is possible to use a pretrained AI model inside Streamlit to perform, in this case, a computer vision task, but more generally, </span><span class="No-Break"><span class="koboSpan" id="kobo.118.1">a prediction.</span></span></p>
<p><span class="koboSpan" id="kobo.119.1">We need to start from the point where we stopped in </span><a href="B21147_09.xhtml#_idTextAnchor099"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.120.1">Chapter 9</span></em></span></a><span class="koboSpan" id="kobo.121.1">: the </span><strong class="source-inline"><span class="koboSpan" id="kobo.122.1">if</span></strong><span class="koboSpan" id="kobo.123.1"> clause related to the </span><strong class="bold"><span class="koboSpan" id="kobo.124.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.125.1"> voice of the menu, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.126.1">following figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer214">
<span class="koboSpan" id="kobo.127.1"><img alt="Figure 10.2: The “Diagnosis” voice of the menu" src="image/B21147_10_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.128.1">Figure 10.2: The “Diagnosis” voice of the menu</span></p>
<p><span class="koboSpan" id="kobo.129.1">The first </span><a id="_idIndexMarker359"/><span class="koboSpan" id="kobo.130.1">step is to add a button in the sidebar. </span><span class="koboSpan" id="kobo.130.2">In this way, when the user clicks on this button (its label will be </span><strong class="bold"><span class="koboSpan" id="kobo.131.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.132.1">), the tool will perform a binary classification while leveraging the pretrained model to predict whether or not the X-ray image represents a case </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">of Covid-19.</span></span></p>
<p><span class="koboSpan" id="kobo.134.1">Adding the button, as we know, is very easy – it’s just a matter of typing the following immediately </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">after </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.136.1">choice=='Diagnosis'</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.138.1">
if st.sidebar.button('Diagnosis'):</span></pre> <p><span class="koboSpan" id="kobo.139.1">The CNN we are going to use was trained with black and white images. </span><span class="koboSpan" id="kobo.139.2">So, first of all, when the user clicks on the </span><strong class="bold"><span class="koboSpan" id="kobo.140.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.141.1"> button, the X-ray image must be converted into a black and white image. </span><span class="koboSpan" id="kobo.141.2">However, the image – the original X-ray image before the black and white transformation – must be converted into an array (because this is the format we need to manipulate images). </span><span class="koboSpan" id="kobo.141.3">We are lucky since this operation is very simple when using </span><strong class="source-inline"><span class="koboSpan" id="kobo.142.1">numpy</span></strong><span class="koboSpan" id="kobo.143.1">, a library that we’ve already imported. </span><span class="koboSpan" id="kobo.143.2">The three lines of code we need are </span><span class="No-Break"><span class="koboSpan" id="kobo.144.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.145.1">
new_img = np.array(our_image.convert('RGB'))
new_img = cv2.cvtColor(new_img, 1) #0 is original, 1 is grayscale
Gray = cv2.cvtColor(new_img, cv2.COLOR_BGR2GRAY)</span></pre> <p><span class="koboSpan" id="kobo.146.1">The code in the first line changes the image into an array, the second line converts the image into a grayscale domain, and the final one converts it into a pure black and white image. </span><span class="koboSpan" id="kobo.146.2">Please note that we are leveraging </span><strong class="source-inline"><span class="koboSpan" id="kobo.147.1">cv2</span></strong><span class="koboSpan" id="kobo.148.1">, the Python library for computer vision that was imported at the beginning of </span><span class="No-Break"><span class="koboSpan" id="kobo.149.1">the file.</span></span></p>
<p><span class="koboSpan" id="kobo.150.1">This black and white image is saved in a variable </span><span class="No-Break"><span class="koboSpan" id="kobo.151.1">named </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.152.1">gray</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.154.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.155.1">Studying the several Python packages we are importing and using is outside the scope of this book; however, having a </span><a id="_idIndexMarker360"/><span class="koboSpan" id="kobo.156.1">look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.157.1">cv2</span></strong><span class="koboSpan" id="kobo.158.1"> (OpenCV) official website </span><a href="https://opencv.org/"><span class="koboSpan" id="kobo.159.1">https://opencv.org/</span></a><span class="koboSpan" id="kobo.160.1">) can be a very </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">interesting activity.</span></span></p>
<p><span class="koboSpan" id="kobo.162.1">After </span><a id="_idIndexMarker361"/><span class="koboSpan" id="kobo.163.1">converting the uploaded image, we are ready to write some text on the screen (</span><strong class="source-inline"><span class="koboSpan" id="kobo.164.1">"Chest X-Ray"</span></strong><span class="koboSpan" id="kobo.165.1">) to give our operation some context and print the black and </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">white image:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.167.1">
st.text("Chest X-Ray")
st.image(gray, width=400, use_column_width= True)</span></pre> <p><span class="koboSpan" id="kobo.168.1">Here’s the code we’ve added </span><span class="No-Break"><span class="koboSpan" id="kobo.169.1">so far:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer215">
<span class="koboSpan" id="kobo.170.1"><img alt="Figure 10.3: The code we’ve added to the Diagnosis menu" src="image/B21147_10_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.171.1">Figure 10.3: The code we’ve added to the Diagnosis menu</span></p>
<p><span class="koboSpan" id="kobo.172.1">From the browser’s point of view, you should get something </span><span class="No-Break"><span class="koboSpan" id="kobo.173.1">like this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer216">
<span class="koboSpan" id="kobo.174.1"><img alt="Figure 10.4: The Diagnosis button and the black and white image" src="image/B21147_10_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.175.1">Figure 10.4: The Diagnosis button and the black and white image</span></p>
<p><span class="koboSpan" id="kobo.176.1">Since the CNN was trained with black and white images in a specific format in terms of size and values, before performing the prediction, we must pre-process the image we are interested in to get the same format that the neural network </span><span class="No-Break"><span class="koboSpan" id="kobo.177.1">is expecting.</span></span></p>
<p><span class="koboSpan" id="kobo.178.1">The neural </span><a id="_idIndexMarker362"/><span class="koboSpan" id="kobo.179.1">network was trained with images that had a size of 200 pixels by 200 pixels and their values went from 0 up to 1, where 0 was black and 1 </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">was white.</span></span></p>
<p><span class="koboSpan" id="kobo.181.1">The code we need to write to make sure the image we uploaded will be in the format needed by the neural network is </span><span class="No-Break"><span class="koboSpan" id="kobo.182.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.183.1">
IMG_SIZE = (200, 200)
img = cv2.equalizeHist(gray)
img = cv2.resize(img, IMG_SIZE)
img = img/255 #normalization</span></pre> <p><span class="koboSpan" id="kobo.184.1">The first line is just an image size definition that is saved in a constant. </span><span class="koboSpan" id="kobo.184.2">The second line performs image equalization, an operation that potentially increases the clarity of our image. </span><span class="koboSpan" id="kobo.184.3">The third line resizes the image according to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.185.1">IMG_SIZE</span></strong><span class="koboSpan" id="kobo.186.1"> dimension saved in the constant, and the final instruction normalizes the image (usually, the values of gray tones go from 0 (black) to 255 (white); dividing everything by 255, we have values from 0 to 1, which are black and </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">white, respectively).</span></span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.188.1">Figure 10</span></em></span><em class="italic"><span class="koboSpan" id="kobo.189.1">.5</span></em><span class="koboSpan" id="kobo.190.1"> shows the lines of code we </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">just explained:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer217">
<span class="koboSpan" id="kobo.192.1"><img alt="Figure 10.5: Pre-processing the X-ray image" src="image/B21147_10_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.193.1">Figure 10.5: Pre-processing the X-ray image</span></p>
<p><span class="koboSpan" id="kobo.194.1">The library we are using to manage neural networks is named </span><strong class="source-inline"><span class="koboSpan" id="kobo.195.1">tensorflow</span></strong><span class="koboSpan" id="kobo.196.1"> and it requires </span><a id="_idIndexMarker363"/><span class="koboSpan" id="kobo.197.1">the images in a precise format (</span><strong class="source-inline"><span class="koboSpan" id="kobo.198.1">n,m,p,q</span></strong><span class="koboSpan" id="kobo.199.1">), where </span><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">n</span></strong><span class="koboSpan" id="kobo.201.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.202.1">m</span></strong><span class="koboSpan" id="kobo.203.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">p</span></strong><span class="koboSpan" id="kobo.205.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.206.1">q</span></strong><span class="koboSpan" id="kobo.207.1"> are integers. </span><span class="koboSpan" id="kobo.207.2">Unfortunately, the shape of our image is only </span><strong class="source-inline"><span class="koboSpan" id="kobo.208.1">(200,200)</span></strong><span class="koboSpan" id="kobo.209.1">. </span><span class="koboSpan" id="kobo.209.2">So, before we use it for prediction, we must resize it; this is the instruction we </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">should use:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.211.1">
X_Ray = img.reshape(1, 200, 200, 1)</span></pre> <p><span class="koboSpan" id="kobo.212.1">By processing the image in this way, we have a very good input for ML classifiers. </span><span class="koboSpan" id="kobo.212.2">We’ll learn how to deal with this task in the </span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">next section.</span></span></p>
<h1 id="_idParaDest-114"><a id="_idTextAnchor114"/><span class="koboSpan" id="kobo.214.1">Utilizing predictions from ML</span></h1>
<p><span class="koboSpan" id="kobo.215.1">At this point, everything is ready. </span><span class="koboSpan" id="kobo.215.2">Now, to be able to perform predictions about Covid-19 from an X-ray image, we need to load our pretrained model (available in this chapter’s GitHub repository; the link can be found in the </span><em class="italic"><span class="koboSpan" id="kobo.216.1">Technical requirements</span></em><span class="koboSpan" id="kobo.217.1"> section) and use it with </span><a id="_idIndexMarker364"/><span class="koboSpan" id="kobo.218.1">the uploaded picture (pre-processed according to the code we wrote in the </span><em class="italic"><span class="koboSpan" id="kobo.219.1">Creating customized web apps to improve user experience</span></em><span class="koboSpan" id="kobo.220.1"> section). </span><span class="koboSpan" id="kobo.220.2">As explained in the </span><em class="italic"><span class="koboSpan" id="kobo.221.1">Understanding the benefits of pretrained ML models</span></em><span class="koboSpan" id="kobo.222.1"> section, using a pretrained model is an easy and fast way to solve a problem without spending time developing an AI model by ourselves. </span><span class="koboSpan" id="kobo.222.2">In our specific case, we can predict the presence of Covid-19 from an image just by loading and using a model developed and made available </span><span class="No-Break"><span class="koboSpan" id="kobo.223.1">by others.</span></span></p>
<p><span class="koboSpan" id="kobo.224.1">Let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.225.1">start writing:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.226.1">
model = tf.keras.models.load_model("./models/Covid19_CNN_Classifier.h5")</span></pre> <p><span class="koboSpan" id="kobo.227.1">In the preceding code, </span><strong class="source-inline"><span class="koboSpan" id="kobo.228.1">tf</span></strong><span class="koboSpan" id="kobo.229.1"> is the alias of </span><strong class="source-inline"><span class="koboSpan" id="kobo.230.1">tensorflow</span></strong><span class="koboSpan" id="kobo.231.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.232.1">keras</span></strong><span class="koboSpan" id="kobo.233.1"> is a module inside it. </span><span class="koboSpan" id="kobo.233.2">So, we just pass to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.234.1">load_model</span></strong><span class="koboSpan" id="kobo.235.1"> method the path to our pretrained model (please note that the file type of </span><strong class="source-inline"><span class="koboSpan" id="kobo.236.1">tensorflow</span></strong><span class="koboSpan" id="kobo.237.1"> models is </span><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">h5</span></strong><span class="koboSpan" id="kobo.239.1">) and save it into a variable named </span><strong class="source-inline"><span class="koboSpan" id="kobo.240.1">model</span></strong><span class="koboSpan" id="kobo.241.1">. </span><span class="koboSpan" id="kobo.241.2">Please note that the pretrained CNN was put in a directory named </span><strong class="source-inline"><span class="koboSpan" id="kobo.242.1">models</span></strong><span class="koboSpan" id="kobo.243.1">, so if you changed its position, please update the path in the </span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">code accordingly.</span></span></p>
<p><span class="koboSpan" id="kobo.245.1">This is </span><a id="_idIndexMarker365"/><span class="koboSpan" id="kobo.246.1">the code we’ve implemented </span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">so far:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer218">
<span class="koboSpan" id="kobo.248.1"><img alt="Figure 10.6: Image reshaping and model loading" src="image/B21147_10_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.249.1">Figure 10.6: Image reshaping and model loading</span></p>
<p><span class="koboSpan" id="kobo.250.1">Our model variable has a method named </span><strong class="source-inline"><span class="koboSpan" id="kobo.251.1">predict</span></strong><span class="koboSpan" id="kobo.252.1"> that returns the probability of the prediction in a list containing two elements: the probability of no Covid and the probability of Covid. </span><span class="koboSpan" id="kobo.252.2">Since we are performing a binary classification (true or false, so no Covid or Covid) we want to know whether or not the picture represents a case of Covid; we can do this using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.253.1">argmax</span></strong><span class="koboSpan" id="kobo.254.1"> method of </span><strong class="source-inline"><span class="koboSpan" id="kobo.255.1">np</span></strong><span class="koboSpan" id="kobo.256.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.257.1">numpy</span></strong><span class="koboSpan" id="kobo.258.1">). </span><strong class="source-inline"><span class="koboSpan" id="kobo.259.1">argmax</span></strong><span class="koboSpan" id="kobo.260.1"> checks the values of a list and provides the index of the maximum value, which in our case is </span><strong class="source-inline"><span class="koboSpan" id="kobo.261.1">0</span></strong><span class="koboSpan" id="kobo.262.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">1</span></strong><span class="koboSpan" id="kobo.264.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.265.1">0</span></strong><span class="koboSpan" id="kobo.266.1"> in the case of no Covid and </span><strong class="source-inline"><span class="koboSpan" id="kobo.267.1">1</span></strong><span class="koboSpan" id="kobo.268.1"> in the case of Covid). </span><span class="koboSpan" id="kobo.268.2">So, if the prediction result is a list such as [</span><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">0.70</span></strong><span class="koboSpan" id="kobo.270.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.271.1">0.30</span></strong><span class="koboSpan" id="kobo.272.1">], </span><strong class="source-inline"><span class="koboSpan" id="kobo.273.1">argmax</span></strong><span class="koboSpan" id="kobo.274.1"> will return </span><strong class="source-inline"><span class="koboSpan" id="kobo.275.1">0</span></strong><span class="koboSpan" id="kobo.276.1">; the first index starts from </span><strong class="source-inline"><span class="koboSpan" id="kobo.277.1">0</span></strong><span class="koboSpan" id="kobo.278.1"> (because </span><strong class="source-inline"><span class="koboSpan" id="kobo.279.1">0.70</span></strong><span class="koboSpan" id="kobo.280.1"> is greater than </span><strong class="source-inline"><span class="koboSpan" id="kobo.281.1">0.30</span></strong><span class="koboSpan" id="kobo.282.1">), which means that the diagnosis is no Covid since the probability of no Covid is </span><strong class="source-inline"><span class="koboSpan" id="kobo.283.1">70%</span></strong><span class="koboSpan" id="kobo.284.1">, while the probability of Covid </span><span class="No-Break"><span class="koboSpan" id="kobo.285.1">is </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.286.1">30%</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.288.1">To complete the </span><strong class="bold"><span class="koboSpan" id="kobo.289.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.290.1"> voice of the menu, we can add the </span><span class="No-Break"><span class="koboSpan" id="kobo.291.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.292.1">
diagnosis_proba = model.predict(X_Ray)
diagnosis = np.argmax(diagnosis_proba, axis=1)</span></pre> <p><span class="koboSpan" id="kobo.293.1">Here is the code </span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">we implemented:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer219">
<span class="koboSpan" id="kobo.295.1"><img alt="Figure 10.7: How we get the prediction" src="image/B21147_10_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.296.1">Figure 10.7: How we get the prediction</span></p>
<p><span class="koboSpan" id="kobo.297.1">At this point, we have everything we need to display the result on </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">the screen.</span></span></p>
<p><span class="koboSpan" id="kobo.299.1">Now, as the first frontend element, we must create a progress bar in the sidebar that indicates the status of the diagnosis prediction. </span><span class="koboSpan" id="kobo.299.2">For this, we can write </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.301.1">
my_bar = st.sidebar.progress(0)</span></pre> <p><span class="koboSpan" id="kobo.302.1">A progress </span><a id="_idIndexMarker366"/><span class="koboSpan" id="kobo.303.1">bar always works with a timer, so we should </span><em class="italic"><span class="koboSpan" id="kobo.304.1">import time</span></em><span class="koboSpan" id="kobo.305.1"> at the very beginning of our Python file. </span><span class="koboSpan" id="kobo.305.2">This is the reason we did this when we started this project (see </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.306.1">Figure 8</span></em></span><em class="italic"><span class="koboSpan" id="kobo.307.1">.4</span></em><span class="koboSpan" id="kobo.308.1"> in </span><a href="B21147_08.xhtml#_idTextAnchor091"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.309.1">Chapter 8</span></em></span></a><span class="koboSpan" id="kobo.310.1">). </span><span class="koboSpan" id="kobo.310.2">Let’s continue by adding the </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.312.1">
for percent_complete in range(100):
time.sleep(0.05)
my_bar.progress(percent_complete + 1)</span></pre> <p><span class="koboSpan" id="kobo.313.1">In this way, we create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.314.1">for</span></strong><span class="koboSpan" id="kobo.315.1"> loop that sleeps for </span><strong class="source-inline"><span class="koboSpan" id="kobo.316.1">0.05</span></strong><span class="koboSpan" id="kobo.317.1"> seconds and then activates the progress bar, extending it by </span><strong class="source-inline"><span class="koboSpan" id="kobo.318.1">1</span></strong><span class="koboSpan" id="kobo.319.1"> unit (the progress bar was instantiated with a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">0</span></strong><span class="koboSpan" id="kobo.321.1">), repeating this operation </span><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">100</span></strong><span class="koboSpan" id="kobo.323.1"> times since our progress bar’s range goes from </span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">0</span></strong><span class="koboSpan" id="kobo.325.1"> up to </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.326.1">100</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.327.1"> units.</span></span></p>
<p><span class="koboSpan" id="kobo.328.1">This progress bar indicates that the prediction is ongoing until it reaches its maximum value and </span><span class="No-Break"><span class="koboSpan" id="kobo.329.1">stops extending.</span></span></p>
<p><span class="koboSpan" id="kobo.330.1">When the progress bar is completely extended, we can print the diagnosis on the screen, explaining what kind of prediction we are dealing with. </span><span class="koboSpan" id="kobo.330.2">For this, we can type </span><span class="No-Break"><span class="koboSpan" id="kobo.331.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.332.1">
if diagnosis == 0:
st.sidebar.success("DIAGNOSIS: NO COVID-19")
else:
st.sidebar.error ("DIAGNOSIS: COVID-19")</span></pre> <p><span class="koboSpan" id="kobo.333.1">This is the </span><a id="_idIndexMarker367"/><span class="koboSpan" id="kobo.334.1">code we added for the frontend part – that is, the part that is visualized in </span><span class="No-Break"><span class="koboSpan" id="kobo.335.1">the browser:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer220">
<span class="koboSpan" id="kobo.336.1"><img alt="Figure 10.8: How we get the prediction and visualize it on the screen" src="image/B21147_10_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.337.1">Figure 10.8: How we get the prediction and visualize it on the screen</span></p>
<p><span class="koboSpan" id="kobo.338.1">This is the result in the browser in the case of a no </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">Covid</span></span><span class="No-Break"><span class="koboSpan" id="kobo.340.1"> prediction:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer221">
<span class="koboSpan" id="kobo.341.1"><img alt="Figure 10.9: No Covid diagnosis" src="image/B21147_10_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.342.1">Figure 10.9: No Covid diagnosis</span></p>
<p><span class="koboSpan" id="kobo.343.1">Since the </span><a id="_idIndexMarker368"/><span class="koboSpan" id="kobo.344.1">model we are using to perform the prediction is just a </span><em class="italic"><span class="koboSpan" id="kobo.345.1">toy model</span></em><span class="koboSpan" id="kobo.346.1"> and there is no clinical value in the diagnosis that’s made using it, it’s better to add a final disclaimer to </span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">our application.</span></span></p>
<p><span class="koboSpan" id="kobo.348.1">Let’s add something </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.350.1">
st.warning("This Web App is just a DEMO about Streamlit and Artificial Intelligence and there is no clinical value in its diagnosis!")</span></pre> <p><span class="koboSpan" id="kobo.351.1">Our final code for the </span><strong class="bold"><span class="koboSpan" id="kobo.352.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.353.1"> voice of the menu is </span><span class="No-Break"><span class="koboSpan" id="kobo.354.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer222">
<span class="koboSpan" id="kobo.355.1"><img alt="Figure 10.10: Complete code for the “Diagnosis” voice of the menu" src="image/B21147_10_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.356.1">Figure 10.10: Complete code for the “Diagnosis” voice of the menu</span></p>
<p><span class="koboSpan" id="kobo.357.1">And this </span><a id="_idIndexMarker369"/><span class="koboSpan" id="kobo.358.1">is the disclaimer on </span><span class="No-Break"><span class="koboSpan" id="kobo.359.1">the browser:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer223">
<span class="koboSpan" id="kobo.360.1"><img alt="Figure 10.11: Prediction with the disclaimer" src="image/B21147_10_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.361.1">Figure 10.11: Prediction with the disclaimer</span></p>
<p><span class="koboSpan" id="kobo.362.1">Please remember that the point here is not to get a very well-performing model to predict cases of Covid-19 but to understand how to integrate AI models </span><span class="No-Break"><span class="koboSpan" id="kobo.363.1">inside Streamlit.</span></span></p>
<p><span class="koboSpan" id="kobo.364.1">Let’s dive deeper into what we achieved in </span><span class="No-Break"><span class="koboSpan" id="kobo.365.1">this chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.366.1">First of all, in addition to </span><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">tensorflow</span></strong><span class="koboSpan" id="kobo.368.1">, as in the case of our web application, AI models can be trained with other packages such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.369.1">scikit-learn</span></strong><span class="koboSpan" id="kobo.370.1">. </span><span class="koboSpan" id="kobo.370.2">Due to this, it’s very important that before loading the model into your Streamlit web application, you carefully read the documentation of the specific package that was used to train the model. </span><span class="koboSpan" id="kobo.370.3">Different packages usually adopt different syntaxes to load their models. </span><span class="koboSpan" id="kobo.370.4">This means that according to the model you decide to adopt, you must use a different syntax in </span><span class="No-Break"><span class="koboSpan" id="kobo.371.1">your code.</span></span></p>
<p><span class="koboSpan" id="kobo.372.1">The second </span><a id="_idIndexMarker370"/><span class="koboSpan" id="kobo.373.1">and most important point is that the web application we just implemented is quite powerful since it performs several complex tasks, such as image enhancements, diagnosis, and more. </span><span class="koboSpan" id="kobo.373.2">Even though it’s complex, when we count the lines of code we wrote down, we will see that from the very beginning to the end, we wrote just about 130 lines of Python, comments included. </span><span class="koboSpan" id="kobo.373.3">This is the real power of Python and Streamlit together. </span><span class="koboSpan" id="kobo.373.4">In a few lines of code, we implemented a web application that performs several complex tasks, even leveraging AI. </span><span class="koboSpan" id="kobo.373.5">On top of that, we have all the typical widgets that are typically included in very professional applications, such as different kinds of text, buttons, progress bars, </span><span class="No-Break"><span class="koboSpan" id="kobo.374.1">and more.</span></span></p>
<p><span class="koboSpan" id="kobo.375.1">As usual, and considering that this time the code is even more complex, here are some screenshots of the complete transcript of the web application we </span><span class="No-Break"><span class="koboSpan" id="kobo.376.1">just completed:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer224">
<span class="koboSpan" id="kobo.377.1"><img alt="Figure 10.12: Part 1 of the Covid-19 Detection Tool web app" src="image/B21147_10_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.378.1">Figure 10.12: Part 1 of the Covid-19 Detection Tool web app</span></p>
<p><span class="koboSpan" id="kobo.379.1">First, we imported the libraries and defined the main function. </span><span class="koboSpan" id="kobo.379.2">The main function starts by creating </span><a id="_idIndexMarker371"/><span class="koboSpan" id="kobo.380.1">a beautiful title and then continues with the presence of a </span><strong class="source-inline"><span class="koboSpan" id="kobo.381.1">file_uploader</span></strong><span class="koboSpan" id="kobo.382.1"> widget. </span><span class="koboSpan" id="kobo.382.2">After that, there is a menu containing three voices – </span><strong class="bold"><span class="koboSpan" id="kobo.383.1">Image Enhancement</span></strong><span class="koboSpan" id="kobo.384.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.385.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.386.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.387.1">Disclaimer </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.388.1">and Info</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.389.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer225">
<span class="koboSpan" id="kobo.390.1"><img alt="Figure 10.13: Part 2 of the Covid-19 Detection Tool web app" src="image/B21147_10_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.391.1">Figure 10.13: Part 2 of the Covid-19 Detection Tool web app</span></p>
<p><span class="koboSpan" id="kobo.392.1">Then, we mainly dealt with the </span><strong class="bold"><span class="koboSpan" id="kobo.393.1">Image Enhancement</span></strong><span class="koboSpan" id="kobo.394.1"> feature and completed the </span><strong class="bold"><span class="koboSpan" id="kobo.395.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.396.1"> part. </span><span class="koboSpan" id="kobo.396.2">In this part, we pre-processed the image, prepared it for the ML model, loaded the classification model and a pretrained CNN, executed the prediction, and introduced some nice widgets, such as the </span><span class="No-Break"><span class="koboSpan" id="kobo.397.1">progress bar:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer226">
<span class="koboSpan" id="kobo.398.1"><img alt="Figure 10.14: Part 3 of the Covid-19 Detection Tool web app" src="image/B21147_10_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.399.1">Figure 10.14: Part 3 of the Covid-19 Detection Tool web app</span></p>
<p><span class="koboSpan" id="kobo.400.1">Finally, we just </span><a id="_idIndexMarker372"/><span class="koboSpan" id="kobo.401.1">suggested simple text for the </span><strong class="bold"><span class="koboSpan" id="kobo.402.1">Disclaimer and Info</span></strong><span class="koboSpan" id="kobo.403.1"> section and created the </span><strong class="bold"><span class="koboSpan" id="kobo.404.1">About the Author</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.405.1">information page.</span></span></p>
<h1 id="_idParaDest-115"><a id="_idTextAnchor115"/><span class="koboSpan" id="kobo.406.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.407.1">This chapter was very important since we learned how to integrate AI into our </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">web applications.</span></span></p>
<p><span class="koboSpan" id="kobo.409.1">AI is a highly disruptive technology that can completely change the game when managed and leveraged properly in our applications. </span><span class="koboSpan" id="kobo.409.2">In this chapter, we learned that it is possible to include AI models developed and trained separately in Streamlit. </span><span class="koboSpan" id="kobo.409.3">Several packages and tools can create AI models, and almost all these models can be included in Streamlit; it’s only a matter of checking the proper documentation and following </span><span class="No-Break"><span class="koboSpan" id="kobo.410.1">the rules.</span></span></p>
<p><span class="koboSpan" id="kobo.411.1">Loading AI models into our web applications is only one part of the process since each model needs to be fed information in a specific format. </span><span class="koboSpan" id="kobo.411.2">For this reason, all the data we provide as input to the model that we decide to use must be pre-processed so that it’s compliant with that specific format. </span><span class="koboSpan" id="kobo.411.3">This is the reason why we spent a good amount of our time manipulating and transforming the image of the X-ray we uploaded in a format that’s compatible with the CNN model we used. </span><span class="koboSpan" id="kobo.411.4">The uploaded image was converted into black and white, then resized </span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">and reshaped.</span></span></p>
<p><span class="koboSpan" id="kobo.413.1">Having the input in the proper format is extremely important; otherwise, the model will not understand what to do and will generate a runtime error. </span><span class="koboSpan" id="kobo.413.2">After pre-processing the image, we focused on the prediction; we learned how to perform predictions and interpret them. </span><span class="koboSpan" id="kobo.413.3">Finally, we covered the frontend part and took care of visualizing the predictions in the web browser using beautiful effects such as the progress bar. </span><span class="koboSpan" id="kobo.413.4">We observed that when dealing with sensitive topics such as health, it’s good practice to include a disclaimer to avoid </span><span class="No-Break"><span class="koboSpan" id="kobo.414.1">potential issues.</span></span></p>
<p><span class="koboSpan" id="kobo.415.1">Having a working application is a very good starting point but it is not the real conclusion of our job. </span><span class="koboSpan" id="kobo.415.2">As we already did with the natural language processing web application, we still have to deploy our new tool to the cloud because only with deployment is it possible to build a well-done and well-performing application available to a very wide customer base. </span><span class="koboSpan" id="kobo.415.3">This is exactly what we are going to do in the </span><span class="No-Break"><span class="koboSpan" id="kobo.416.1">next chapter.</span></span></p>
</div>
</body></html>