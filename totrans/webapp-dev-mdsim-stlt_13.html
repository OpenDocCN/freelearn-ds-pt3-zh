<html><head></head><body>
<div id="_idContainer290">
<h1 class="chapter-number" id="_idParaDest-138"><a id="_idTextAnchor138"/><span class="koboSpan" id="kobo.1.1">13</span></h1>
<h1 id="_idParaDest-139"><a id="_idTextAnchor139"/><span class="koboSpan" id="kobo.2.1">Creating a Secure Login and Signup Process for Web Applications</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Let’s continue our exploration of advanced techniques to make our web applications look professional and </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">work well.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">In this chapter, we are going to learn how to implement a login and signup page made with </span><strong class="bold"><span class="koboSpan" id="kobo.6.1">Secure Hash Algorithm 256</span></strong><span class="koboSpan" id="kobo.7.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.8.1">SHA-256</span></strong><span class="koboSpan" id="kobo.9.1">) encryption and connected to a database in a </span><a id="_idIndexMarker415"/><span class="koboSpan" id="kobo.10.1">secure and user-friendly way. </span><span class="koboSpan" id="kobo.10.2">By adopting this approach, we will be able to authenticate our web app users and store their credentials permanently. </span><span class="koboSpan" id="kobo.10.3">The login and signup page typically consists of a form where users can enter their username and password to access the web application. </span><span class="koboSpan" id="kobo.10.4">When a user logs in, their credentials are hashed using SHA-256 and compared to the </span><a id="_idIndexMarker416"/><span class="koboSpan" id="kobo.11.1">stored hash in the database (in this context, we are using </span><strong class="bold"><span class="koboSpan" id="kobo.12.1">SQLite3</span></strong><span class="koboSpan" id="kobo.13.1">). </span><span class="koboSpan" id="kobo.13.2">If the hashes match, the user is authenticated and granted access to the application. </span><span class="koboSpan" id="kobo.13.3">The signup page allows new users to create an account by entering their desired username </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">and password.</span></span></p>
<p><span class="koboSpan" id="kobo.15.1">In this chapter, we’re going to cover the following </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">main topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.17.1">Understanding the logic behind the login and </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">signup page</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">What is SHA-256 and why should we </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">use it?</span></span></li>
<li><span class="koboSpan" id="kobo.21.1">Connecting to a relational database and interacting </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">with it</span></span></li>
<li><span class="koboSpan" id="kobo.23.1">Retrieving or saving credentials from and to </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">the database</span></span></li>
</ul>
<h1 id="_idParaDest-140"><a id="_idTextAnchor140"/><span class="koboSpan" id="kobo.25.1">Technical requirements</span></h1>
<ul>
<li><span class="koboSpan" id="kobo.26.1">In this chapter, we’ll use the following libraries, packages, </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">and tools:</span></span><ul><li><span class="No-Break"><span class="koboSpan" id="kobo.28.1">Sublime Text</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.29.1">Python 3</span></span></li><li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.30.1">pipenv</span></strong></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.31.1">Streamlit</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.32.1">Pillow</span></span></li><li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.33.1">Sqlite3</span></strong></span></li><li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.34.1">hashlib</span></strong></span></li></ul></li>
<li><span class="koboSpan" id="kobo.35.1">The code for this chapter can be found in this book’s GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.36.1">repository: </span></span><a href="https://github.com/PacktPublishing/Web-App-Development-Made-Simple-with-Streamlit/tree/main/Chapter13"><span class="No-Break"><span class="koboSpan" id="kobo.37.1">https://github.com/PacktPublishing/Web-App-Development-Made-Simple-with-Streamlit/tree/main/Chapter13</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.38.1">.</span></span></li>
</ul>
<h1 id="_idParaDest-141"><a id="_idTextAnchor141"/><span class="koboSpan" id="kobo.39.1">Understanding the logic behind the login and signup page</span></h1>
<p><span class="koboSpan" id="kobo.40.1">When a user creates an account on a website or application, they are typically asked to provide a username and password. </span><span class="koboSpan" id="kobo.40.2">The username is a unique identifier for the user, while the password </span><a id="_idIndexMarker417"/><span class="koboSpan" id="kobo.41.1">is a secret that only the user </span><span class="No-Break"><span class="koboSpan" id="kobo.42.1">should know.</span></span></p>
<p><span class="koboSpan" id="kobo.43.1">The website or application then stores the username and password in a database. </span><span class="koboSpan" id="kobo.43.2">However, the password is not stored in plain text. </span><span class="koboSpan" id="kobo.43.3">Instead, it’s converted into a </span><strong class="bold"><span class="koboSpan" id="kobo.44.1">hash</span></strong><span class="koboSpan" id="kobo.45.1">. </span><span class="koboSpan" id="kobo.45.2">A hash is a one-way function, meaning that </span><a id="_idIndexMarker418"/><span class="koboSpan" id="kobo.46.1">it is easy to calculate the hash of a password, but it is very difficult to reverse the process and calculate the password from </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">the hash.</span></span></p>
<p><span class="koboSpan" id="kobo.48.1">This is done for security reasons. </span><span class="koboSpan" id="kobo.48.2">If a hacker were to gain access to the database, they would not be able to read the passwords in plain text. </span><span class="koboSpan" id="kobo.48.3">They would only be able to read the hashes. </span><span class="koboSpan" id="kobo.48.4">Even if the hacker knew the hashing algorithm used, it would still be very difficult for them to crack </span><span class="No-Break"><span class="koboSpan" id="kobo.49.1">the password.</span></span></p>
<p><span class="koboSpan" id="kobo.50.1">When a user logs in, they are asked to enter their username and password. </span><span class="koboSpan" id="kobo.50.2">The website or application then calculates the hash of the password that the user entered and compares it to the hash that is stored in the database. </span><span class="koboSpan" id="kobo.50.3">If the two hashes match, then the user is successfully </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">logged in.</span></span></p>
<p><span class="koboSpan" id="kobo.52.1">Here is a step-by-step explanation of the logic behind the login and </span><span class="No-Break"><span class="koboSpan" id="kobo.53.1">signup page:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.54.1">The user enters their username and password on the </span><span class="No-Break"><span class="koboSpan" id="kobo.55.1">signup page.</span></span></li>
<li><span class="koboSpan" id="kobo.56.1">The website or application converts the password into </span><span class="No-Break"><span class="koboSpan" id="kobo.57.1">a hash.</span></span></li>
<li><span class="koboSpan" id="kobo.58.1">The website or application saves the username and password hash in </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">the database.</span></span></li>
<li><span class="koboSpan" id="kobo.60.1">The user is redirected to the </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">login page.</span></span></li>
<li><span class="koboSpan" id="kobo.62.1">The user enters their username and password on the </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">login page.</span></span></li>
<li><span class="koboSpan" id="kobo.64.1">The website or application calculates the hash of the password that the user entered and compares it to the hash that is stored in </span><span class="No-Break"><span class="koboSpan" id="kobo.65.1">the database.</span></span></li>
<li><span class="koboSpan" id="kobo.66.1">If the two hashes match, then the user is successfully </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">logged in.</span></span></li>
<li><span class="koboSpan" id="kobo.68.1">If the two hashes do not match, then the user is not successfully </span><span class="No-Break"><span class="koboSpan" id="kobo.69.1">logged in.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.70.1">There are a </span><a id="_idIndexMarker419"/><span class="koboSpan" id="kobo.71.1">few reasons it is important to store the username and password hashes permanently in </span><span class="No-Break"><span class="koboSpan" id="kobo.72.1">a database:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.73.1">To allow users to log into </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">their accounts</span></span></li>
<li><span class="koboSpan" id="kobo.75.1">To allow users to recover their passwords if they </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">forget them</span></span></li>
<li><span class="koboSpan" id="kobo.77.1">To prevent unauthorized access to </span><span class="No-Break"><span class="koboSpan" id="kobo.78.1">user accounts</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.79.1">If the username and password hashes were not stored permanently in a database, then users would not be able to log into their accounts or recover their passwords if they forgot them. </span><span class="koboSpan" id="kobo.79.2">Additionally, unauthorized users would be able to gain access to user accounts simply by guessing the correct username </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">and password.</span></span></p>
<p><span class="koboSpan" id="kobo.81.1">It is important to note that even though passwords are stored as hashes in the database, it is still possible for hackers to crack them. </span><span class="koboSpan" id="kobo.81.2">However, it is much more difficult to crack a hash than it is to crack a plain </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">text password.</span></span></p>
<p><span class="koboSpan" id="kobo.83.1">Here are some tips for creating </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">strong passwords:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.85.1">Use a mix of uppercase and lowercase letters, numbers, </span><span class="No-Break"><span class="koboSpan" id="kobo.86.1">and symbols</span></span></li>
<li><span class="koboSpan" id="kobo.87.1">Make your password at least 12 </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">characters long</span></span></li>
<li><span class="koboSpan" id="kobo.89.1">Avoid using common words or phrases in your password such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.90.1">qwerty</span></strong><span class="koboSpan" id="kobo.91.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.92.1">12345678</span></strong><span class="koboSpan" id="kobo.93.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.94.1">user</span></strong><span class="koboSpan" id="kobo.95.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.96.1">admin</span></strong><span class="koboSpan" id="kobo.97.1">, and </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">so on</span></span></li>
<li><span class="koboSpan" id="kobo.99.1">Do not use your name, birthday, or other personal information in </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">your password</span></span></li>
<li><span class="koboSpan" id="kobo.101.1">Use a different password for each website or application that </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">you use</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.103.1">At this point, the importance of a signup/login page should be clear, as well as the importance of </span><a id="_idIndexMarker420"/><span class="koboSpan" id="kobo.104.1">avoiding weak passwords. </span><span class="koboSpan" id="kobo.104.2">It’s time to understand what a secure hash </span><span class="No-Break"><span class="koboSpan" id="kobo.105.1">algorithm is.</span></span></p>
<h1 id="_idParaDest-142"><a id="_idTextAnchor142"/><span class="koboSpan" id="kobo.106.1">What is SHA-256 and why should we use it?</span></h1>
<p><span class="koboSpan" id="kobo.107.1">SHA-256 is a </span><a id="_idIndexMarker421"/><span class="koboSpan" id="kobo.108.1">cryptographic hash function that produces a 256-bit hash value from a data input. </span><span class="koboSpan" id="kobo.108.2">It is part of the </span><em class="italic"><span class="koboSpan" id="kobo.109.1">SHA-2 family of hash functions</span></em><span class="koboSpan" id="kobo.110.1"> (for more details, please </span><a id="_idIndexMarker422"/><span class="koboSpan" id="kobo.111.1">check out </span><a href="https://justcryptography.com/sha-2/"><span class="koboSpan" id="kobo.112.1">https://justcryptography.com/sha-2/</span></a><span class="koboSpan" id="kobo.113.1">) that were designed by the </span><strong class="bold"><span class="koboSpan" id="kobo.114.1">National Security Agency</span></strong><span class="koboSpan" id="kobo.115.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.116.1">NSA</span></strong><span class="koboSpan" id="kobo.117.1">) and </span><a id="_idIndexMarker423"/><span class="koboSpan" id="kobo.118.1">published by the </span><strong class="bold"><span class="koboSpan" id="kobo.119.1">National Institute of Standards and Technology</span></strong><span class="koboSpan" id="kobo.120.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.121.1">NIST</span></strong><span class="koboSpan" id="kobo.122.1">) </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">in 2001.</span></span></p>
<p><span class="koboSpan" id="kobo.124.1">SHA-256 is a widely </span><a id="_idIndexMarker424"/><span class="koboSpan" id="kobo.125.1">used hash function for a variety of applications, including </span><span class="No-Break"><span class="koboSpan" id="kobo.126.1">the following:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.127.1">Password storage</span></strong><span class="koboSpan" id="kobo.128.1">: SHA-256 is used to store passwords securely. </span><span class="koboSpan" id="kobo.128.2">When a user creates an account on a website or application, their password is converted into an SHA-256 hash and stored in the database. </span><span class="koboSpan" id="kobo.128.3">When the user logs in, their password is converted into an SHA-256 hash and compared to the hash stored in the database. </span><span class="koboSpan" id="kobo.128.4">If the two hashes match, then the user is successfully </span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">logged in.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.130.1">Digital signatures</span></strong><span class="koboSpan" id="kobo.131.1">: SHA-256 can be used to create digital signatures. </span><span class="koboSpan" id="kobo.131.2">A </span><strong class="bold"><span class="koboSpan" id="kobo.132.1">digital signature</span></strong><span class="koboSpan" id="kobo.133.1"> is a </span><a id="_idIndexMarker425"/><span class="koboSpan" id="kobo.134.1">cryptographic technique that allows the sender of a message to verify their identity and the integrity of the message. </span><span class="koboSpan" id="kobo.134.2">To create a digital signature, the sender calculates the SHA-256 hash of the message and then encrypts the hash with their private key. </span><span class="koboSpan" id="kobo.134.3">The sender then sends the message and the encrypted hash to the recipient. </span><span class="koboSpan" id="kobo.134.4">The recipient calculates the SHA-256 hash of the message and then decrypts the encrypted hash with the sender’s public key. </span><span class="koboSpan" id="kobo.134.5">If the two hashes match, then the recipient can be sure that the message is authentic and has not been </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">tampered with.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.136.1">File integrity verification</span></strong><span class="koboSpan" id="kobo.137.1">: SHA-256 can be used to verify the integrity of files. </span><span class="koboSpan" id="kobo.137.2">To do this, the SHA-256 hash of the file is calculated and then stored. </span><span class="koboSpan" id="kobo.137.3">When the file is needed, the SHA-256 </span><a id="_idIndexMarker426"/><span class="koboSpan" id="kobo.138.1">hash of the file is calculated again and compared to the stored hash. </span><span class="koboSpan" id="kobo.138.2">If the two hashes match, then the file is known to </span><span class="No-Break"><span class="koboSpan" id="kobo.139.1">be intact.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.140.1">SHA-256 is considered to be a very secure hash function. </span><span class="koboSpan" id="kobo.140.2">It is resistant to collision attacks, meaning that </span><a id="_idIndexMarker427"/><span class="koboSpan" id="kobo.141.1">it is very difficult to find two different inputs that produce the same hash value. </span><span class="koboSpan" id="kobo.141.2">It is also resistant to preimage attacks, meaning that it is very difficult to find the input that produces a given </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">hash value.</span></span></p>
<p><span class="koboSpan" id="kobo.143.1">Here are some reasons why you should </span><span class="No-Break"><span class="koboSpan" id="kobo.144.1">use SHA-256:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.145.1">It is a very secure </span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">hash function</span></span></li>
<li><span class="koboSpan" id="kobo.147.1">It is widely used </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">and supported</span></span></li>
<li><span class="koboSpan" id="kobo.149.1">It is relatively easy </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">to implement</span></span></li>
<li><span class="koboSpan" id="kobo.151.1">It is free </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">to use</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.153.1">If you need a secure way to store passwords, create digital signatures, or verify the integrity of files, then SHA-256 is a </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">good choice.</span></span></p>
<p><span class="koboSpan" id="kobo.155.1">Now that we have all the information we need, let’s start coding. </span><span class="koboSpan" id="kobo.155.2">As usual, we have to follow some typical steps to set up a new </span><span class="No-Break"><span class="koboSpan" id="kobo.156.1">virtual environment:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.157.1">Create a new directory </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">named </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.159.1">Login_Skeleton</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.161.1">Enter this directory and write </span><strong class="source-inline"><span class="koboSpan" id="kobo.162.1">pipenv shell</span></strong><span class="koboSpan" id="kobo.163.1"> to create a new </span><span class="No-Break"><span class="koboSpan" id="kobo.164.1">virtual environment.</span></span></li>
<li><span class="koboSpan" id="kobo.165.1">Install the </span><strong class="source-inline"><span class="koboSpan" id="kobo.166.1">streamlit</span></strong><span class="koboSpan" id="kobo.167.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">pillow</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.169.1"> packages.</span></span></li>
<li><span class="koboSpan" id="kobo.170.1">Create a new empty Python file </span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">named </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.172.1">app.py</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.173.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.174.1">Launch your IDE (</span><span class="No-Break"><span class="koboSpan" id="kobo.175.1">Sublime Text).</span></span></li>
</ol>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.176.1">Figure 13</span></em></span><em class="italic"><span class="koboSpan" id="kobo.177.1">.1</span></em><span class="koboSpan" id="kobo.178.1"> shows all these steps, from creating the new directory to installing the </span><span class="No-Break"><span class="koboSpan" id="kobo.179.1">required libraries:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer264">
<span class="koboSpan" id="kobo.180.1"><img alt="Figure 13.1: Virtual environment and app.py file preparation" src="image/B21147_12_011.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.181.1">Figure 13.1: Virtual environment and app.py file preparation</span></p>
<p><span class="koboSpan" id="kobo.182.1">Now, we are </span><a id="_idIndexMarker428"/><span class="koboSpan" id="kobo.183.1">ready to edit the Python code in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.184.1">app.py</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.185.1"> file.</span></span></p>
<p><span class="koboSpan" id="kobo.186.1">Inside Sublime Text, we can start writing the code for our new login/signup web app, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.187.1">Figure 13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.188.1">.2</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.189.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer265">
<span class="koboSpan" id="kobo.190.1"><img alt="Figure 13.2: Starting code" src="image/B21147_12_021.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.191.1">Figure 13.2: Starting code</span></p>
<p><span class="koboSpan" id="kobo.192.1">The preceding </span><a id="_idIndexMarker429"/><span class="koboSpan" id="kobo.193.1">code should be quite familiar. </span><span class="koboSpan" id="kobo.193.2">Here’s a breakdown of what </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">we did:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.195.1">At the very beginning, on </span><em class="italic"><span class="koboSpan" id="kobo.196.1">lines 1</span></em><span class="koboSpan" id="kobo.197.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.198.1">2</span></em><span class="koboSpan" id="kobo.199.1">, we import the necessary libraries – in this case, </span><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">streamlit</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.201.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.202.1">Pillow</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.203.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.204.1">After that, on </span><em class="italic"><span class="koboSpan" id="kobo.205.1">line 5</span></em><span class="koboSpan" id="kobo.206.1">, we create a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.207.1">main()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.208.1"> function:</span></span><ul><li><span class="koboSpan" id="kobo.209.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.210.1">main()</span></strong><span class="koboSpan" id="kobo.211.1"> function, we write some HTML code in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.212.1">html_temp</span></strong><span class="koboSpan" id="kobo.213.1"> variable (</span><em class="italic"><span class="koboSpan" id="kobo.214.1">line 8</span></em><span class="koboSpan" id="kobo.215.1">) to set a big title in the web app that specifies the background color, the padding, and the </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">text color</span></span></li><li><span class="koboSpan" id="kobo.217.1">Then, we visualize the HTML code using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">st.markdown</span></strong><span class="koboSpan" id="kobo.219.1"> instruction (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.220.1">line 14</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.221.1">)</span></span></li></ul></li>
<li><span class="koboSpan" id="kobo.222.1">Next, we create a list on </span><em class="italic"><span class="koboSpan" id="kobo.223.1">line 16</span></em><span class="koboSpan" id="kobo.224.1"> that contains the voices of the menu we want to visualize and add a selectbox in the sidebar on the left-hand side of </span><span class="No-Break"><span class="koboSpan" id="kobo.225.1">the screen.</span></span></li>
<li><span class="koboSpan" id="kobo.226.1">Then, we check the selection (</span><em class="italic"><span class="koboSpan" id="kobo.227.1">line 19</span></em><span class="koboSpan" id="kobo.228.1">) and if it is </span><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">Home</span></strong><span class="koboSpan" id="kobo.230.1">, we do something: at the moment, we just write some text in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.231.1">subheader</span></strong><span class="koboSpan" id="kobo.232.1"> format. </span><span class="koboSpan" id="kobo.232.2">Meanwhile, if the selection is </span><strong class="source-inline"><span class="koboSpan" id="kobo.233.1">Login</span></strong> <em class="italic"><span class="koboSpan" id="kobo.234.1">(line 25</span></em><span class="koboSpan" id="kobo.235.1">), we pass (we will develop the code for this in the </span><em class="italic"><span class="koboSpan" id="kobo.236.1">Creating the Login menu</span></em><span class="koboSpan" id="kobo.237.1"> subsection); the same goes for </span><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">Signup</span></strong><span class="koboSpan" id="kobo.239.1"> (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.240.1">line 28</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">).</span></span></li>
<li><span class="koboSpan" id="kobo.242.1">Finally, we add an </span><strong class="source-inline"><span class="koboSpan" id="kobo.243.1">About</span></strong><span class="koboSpan" id="kobo.244.1"> section (</span><em class="italic"><span class="koboSpan" id="kobo.245.1">line 32</span></em><span class="koboSpan" id="kobo.246.1">), where we are free to write anything </span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">we want.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.248.1">Please note </span><a id="_idIndexMarker430"/><span class="koboSpan" id="kobo.249.1">that in the </span><strong class="bold"><span class="koboSpan" id="kobo.250.1">Home</span></strong><span class="koboSpan" id="kobo.251.1"> section, just after the header, we can visualize an image thanks to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.252.1">st.image</span></strong><span class="koboSpan" id="kobo.253.1"> instruction. </span><span class="koboSpan" id="kobo.253.2">This image, named </span><strong class="source-inline"><span class="koboSpan" id="kobo.254.1">login.png</span></strong><span class="koboSpan" id="kobo.255.1">, must be present in the same directory as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">app.py</span></strong><span class="koboSpan" id="kobo.257.1"> file, as shown in the </span><strong class="screen-inline"><span class="koboSpan" id="kobo.258.1">Folder</span></strong><span class="koboSpan" id="kobo.259.1"> section of the editor in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.260.1">Figure 13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.261.1">.2</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.262.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.263.1">As usual, when we execute the following command, the web application will </span><span class="No-Break"><span class="koboSpan" id="kobo.264.1">be executed:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.265.1">
pipenv run streamlit run app.py</span></pre> <p><span class="koboSpan" id="kobo.266.1">The result in the browser is quite simple </span><span class="No-Break"><span class="koboSpan" id="kobo.267.1">and clean:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer266">
<span class="koboSpan" id="kobo.268.1"><img alt="Figure 13.3: The login/signup web app in the browser" src="image/B21147_13_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.269.1">Figure 13.3: The login/signup web app in the browser</span></p>
<p><span class="koboSpan" id="kobo.270.1">On the left, we have the sidebar with the menu, while in the middle, there is the </span><strong class="bold"><span class="koboSpan" id="kobo.271.1">Home</span></strong><span class="koboSpan" id="kobo.272.1"> section with a </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">beautiful picture.</span></span></p>
<p><span class="koboSpan" id="kobo.274.1">The skeleton is ready. </span><span class="koboSpan" id="kobo.274.2">Now, it’s time to connect our web app to a database so that we can save all username/password data and use it at the </span><span class="No-Break"><span class="koboSpan" id="kobo.275.1">proper time.</span></span></p>
<h1 id="_idParaDest-143"><a id="_idTextAnchor143"/><span class="koboSpan" id="kobo.276.1">Connecting to a relational database and interacting 
with it</span></h1>
<p><span class="koboSpan" id="kobo.277.1">As explained in the </span><em class="italic"><span class="koboSpan" id="kobo.278.1">Understanding the logic behind the login and signup page</span></em><span class="koboSpan" id="kobo.279.1"> section, we want </span><a id="_idIndexMarker431"/><span class="koboSpan" id="kobo.280.1">to save the accounts in a database. </span><span class="koboSpan" id="kobo.280.2">So, we have </span><a id="_idIndexMarker432"/><span class="koboSpan" id="kobo.281.1">to import the database </span><a id="_idIndexMarker433"/><span class="koboSpan" id="kobo.282.1">libraries. </span><span class="koboSpan" id="kobo.282.2">As mentioned previously, we are using a </span><strong class="bold"><span class="koboSpan" id="kobo.283.1">SQLite3</span></strong><span class="koboSpan" id="kobo.284.1"> database. </span><span class="koboSpan" id="kobo.284.2">So, first of all, let’s install its Python library by typing </span><span class="No-Break"><span class="koboSpan" id="kobo.285.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.286.1">
pipenv install sqlite3</span></pre> <p><span class="koboSpan" id="kobo.287.1">Then, simply import the library by writing </span><strong class="source-inline"><span class="koboSpan" id="kobo.288.1">import sqlite3</span></strong><span class="koboSpan" id="kobo.289.1"> in our </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.290.1">app.py</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.291.1"> file.</span></span></p>
<p><span class="koboSpan" id="kobo.292.1">Making a SQLite3 database work for us is a quite simple task. </span><span class="koboSpan" id="kobo.292.2">For this, we need to open a </span><em class="italic"><span class="koboSpan" id="kobo.293.1">connection</span></em><span class="koboSpan" id="kobo.294.1"> to the database by specifying its name (in our case, </span><strong class="source-inline"><span class="koboSpan" id="kobo.295.1">userdata.db</span></strong><span class="koboSpan" id="kobo.296.1">) as an argument and creating a </span><em class="italic"><span class="koboSpan" id="kobo.297.1">cursor</span></em><span class="koboSpan" id="kobo.298.1"> to execute operations </span><span class="No-Break"><span class="koboSpan" id="kobo.299.1">in it.</span></span></p>
<p><span class="koboSpan" id="kobo.300.1">On </span><em class="italic"><span class="koboSpan" id="kobo.301.1">lines 6</span></em><span class="koboSpan" id="kobo.302.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.303.1">7</span></em><span class="koboSpan" id="kobo.304.1"> in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.305.1">Figure 13</span></em></span><em class="italic"><span class="koboSpan" id="kobo.306.1">.4</span></em><span class="koboSpan" id="kobo.307.1">, the connection and cursor </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">are created:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer267">
<span class="koboSpan" id="kobo.309.1"><img alt="Figure 13.4: The connection to the database and its cursor" src="image/B21147_13_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.310.1">Figure 13.4: The connection to the database and its cursor</span></p>
<p><span class="koboSpan" id="kobo.311.1">To recap, the </span><em class="italic"><span class="koboSpan" id="kobo.312.1">connection</span></em><span class="koboSpan" id="kobo.313.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.314.1">conn</span></strong><span class="koboSpan" id="kobo.315.1">) opens a connection to the database while the </span><em class="italic"><span class="koboSpan" id="kobo.316.1">cursor</span></em><span class="koboSpan" id="kobo.317.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.318.1">c</span></strong><span class="koboSpan" id="kobo.319.1">) makes it possible to operate inside the database. </span><span class="koboSpan" id="kobo.319.2">Essentially, we need three </span><span class="No-Break"><span class="koboSpan" id="kobo.320.1">different operations:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.321.1">Table creation</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.322.1">Data insertion</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.323.1">Data retrieval</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.324.1">The best way </span><a id="_idIndexMarker434"/><span class="koboSpan" id="kobo.325.1">to implement these operations is to create a </span><a id="_idIndexMarker435"/><span class="koboSpan" id="kobo.326.1">specific function dedicated to each of these operations, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.327.1">following figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer268">
<span class="koboSpan" id="kobo.328.1"><img alt="Figure 13.5: The database functions" src="image/B21147_13_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.329.1">Figure 13.5: The database functions</span></p>
<p><span class="koboSpan" id="kobo.330.1">Let’s take a closer look at these </span><span class="No-Break"><span class="koboSpan" id="kobo.331.1">three functions:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.332.1">The first one is named </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">create_table</span></strong><span class="koboSpan" id="kobo.334.1">. </span><span class="koboSpan" id="kobo.334.2">Simply put, this function creates a table named </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">userstable</span></strong><span class="koboSpan" id="kobo.336.1">, but only if this table is not already present in the database. </span><span class="koboSpan" id="kobo.336.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.337.1">userstable</span></strong><span class="koboSpan" id="kobo.338.1"> table has two columns named </span><strong class="source-inline"><span class="koboSpan" id="kobo.339.1">username</span></strong><span class="koboSpan" id="kobo.340.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.341.1">password</span></strong><span class="koboSpan" id="kobo.342.1">, each of which contains text. </span><span class="koboSpan" id="kobo.342.2">It’s important to understand that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.343.1">CREATE TABLE</span></strong><span class="koboSpan" id="kobo.344.1"> instruction is given to the database using the cursor we created in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.345.1">Figure 13</span></em></span><em class="italic"><span class="koboSpan" id="kobo.346.1">.4</span></em><span class="koboSpan" id="kobo.347.1">. </span><span class="koboSpan" id="kobo.347.2">So, the cursor, leveraging the opened connection, makes it possible to </span><em class="italic"><span class="koboSpan" id="kobo.348.1">deliver</span></em><span class="koboSpan" id="kobo.349.1"> operations (or functions) to </span><span class="No-Break"><span class="koboSpan" id="kobo.350.1">the database.</span></span></li>
<li><span class="koboSpan" id="kobo.351.1">The second function is named </span><strong class="source-inline"><span class="koboSpan" id="kobo.352.1">add_data</span></strong><span class="koboSpan" id="kobo.353.1"> because it oversees data insertion or values inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.354.1">userstable</span></strong><span class="koboSpan" id="kobo.355.1"> table we created with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.356.1">create_table</span></strong><span class="koboSpan" id="kobo.357.1"> function. </span><span class="koboSpan" id="kobo.357.2">So, we pass two values to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.358.1">add_data</span></strong><span class="koboSpan" id="kobo.359.1"> function – a username and a password – as an argument and it inserts these two values in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.360.1">userstable</span></strong><span class="koboSpan" id="kobo.361.1"> table in the </span><a id="_idIndexMarker436"/><span class="koboSpan" id="kobo.362.1">following order: the username </span><a id="_idIndexMarker437"/><span class="koboSpan" id="kobo.363.1">value in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.364.1">username</span></strong><span class="koboSpan" id="kobo.365.1"> column and the password value in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.366.1">password</span></strong><span class="koboSpan" id="kobo.367.1"> column. </span><span class="koboSpan" id="kobo.367.2">Once again, the cursor oversees carrying out the instruction. </span><strong class="source-inline"><span class="koboSpan" id="kobo.368.1">conn.commit()</span></strong><span class="koboSpan" id="kobo.369.1"> is extremely important because, without this </span><em class="italic"><span class="koboSpan" id="kobo.370.1">commit</span></em><span class="koboSpan" id="kobo.371.1">, the new username and values won’t be stored in </span><span class="No-Break"><span class="koboSpan" id="kobo.372.1">the database.</span></span></li>
<li><span class="koboSpan" id="kobo.373.1">The third function is named </span><strong class="source-inline"><span class="koboSpan" id="kobo.374.1">login_user</span></strong><span class="koboSpan" id="kobo.375.1"> and, similar to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.376.1">add_data</span></strong><span class="koboSpan" id="kobo.377.1"> function, has two arguments: </span><strong class="source-inline"><span class="koboSpan" id="kobo.378.1">username</span></strong><span class="koboSpan" id="kobo.379.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.380.1">password</span></strong><span class="koboSpan" id="kobo.381.1">. </span><span class="koboSpan" id="kobo.381.2">It takes these two values and looks for them inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.382.1">userstable</span></strong><span class="koboSpan" id="kobo.383.1"> table, then retrieves (</span><strong class="source-inline"><span class="koboSpan" id="kobo.384.1">fetchall</span></strong><span class="koboSpan" id="kobo.385.1">) all the results and puts them in a variable named </span><strong class="source-inline"><span class="koboSpan" id="kobo.386.1">data</span></strong><span class="koboSpan" id="kobo.387.1">. </span><span class="koboSpan" id="kobo.387.2">This </span><strong class="source-inline"><span class="koboSpan" id="kobo.388.1">data</span></strong><span class="koboSpan" id="kobo.389.1"> variable is returned as the final output of the function. </span><span class="koboSpan" id="kobo.389.2">In this way, it is possible to check when a username and a password are present in the database. </span><span class="koboSpan" id="kobo.389.3">Once again, the cursor oversees carrying out </span><span class="No-Break"><span class="koboSpan" id="kobo.390.1">the commands.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.391.1">With these three functions ready, we can move on to the </span><strong class="bold"><span class="koboSpan" id="kobo.392.1">Login</span></strong><span class="koboSpan" id="kobo.393.1"> voice of the menu in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.394.1">app.py</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.395.1"> file.</span></span></p>
<h2 id="_idParaDest-144"><a id="_idTextAnchor144"/><span class="koboSpan" id="kobo.396.1">Creating the Login menu</span></h2>
<p><span class="koboSpan" id="kobo.397.1">First, we need a </span><a id="_idIndexMarker438"/><span class="koboSpan" id="kobo.398.1">couple of text inputs, one for the username and one for the password, after which we can put them in the sidebar. </span><span class="koboSpan" id="kobo.398.2">So, let’s add two new lines, as shown on </span><em class="italic"><span class="koboSpan" id="kobo.399.1">lines 46</span></em><span class="koboSpan" id="kobo.400.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.401.1">47</span></em><span class="koboSpan" id="kobo.402.1"> in the </span><span class="No-Break"><span class="koboSpan" id="kobo.403.1">following figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer269">
<span class="koboSpan" id="kobo.404.1"><img alt="Figure 13.6: Text input for username and password" src="image/B21147_13_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.405.1">Figure 13.6: Text input for username and password</span></p>
<p><span class="koboSpan" id="kobo.406.1">Upon specifying </span><strong class="source-inline"><span class="koboSpan" id="kobo.407.1">type='password'</span></strong><span class="koboSpan" id="kobo.408.1"> on </span><em class="italic"><span class="koboSpan" id="kobo.409.1">line 47</span></em><span class="koboSpan" id="kobo.410.1">, the password we type will be hidden; by clicking </span><a id="_idIndexMarker439"/><span class="koboSpan" id="kobo.411.1">on the </span><em class="italic"><span class="koboSpan" id="kobo.412.1">eye</span></em><span class="koboSpan" id="kobo.413.1"> icon, we can see the password clearly in the browser, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.414.1">following figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer270">
<span class="koboSpan" id="kobo.415.1"><img alt="Figure 13.7: The password is hidden" src="image/B21147_13_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.416.1">Figure 13.7: The password is hidden</span></p>
<p><span class="koboSpan" id="kobo.417.1">At this point, the logic behind the login should be quite clear: we insert a username and a password and look for them in the database to understand whether a specific user is allowed to log into our app </span><span class="No-Break"><span class="koboSpan" id="kobo.418.1">or not.</span></span></p>
<p><span class="koboSpan" id="kobo.419.1">As usual, let’s have a look at the code that performs </span><span class="No-Break"><span class="koboSpan" id="kobo.420.1">this function:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer271">
<span class="koboSpan" id="kobo.421.1"><img alt="Figure 13.8: The “Login” section’s code" src="image/B21147_13_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.422.1">Figure 13.8: The “Login” section’s code</span></p>
<p><span class="koboSpan" id="kobo.423.1">Here’s a </span><a id="_idIndexMarker440"/><span class="koboSpan" id="kobo.424.1">breakdown of what the code in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.425.1">Figure </span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.426.1">13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.427.1">.8</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.428.1"> does:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.429.1">On </span><em class="italic"><span class="koboSpan" id="kobo.430.1">line 49</span></em><span class="koboSpan" id="kobo.431.1">, we added a checkbox; when it is selected, a new subheading is printed in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.432.1">main</span></strong><span class="koboSpan" id="kobo.433.1"> section of the </span><span class="No-Break"><span class="koboSpan" id="kobo.434.1">web app.</span></span></li>
<li><span class="koboSpan" id="kobo.435.1">After that, on </span><em class="italic"><span class="koboSpan" id="kobo.436.1">line 51</span></em><span class="koboSpan" id="kobo.437.1">, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">create_table</span></strong><span class="koboSpan" id="kobo.439.1"> function, which we described previously, is executed. </span><span class="koboSpan" id="kobo.439.2">In this way, a new table named </span><strong class="source-inline"><span class="koboSpan" id="kobo.440.1">userstable</span></strong><span class="koboSpan" id="kobo.441.1"> will be created in the database, but only if it doesn’t </span><span class="No-Break"><span class="koboSpan" id="kobo.442.1">exist already.</span></span></li>
<li><span class="koboSpan" id="kobo.443.1">On </span><em class="italic"><span class="koboSpan" id="kobo.444.1">line 53</span></em><span class="koboSpan" id="kobo.445.1">, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.446.1">login_user</span></strong><span class="koboSpan" id="kobo.447.1"> function is executed, with the username and password that were inputted using the two </span><strong class="source-inline"><span class="koboSpan" id="kobo.448.1">text_inputs</span></strong><span class="koboSpan" id="kobo.449.1"> widgets on </span><em class="italic"><span class="koboSpan" id="kobo.450.1">lines 46</span></em><span class="koboSpan" id="kobo.451.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.452.1">47</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.453.1">as arguments.</span></span></li>
<li><span class="koboSpan" id="kobo.454.1">If the result of the data fetching is positive, we print the </span><strong class="bold"><span class="koboSpan" id="kobo.455.1">Logged in...</span></strong><span class="koboSpan" id="kobo.456.1"> message with </span><em class="italic"><span class="koboSpan" id="kobo.457.1">success</span></em><span class="koboSpan" id="kobo.458.1"> and show a selectbox with a couple of tasks (just some placeholders); otherwise, we print a </span><em class="italic"><span class="koboSpan" id="kobo.459.1">warning</span></em><span class="koboSpan" id="kobo.460.1"> stating the </span><strong class="bold"><span class="koboSpan" id="kobo.461.1">Incorrect </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.462.1">Username/Password</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.463.1"> message.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.464.1">If you try to log in now, you’ll get the </span><strong class="bold"><span class="koboSpan" id="kobo.465.1">Incorrect Username/Password</span></strong><span class="koboSpan" id="kobo.466.1"> message since no data is present in </span><span class="No-Break"><span class="koboSpan" id="kobo.467.1">the database.</span></span></p>
<p><span class="koboSpan" id="kobo.468.1">To populate the database, we must implement the </span><strong class="source-inline"><span class="koboSpan" id="kobo.469.1">SignUp</span></strong><span class="koboSpan" id="kobo.470.1"> function. </span><span class="koboSpan" id="kobo.470.2">Let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.471.1">see how.</span></span></p>
<h2 id="_idParaDest-145"><a id="_idTextAnchor145"/><span class="koboSpan" id="kobo.472.1">Creating the Sign Up menu</span></h2>
<p><span class="koboSpan" id="kobo.473.1">The logic is </span><a id="_idIndexMarker441"/><span class="koboSpan" id="kobo.474.1">the same as that for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.475.1">Login</span></strong><span class="koboSpan" id="kobo.476.1"> function but we must make a couple of changes, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.477.1">following code:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer272">
<span class="koboSpan" id="kobo.478.1"><img alt="Figure 13.9: The “SignUp” section code" src="image/B21147_13_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.479.1">Figure 13.9: The “SignUp” section code</span></p>
<p><span class="koboSpan" id="kobo.480.1">Here’s a breakdown of what </span><span class="No-Break"><span class="koboSpan" id="kobo.481.1">we did:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.482.1">On </span><em class="italic"><span class="koboSpan" id="kobo.483.1">lines 66</span></em><span class="koboSpan" id="kobo.484.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.485.1">67</span></em><span class="koboSpan" id="kobo.486.1">, we have two </span><strong class="source-inline"><span class="koboSpan" id="kobo.487.1">text_input</span></strong><span class="koboSpan" id="kobo.488.1"> widgets to collect the username and the password, but this time, we are putting them in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">main</span></strong><span class="koboSpan" id="kobo.490.1"> section of the web app and not in </span><span class="No-Break"><span class="koboSpan" id="kobo.491.1">the sidebar.</span></span></li>
<li><span class="koboSpan" id="kobo.492.1">After that, on </span><em class="italic"><span class="koboSpan" id="kobo.493.1">line 68</span></em><span class="koboSpan" id="kobo.494.1">, we add a button with a label of </span><strong class="source-inline"><span class="koboSpan" id="kobo.495.1">Sign Up</span></strong><span class="koboSpan" id="kobo.496.1">. </span><span class="koboSpan" id="kobo.496.2">When this button is pushed, we execute the </span><strong class="source-inline"><span class="koboSpan" id="kobo.497.1">create_table</span></strong><span class="koboSpan" id="kobo.498.1"> function (we must ensure that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">userstable</span></strong><span class="koboSpan" id="kobo.500.1"> table exists; otherwise, we will get a </span><span class="No-Break"><span class="koboSpan" id="kobo.501.1">runtime error).</span></span></li>
<li><span class="koboSpan" id="kobo.502.1">On </span><em class="italic"><span class="koboSpan" id="kobo.503.1">line 71</span></em><span class="koboSpan" id="kobo.504.1">, we execute the </span><strong class="source-inline"><span class="koboSpan" id="kobo.505.1">add_data</span></strong><span class="koboSpan" id="kobo.506.1"> function. </span><span class="koboSpan" id="kobo.506.2">We’ve already explained this function (see </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.507.1">Figure 13</span></em></span><em class="italic"><span class="koboSpan" id="kobo.508.1">.5</span></em><span class="koboSpan" id="kobo.509.1">), so we know that by passing the username and password that have been inputted by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">text_input</span></strong><span class="koboSpan" id="kobo.511.1"> widgets to it, we create a new </span><a id="_idIndexMarker442"/><span class="koboSpan" id="kobo.512.1">record in the database. </span><span class="koboSpan" id="kobo.512.2">This new record will contain the new username </span><span class="No-Break"><span class="koboSpan" id="kobo.513.1">and password.</span></span></li>
<li><span class="koboSpan" id="kobo.514.1">Finally, on </span><em class="italic"><span class="koboSpan" id="kobo.515.1">line 73</span></em><span class="koboSpan" id="kobo.516.1">, we print a beautiful </span><em class="italic"><span class="koboSpan" id="kobo.517.1">success</span></em><span class="koboSpan" id="kobo.518.1"> message to confirm the creation of </span><span class="No-Break"><span class="koboSpan" id="kobo.519.1">the account.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.520.1">Let’s see the web application </span><span class="No-Break"><span class="koboSpan" id="kobo.521.1">in action.</span></span></p>
<h2 id="_idParaDest-146"><a id="_idTextAnchor146"/><span class="koboSpan" id="kobo.522.1">Running the app</span></h2>
<p><span class="koboSpan" id="kobo.523.1">In the </span><a id="_idIndexMarker443"/><span class="koboSpan" id="kobo.524.1">menu, select </span><strong class="bold"><span class="koboSpan" id="kobo.525.1">Sign Up</span></strong><span class="koboSpan" id="kobo.526.1"> and insert a new username, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.527.1">user1</span></strong><span class="koboSpan" id="kobo.528.1">, and a password, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.529.1">12345</span></strong><span class="koboSpan" id="kobo.530.1"> (please remember that during real usage, you should use a </span><span class="No-Break"><span class="koboSpan" id="kobo.531.1">stronger password):</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer273">
<span class="koboSpan" id="kobo.532.1"><img alt="Figure 13.10: ﻿Using Sign Up to create a new account" src="image/B21147_13_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.533.1">Figure 13.10: Using Sign Up to create a new account</span></p>
<p><span class="koboSpan" id="kobo.534.1">Then, click on the </span><strong class="bold"><span class="koboSpan" id="kobo.535.1">Sign Up</span></strong><span class="koboSpan" id="kobo.536.1"> button; you’ll get a </span><strong class="bold"><span class="koboSpan" id="kobo.537.1">You have successfully created an </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.538.1">Account</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.539.1"> message.</span></span></p>
<p><span class="koboSpan" id="kobo.540.1">With that, we have inserted our first account into our database. </span><span class="koboSpan" id="kobo.540.2">This means we can try to </span><span class="No-Break"><span class="koboSpan" id="kobo.541.1">log in.</span></span></p>
<p><span class="koboSpan" id="kobo.542.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.543.1">Login</span></strong><span class="koboSpan" id="kobo.544.1"> from the menu, type the username (</span><strong class="bold"><span class="koboSpan" id="kobo.545.1">user1</span></strong><span class="koboSpan" id="kobo.546.1">) and password (</span><strong class="bold"><span class="koboSpan" id="kobo.547.1">12345</span></strong><span class="koboSpan" id="kobo.548.1">), and enter the web application. </span><span class="koboSpan" id="kobo.548.2">We’ll get a </span><strong class="bold"><span class="koboSpan" id="kobo.549.1">Logged in as: user1</span></strong><span class="koboSpan" id="kobo.550.1"> message and the list of tasks (I repeat, these are </span><span class="No-Break"><span class="koboSpan" id="kobo.551.1">just placeholders):</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer274">
<span class="koboSpan" id="kobo.552.1"><img alt="Figure 13.11: Using “Login” to enter the web application" src="image/B21147_13_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.553.1">Figure 13.11: Using “Login” to enter the web application</span></p>
<p><span class="koboSpan" id="kobo.554.1">When we </span><a id="_idIndexMarker444"/><span class="koboSpan" id="kobo.555.1">try to log in with an incorrect username or password, we get the </span><span class="No-Break"><span class="koboSpan" id="kobo.556.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer275">
<span class="koboSpan" id="kobo.557.1"><img alt="Figure 13.12: Logging in with the wrong username/password" src="image/B21147_13_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.558.1">Figure 13.12: Logging in with the wrong username/password</span></p>
<p><span class="koboSpan" id="kobo.559.1">We typed </span><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">user100</span></strong><span class="koboSpan" id="kobo.561.1">, but this username is not present in the database, so it is not possible to log in. </span><span class="koboSpan" id="kobo.561.2">We cannot enter the web application and for this reason, we cannot see the list </span><span class="No-Break"><span class="koboSpan" id="kobo.562.1">of tasks.</span></span></p>
<p><span class="koboSpan" id="kobo.563.1">The web application is working very well. </span><span class="koboSpan" id="kobo.563.2">Next, we’ll add a nice graphical user interface to </span><span class="No-Break"><span class="koboSpan" id="kobo.564.1">our app.</span></span></p>
<h2 id="_idParaDest-147"><a id="_idTextAnchor147"/><span class="koboSpan" id="kobo.565.1">Adding a graphical user interface</span></h2>
<p><span class="koboSpan" id="kobo.566.1">From the </span><a id="_idIndexMarker445"/><span class="koboSpan" id="kobo.567.1">command line, please install </span><strong class="bold"><span class="koboSpan" id="kobo.568.1">DB Browser for SQLite</span></strong><span class="koboSpan" id="kobo.569.1">, a very nice graphical interface for managing SQLite databases. </span><span class="koboSpan" id="kobo.569.2">Type the </span><span class="No-Break"><span class="koboSpan" id="kobo.570.1">following instruction:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.571.1">
sudo apt install sqlitebrowser</span></pre> <p><span class="koboSpan" id="kobo.572.1">Once the installation has finished, please launch the application; a graphical user interface, as shown in the following figure, </span><span class="No-Break"><span class="koboSpan" id="kobo.573.1">should appear:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer276">
<span class="koboSpan" id="kobo.574.1"><img alt="Figure 13.13: DB Browser for SQLite" src="image/B21147_13_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.575.1">Figure 13.13: DB Browser for SQLite</span></p>
<p><span class="koboSpan" id="kobo.576.1">With that, we are ready to open the database we created in our </span><span class="No-Break"><span class="koboSpan" id="kobo.577.1">web app:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.578.1">Click on </span><strong class="bold"><span class="koboSpan" id="kobo.579.1">File</span></strong><span class="koboSpan" id="kobo.580.1"> | </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.581.1">Open Database</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.582.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.583.1">As shown in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.584.1">Login_Skeleton</span></strong><span class="koboSpan" id="kobo.585.1"> directory, there is a file named </span><strong class="source-inline"><span class="koboSpan" id="kobo.586.1">userdata.db</span></strong><span class="koboSpan" id="kobo.587.1">. </span><span class="koboSpan" id="kobo.587.2">Select it and </span><span class="No-Break"><span class="koboSpan" id="kobo.588.1">open it:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer277">
<span class="koboSpan" id="kobo.589.1"><img alt="Figure 13.14: Opening the userdata.db database" src="image/B21147_13_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.590.1">Figure 13.14: Opening the userdata.db database</span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.591.1">You should </span><a id="_idIndexMarker446"/><span class="koboSpan" id="kobo.592.1">see your database’s structure, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.593.1">following figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer278">
<span class="koboSpan" id="kobo.594.1"><img alt="Figure 13.15: The database’s structure" src="image/B21147_13_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.595.1">Figure 13.15: The database’s structure</span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.596.1">As we know, the database has a table named </span><strong class="source-inline"><span class="koboSpan" id="kobo.597.1">userstable</span></strong><span class="koboSpan" id="kobo.598.1">, and this table has two text </span><a id="_idIndexMarker447"/><span class="koboSpan" id="kobo.599.1">columns: </span><strong class="source-inline"><span class="koboSpan" id="kobo.600.1">username</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.601.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.602.1">password</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.603.1">.</span></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.604.1">Select the </span><strong class="source-inline"><span class="koboSpan" id="kobo.605.1">Browse </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.606.1">Data</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.607.1"> tag.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.608.1">As shown in the following figure, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.609.1">userstable</span></strong><span class="koboSpan" id="kobo.610.1"> table contains the account we created previously – the one where the username is equal to </span><strong class="bold"><span class="koboSpan" id="kobo.611.1">user1</span></strong><span class="koboSpan" id="kobo.612.1"> and the password is equal </span><span class="No-Break"><span class="koboSpan" id="kobo.613.1">to </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.614.1">12345</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.615.1">:</span></span></p></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer279">
<span class="koboSpan" id="kobo.616.1"><img alt="Figure 13.16: The account saved in our table" src="image/B21147_13_16.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.617.1">Figure 13.16: The account saved in our table</span></p>
<p><span class="koboSpan" id="kobo.618.1">There is </span><a id="_idIndexMarker448"/><span class="koboSpan" id="kobo.619.1">one big problem related to security here: the password is in </span><em class="italic"><span class="koboSpan" id="kobo.620.1">plain text</span></em><span class="koboSpan" id="kobo.621.1">. </span><span class="koboSpan" id="kobo.621.2">Anybody that can access the </span><strong class="source-inline"><span class="koboSpan" id="kobo.622.1">userdata.db</span></strong><span class="koboSpan" id="kobo.623.1"> file in our database can read it. </span><span class="koboSpan" id="kobo.623.2">This is the reason why we must introduce hashing encryption in our code – to make it almost impossible for anybody to discover our passwords in such an easy way. </span><span class="koboSpan" id="kobo.623.3">We’ll see how in the </span><span class="No-Break"><span class="koboSpan" id="kobo.624.1">next section.</span></span></p>
<h1 id="_idParaDest-148"><a id="_idTextAnchor148"/><span class="koboSpan" id="kobo.625.1">Retrieving or saving credentials from and to the database</span></h1>
<p><span class="koboSpan" id="kobo.626.1">From a theoretical </span><a id="_idIndexMarker449"/><span class="koboSpan" id="kobo.627.1">point of view, we have already discussed what </span><a id="_idIndexMarker450"/><span class="koboSpan" id="kobo.628.1">a hash is and why we should use one. </span><span class="koboSpan" id="kobo.628.2">From a practical point of view, there are many Python packages available (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.629.1">sha256</span></strong><span class="koboSpan" id="kobo.630.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.631.1">pycrypto</span></strong><span class="koboSpan" id="kobo.632.1">), but one of the easiest to use that’s also very effective is </span><strong class="source-inline"><span class="koboSpan" id="kobo.633.1">hashlib</span></strong><span class="koboSpan" id="kobo.634.1">. </span><span class="koboSpan" id="kobo.634.2">This library is installed in Python by default, so we don’t have to install it in our virtual environment; all we have to do is import it into our </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.635.1">app.py</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.636.1"> file.</span></span></p>
<p><span class="koboSpan" id="kobo.637.1">While leveraging </span><strong class="source-inline"><span class="koboSpan" id="kobo.638.1">hashlib</span></strong><span class="koboSpan" id="kobo.639.1">, all we need to do is use its </span><strong class="source-inline"><span class="koboSpan" id="kobo.640.1">sha256</span></strong><span class="koboSpan" id="kobo.641.1"> method to create the hash encryption of the password. </span><span class="koboSpan" id="kobo.641.2">Once again, let me highlight that </span><em class="italic"><span class="koboSpan" id="kobo.642.1">SHA-256</span></em><span class="koboSpan" id="kobo.643.1"> is a very strong form of encryption from a </span><span class="No-Break"><span class="koboSpan" id="kobo.644.1">security perspective.</span></span></p>
<p><span class="koboSpan" id="kobo.645.1">These are the new lines of code we need for the </span><span class="No-Break"><span class="koboSpan" id="kobo.646.1">hashing process:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer280">
<span class="koboSpan" id="kobo.647.1"><img alt="Figure 13.17: The make_hashes function" src="image/B21147_13_17.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.648.1">Figure 13.17: The make_hashes function</span></p>
<p><span class="koboSpan" id="kobo.649.1">Here’s a breakdown of what </span><span class="No-Break"><span class="koboSpan" id="kobo.650.1">we did:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.651.1">On </span><em class="italic"><span class="koboSpan" id="kobo.652.1">line 5</span></em><span class="koboSpan" id="kobo.653.1">, we </span><span class="No-Break"><span class="koboSpan" id="kobo.654.1">imported </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.655.1">hashlib</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.656.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.657.1">On </span><em class="italic"><span class="koboSpan" id="kobo.658.1">lines 12</span></em><span class="koboSpan" id="kobo.659.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.660.1">13</span></em><span class="koboSpan" id="kobo.661.1">, we created a new function named </span><strong class="source-inline"><span class="koboSpan" id="kobo.662.1">make_hashes</span></strong><span class="koboSpan" id="kobo.663.1">. </span><span class="koboSpan" id="kobo.663.2">This function has just one input argument: the password. </span><span class="koboSpan" id="kobo.663.3">This password is passed to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.664.1">sha256</span></strong><span class="koboSpan" id="kobo.665.1"> method, which creates a hashing from it. </span><span class="koboSpan" id="kobo.665.2">This hashing is converted into hexadecimal </span><span class="No-Break"><span class="koboSpan" id="kobo.666.1">and returned.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.667.1">As we know, there is </span><a id="_idIndexMarker451"/><span class="koboSpan" id="kobo.668.1">no way to decode a hashing. </span><span class="koboSpan" id="kobo.668.2">This means </span><a id="_idIndexMarker452"/><span class="koboSpan" id="kobo.669.1">that once we convert the password into a hash, we cannot convert it back again. </span><span class="koboSpan" id="kobo.669.2">So, to complete the authentication/login of a user, we must type the password into </span><strong class="source-inline"><span class="koboSpan" id="kobo.670.1">text_input</span></strong><span class="koboSpan" id="kobo.671.1">, convert it into its hashing, and compare the result with the hashing stored in the database. </span><span class="koboSpan" id="kobo.671.2">If the two hash codes are the same, this means that the inputted password is correct; otherwise, it is different from the </span><span class="No-Break"><span class="koboSpan" id="kobo.672.1">saved one.</span></span></p>
<p><span class="koboSpan" id="kobo.673.1">Implementing this procedure requires us to make a few modifications to </span><span class="No-Break"><span class="koboSpan" id="kobo.674.1">our code:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.675.1">First, we must convert the inputted password into a hashing. </span><span class="koboSpan" id="kobo.675.2">This can be done using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.676.1">make_hashes</span></strong><span class="koboSpan" id="kobo.677.1"> function we </span><span class="No-Break"><span class="koboSpan" id="kobo.678.1">just discussed.</span></span></li>
<li><span class="koboSpan" id="kobo.679.1">Then, we need to compare this hashing with the one saved in </span><span class="No-Break"><span class="koboSpan" id="kobo.680.1">the database.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.681.1">The first code change affects the </span><strong class="bold"><span class="koboSpan" id="kobo.682.1">Login</span></strong><span class="koboSpan" id="kobo.683.1"> section, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.684.1">following figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer281">
<span class="koboSpan" id="kobo.685.1"><img alt="Figure 13.18: The hashing of the inputted password" src="image/B21147_13_18.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.686.1">Figure 13.18: The hashing of the inputted password</span></p>
<p><span class="koboSpan" id="kobo.687.1">Here’s what </span><a id="_idIndexMarker453"/><span class="koboSpan" id="kobo.688.1">we are doing in the </span><span class="No-Break"><span class="koboSpan" id="kobo.689.1">preceding code:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.690.1">On </span><em class="italic"><span class="koboSpan" id="kobo.691.1">line 60</span></em><span class="koboSpan" id="kobo.692.1">, we make </span><a id="_idIndexMarker454"/><span class="koboSpan" id="kobo.693.1">a hash of the </span><span class="No-Break"><span class="koboSpan" id="kobo.694.1">inputted password.</span></span></li>
<li><span class="koboSpan" id="kobo.695.1">On </span><em class="italic"><span class="koboSpan" id="kobo.696.1">line 61</span></em><span class="koboSpan" id="kobo.697.1">, leveraging the </span><strong class="source-inline"><span class="koboSpan" id="kobo.698.1">check_hashes</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.699.1">function</span></strong><span class="koboSpan" id="kobo.700.1">, we compare the hashed password with the one (with the hashing) saved in the database. </span><span class="koboSpan" id="kobo.700.2">If they are the same, then the login process </span><span class="No-Break"><span class="koboSpan" id="kobo.701.1">is successful.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.702.1">Let’s write the </span><strong class="source-inline"><span class="koboSpan" id="kobo.703.1">check_hashes</span></strong><span class="koboSpan" id="kobo.704.1"> function; the code is very short, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.705.1">following figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer282">
<span class="koboSpan" id="kobo.706.1"><img alt="Figure 13.19: The “check_hashes” function" src="image/B21147_13_19.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.707.1">Figure 13.19: The “check_hashes” function</span></p>
<p><span class="koboSpan" id="kobo.708.1">Here’s what </span><a id="_idIndexMarker455"/><span class="koboSpan" id="kobo.709.1">we are doing in the </span><span class="No-Break"><span class="koboSpan" id="kobo.710.1">preceding code:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.711.1">On </span><em class="italic"><span class="koboSpan" id="kobo.712.1">line 15</span></em><span class="koboSpan" id="kobo.713.1">, we define </span><a id="_idIndexMarker456"/><span class="koboSpan" id="kobo.714.1">the new function, which has only two arguments: a password (clear text) and the hashed text (the hashing of the password saved in </span><span class="No-Break"><span class="koboSpan" id="kobo.715.1">the database).</span></span></li>
<li><span class="koboSpan" id="kobo.716.1">On </span><em class="italic"><span class="koboSpan" id="kobo.717.1">line 16</span></em><span class="koboSpan" id="kobo.718.1">, we can see that if the hashing of the password (which we get using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.719.1">make_hashes</span></strong><span class="koboSpan" id="kobo.720.1"> function) is the same as the one stored in the database, we return the hashed text (the hashed version of the password); otherwise, we </span><span class="No-Break"><span class="koboSpan" id="kobo.721.1">return </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.722.1">False</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.723.1">.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.724.1">So, moving back to </span><em class="italic"><span class="koboSpan" id="kobo.725.1">line 61</span></em><span class="koboSpan" id="kobo.726.1"> of the code shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.727.1">Figure 13</span></em></span><em class="italic"><span class="koboSpan" id="kobo.728.1">.18</span></em><span class="koboSpan" id="kobo.729.1">, when </span><strong class="source-inline"><span class="koboSpan" id="kobo.730.1">check_hashes</span></strong><span class="koboSpan" id="kobo.731.1"> returns the hashed password, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.732.1">result</span></strong><span class="koboSpan" id="kobo.733.1"> variable is </span><strong class="source-inline"><span class="koboSpan" id="kobo.734.1">True</span></strong><span class="koboSpan" id="kobo.735.1"> and the code enters the </span><strong class="source-inline"><span class="koboSpan" id="kobo.736.1">success</span></strong><span class="koboSpan" id="kobo.737.1"> part of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.738.1">if</span></strong><span class="koboSpan" id="kobo.739.1"> cycle. </span><span class="koboSpan" id="kobo.739.2">Otherwise, when </span><strong class="source-inline"><span class="koboSpan" id="kobo.740.1">check_hashes</span></strong><span class="koboSpan" id="kobo.741.1"> returns </span><strong class="source-inline"><span class="koboSpan" id="kobo.742.1">False</span></strong><span class="koboSpan" id="kobo.743.1">, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.744.1">result</span></strong><span class="koboSpan" id="kobo.745.1"> variable is </span><strong class="source-inline"><span class="koboSpan" id="kobo.746.1">False</span></strong><span class="koboSpan" id="kobo.747.1"> as well, and the code enters in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.748.1">else</span></strong><span class="koboSpan" id="kobo.749.1"> part of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.750.1">if</span></strong><span class="koboSpan" id="kobo.751.1"> cycle, denying </span><span class="No-Break"><span class="koboSpan" id="kobo.752.1">the login.</span></span></p>
<p><span class="koboSpan" id="kobo.753.1">Now, if we try to log into the web application using the account we saved previously (</span><strong class="bold"><span class="koboSpan" id="kobo.754.1">user1</span></strong><span class="koboSpan" id="kobo.755.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.756.1">12345</span></strong><span class="koboSpan" id="kobo.757.1">), we’ll fail and get a warning. </span><span class="koboSpan" id="kobo.757.2">The reason is that in our database, we saved the password without introducing the hashing, so the password is stored in </span><span class="No-Break"><span class="koboSpan" id="kobo.758.1">clear text.</span></span></p>
<p><span class="koboSpan" id="kobo.759.1">To complete all the login/signup web application coding, we must change the </span><strong class="bold"><span class="koboSpan" id="kobo.760.1">SignUp</span></strong><span class="koboSpan" id="kobo.761.1"> section a little bit, making sure that the passwords of the accounts are saved in their own </span><span class="No-Break"><span class="koboSpan" id="kobo.762.1">hashing version:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer283">
<span class="koboSpan" id="kobo.763.1"><img alt="Figure 13.20: The final “SignUp” section" src="image/B21147_13_20.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.764.1">Figure 13.20: The final “SignUp” section</span></p>
<p><span class="koboSpan" id="kobo.765.1">Here’s what </span><a id="_idIndexMarker457"/><span class="koboSpan" id="kobo.766.1">we are doing in the </span><span class="No-Break"><span class="koboSpan" id="kobo.767.1">preceding code:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.768.1">On </span><em class="italic"><span class="koboSpan" id="kobo.769.1">line 84</span></em><span class="koboSpan" id="kobo.770.1">, we create the hashing of the </span><span class="No-Break"><span class="koboSpan" id="kobo.771.1">inputted password</span></span></li>
<li><span class="koboSpan" id="kobo.772.1">On </span><em class="italic"><span class="koboSpan" id="kobo.773.1">line 85</span></em><span class="koboSpan" id="kobo.774.1">, we save it in the database, together with its </span><span class="No-Break"><span class="koboSpan" id="kobo.775.1">related username</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.776.1">At this point, we’ve </span><a id="_idIndexMarker458"/><span class="koboSpan" id="kobo.777.1">finished coding. </span><span class="koboSpan" id="kobo.777.2">We can try out the entire set of features of the web application, starting with creating a new account with a username of </span><strong class="source-inline"><span class="koboSpan" id="kobo.778.1">user2</span></strong><span class="koboSpan" id="kobo.779.1"> and a password </span><span class="No-Break"><span class="koboSpan" id="kobo.780.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.781.1">09876</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.782.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer284">
<span class="koboSpan" id="kobo.783.1"><img alt="Figure 13.21: Creating a new account" src="image/B21147_13_21.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.784.1">Figure 13.21: Creating a new account</span></p>
<p><span class="koboSpan" id="kobo.785.1">As we can see, in the database browser, the new password has been saved as a </span><span class="No-Break"><span class="koboSpan" id="kobo.786.1">hashing code:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer285">
<span class="koboSpan" id="kobo.787.1"><img alt="Figure 13.22: The new password in its hashing version" src="image/B21147_13_22.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.788.1">Figure 13.22: The new password in its hashing version</span></p>
<p><span class="koboSpan" id="kobo.789.1">Anybody who </span><a id="_idIndexMarker459"/><span class="koboSpan" id="kobo.790.1">gets the database file can read its content but </span><a id="_idIndexMarker460"/><span class="koboSpan" id="kobo.791.1">cannot understand what the password is since getting the plain text from the hashing is </span><span class="No-Break"><span class="koboSpan" id="kobo.792.1">quite impossible.</span></span></p>
<p><span class="koboSpan" id="kobo.793.1">Let’s try to </span><span class="No-Break"><span class="koboSpan" id="kobo.794.1">log in:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer286">
<span class="koboSpan" id="kobo.795.1"><img alt="Figure 13.23: Logging in with the new account" src="image/B21147_13_23.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.796.1">Figure 13.23: Logging in with the new account</span></p>
<p><span class="koboSpan" id="kobo.797.1">The inputted password is converted into its hash and compared with the one stored in the database; since the two hashes match, we get the </span><span class="No-Break"><span class="koboSpan" id="kobo.798.1">following result:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer287">
<span class="koboSpan" id="kobo.799.1"><img alt="Figure 13.24: The login was successful" src="image/B21147_13_24.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.800.1">Figure 13.24: The login was successful</span></p>
<p><span class="koboSpan" id="kobo.801.1">The login </span><a id="_idIndexMarker461"/><span class="koboSpan" id="kobo.802.1">process has been completed with success, and the user can access the </span><span class="No-Break"><span class="koboSpan" id="kobo.803.1">application’s tasks.</span></span></p>
<p><span class="koboSpan" id="kobo.804.1">It’s very </span><a id="_idIndexMarker462"/><span class="koboSpan" id="kobo.805.1">interesting to understand that even if the given text differs in a very small element from another, its hashing will be completely different. </span><span class="koboSpan" id="kobo.805.2">Add another account to the database, this time with a password such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.806.1">09875</span></strong><span class="koboSpan" id="kobo.807.1">, and check how different its hashing is from the one coming from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.808.1">09876</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.809.1"> password.</span></span></p>
<p><span class="koboSpan" id="kobo.810.1">This chapter was full of complex information, but the result we got is very valuable: a complete app skeleton that can be used in all our web applications that need to manage signing up, logging in, hashing, and saving data permanently in </span><span class="No-Break"><span class="koboSpan" id="kobo.811.1">a database.</span></span></p>
<p><span class="koboSpan" id="kobo.812.1">As usual, here is all the code </span><span class="No-Break"><span class="koboSpan" id="kobo.813.1">we developed:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer288">
<span class="koboSpan" id="kobo.814.1"><img alt="Figure 13.25: Signup/login skeleton – part 1" src="image/B21147_13_25.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.815.1">Figure 13.25: Signup/login skeleton – part 1</span></p>
<p><span class="koboSpan" id="kobo.816.1">In the first </span><a id="_idIndexMarker463"/><span class="koboSpan" id="kobo.817.1">part of the code, we started importing the libraries (</span><em class="italic"><span class="koboSpan" id="kobo.818.1">lines 1-5</span></em><span class="koboSpan" id="kobo.819.1">) and then </span><a id="_idIndexMarker464"/><span class="koboSpan" id="kobo.820.1">created the connection and the cursor to the database (</span><em class="italic"><span class="koboSpan" id="kobo.821.1">lines 6-7</span></em><span class="koboSpan" id="kobo.822.1">). </span><span class="koboSpan" id="kobo.822.2">After that, we imported the </span><strong class="source-inline"><span class="koboSpan" id="kobo.823.1">hashlib</span></strong><span class="koboSpan" id="kobo.824.1"> library (</span><em class="italic"><span class="koboSpan" id="kobo.825.1">line 10</span></em><span class="koboSpan" id="kobo.826.1">) and created the </span><strong class="source-inline"><span class="koboSpan" id="kobo.827.1">make_hashes</span></strong><span class="koboSpan" id="kobo.828.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.829.1">check_hashes</span></strong><span class="koboSpan" id="kobo.830.1"> functions (</span><em class="italic"><span class="koboSpan" id="kobo.831.1">lines 12</span></em><span class="koboSpan" id="kobo.832.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.833.1">15</span></em><span class="koboSpan" id="kobo.834.1">). </span><span class="koboSpan" id="kobo.834.2">On </span><em class="italic"><span class="koboSpan" id="kobo.835.1">lines 22</span></em><span class="koboSpan" id="kobo.836.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.837.1">26</span></em><span class="koboSpan" id="kobo.838.1">, we defined two functions to create new tables and add data to the database, and on </span><em class="italic"><span class="koboSpan" id="kobo.839.1">line 31</span></em><span class="koboSpan" id="kobo.840.1">, we defined the function that manages </span><span class="No-Break"><span class="koboSpan" id="kobo.841.1">user login.</span></span></p>
<p><span class="koboSpan" id="kobo.842.1">On </span><em class="italic"><span class="koboSpan" id="kobo.843.1">line 37</span></em><span class="koboSpan" id="kobo.844.1">, we defined the </span><strong class="source-inline"><span class="koboSpan" id="kobo.845.1">main</span></strong><span class="koboSpan" id="kobo.846.1"> function, introduced some HTML code just to make the app more beautiful, and implemented the </span><span class="No-Break"><span class="koboSpan" id="kobo.847.1">application menu:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer289">
<span class="koboSpan" id="kobo.848.1"><img alt="Figure 13.26: Signup/login skeleton – part 2" src="image/B21147_13_26.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.849.1">Figure 13.26: Signup/login skeleton – part 2</span></p>
<p><span class="koboSpan" id="kobo.850.1">In the second </span><a id="_idIndexMarker465"/><span class="koboSpan" id="kobo.851.1">part of the code, we managed the menu. </span><span class="koboSpan" id="kobo.851.2">So, if the </span><a id="_idIndexMarker466"/><span class="koboSpan" id="kobo.852.1">user selects </span><strong class="bold"><span class="koboSpan" id="kobo.853.1">Login</span></strong><span class="koboSpan" id="kobo.854.1">, we implement the proper code (</span><em class="italic"><span class="koboSpan" id="kobo.855.1">lines 57-74</span></em><span class="koboSpan" id="kobo.856.1">). </span><span class="koboSpan" id="kobo.856.2">When the user selects </span><strong class="bold"><span class="koboSpan" id="kobo.857.1">Sign Up</span></strong><span class="koboSpan" id="kobo.858.1">, we implement the code dedicated to this function (</span><em class="italic"><span class="koboSpan" id="kobo.859.1">lines 77-87</span></em><span class="koboSpan" id="kobo.860.1">). </span><span class="koboSpan" id="kobo.860.2">Finally, on </span><em class="italic"><span class="koboSpan" id="kobo.861.1">line 90</span></em><span class="koboSpan" id="kobo.862.1">, we have the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.863.1">About</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.864.1"> section.</span></span></p>
<p><span class="koboSpan" id="kobo.865.1">This chapter is very important because an application almost always needs to manage accounts and therefore usernames and passwords. </span><span class="koboSpan" id="kobo.865.2">To accomplish this task properly, encrypting the password very securely is </span><span class="No-Break"><span class="koboSpan" id="kobo.866.1">the key.</span></span></p>
<h1 id="_idParaDest-149"><a id="_idTextAnchor149"/><span class="koboSpan" id="kobo.867.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.868.1">In this chapter, we understood the logic behind login and signup pages and learned a very solid way of implementing and managing accounts according to the best practices </span><span class="No-Break"><span class="koboSpan" id="kobo.869.1">summarized here.</span></span></p>
<p><span class="koboSpan" id="kobo.870.1">When users sign up on our web apps, they provide a username and a password. </span><span class="koboSpan" id="kobo.870.2">The username serves as their unique identifier, while the password is a secret known only to them. </span><span class="koboSpan" id="kobo.870.3">For security, these credentials are stored in a database, but the passwords are not kept as plain text. </span><span class="koboSpan" id="kobo.870.4">Instead, they are converted into a hash, a one-way function that is easy to compute from a password but hard to reverse. </span><span class="koboSpan" id="kobo.870.5">This ensures that even if a hacker accesses the database, they can’t easily decipher </span><span class="No-Break"><span class="koboSpan" id="kobo.871.1">the passwords.</span></span></p>
<p><span class="koboSpan" id="kobo.872.1">During login, the user’s entered password is hashed and compared with the stored hash; if they match, the user is granted access. </span><span class="koboSpan" id="kobo.872.2">Storing these hashes is crucial for allowing users to log in and recover passwords. </span><span class="koboSpan" id="kobo.872.3">Although hacking these hashes is possible, it is much more difficult than cracking plain </span><span class="No-Break"><span class="koboSpan" id="kobo.873.1">text passwords.</span></span></p>
<p><span class="koboSpan" id="kobo.874.1">Implementing robust business code is the main target of any web application since by doing this, it is possible to address any kind of problem that the code is supposed to solve. </span><span class="koboSpan" id="kobo.874.2">Giving customers more beautiful interfaces, well-designed applications, and very customized tools is another key skill that a real web application designer should have. </span><span class="koboSpan" id="kobo.874.3">This is exactly what we are going to discuss in the </span><span class="No-Break"><span class="koboSpan" id="kobo.875.1">next chapter.</span></span></p>
</div>
</body></html>