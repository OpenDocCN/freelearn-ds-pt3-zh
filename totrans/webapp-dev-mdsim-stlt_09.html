<html><head></head><body>
<div id="_idContainer212">
<h1 class="chapter-number" id="_idParaDest-99"><a id="_idTextAnchor099"/><span class="koboSpan" id="kobo.1.1">9</span></h1>
<h1 id="_idParaDest-100"><a id="_idTextAnchor100"/><span class="koboSpan" id="kobo.2.1">Optimizing Streamlit Web App UX with Customization and UI Features</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In </span><a href="B21147_08.xhtml#_idTextAnchor091"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.4.1">Chapter 8</span></em></span></a><span class="koboSpan" id="kobo.5.1">, we started the development of a new web application, </span><em class="italic"><span class="koboSpan" id="kobo.6.1">Covid-19 Detection Tool</span></em><span class="koboSpan" id="kobo.7.1">. </span><span class="koboSpan" id="kobo.7.2">We have already created the virtual environment and the application skeleton, together with some basic decorations. </span><span class="koboSpan" id="kobo.7.3">It’s time now to focus on the three main sections of our new tool: </span><strong class="bold"><span class="koboSpan" id="kobo.8.1">Image Enhancement</span></strong><span class="koboSpan" id="kobo.9.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.10.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.11.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.12.1">Disclaimer </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.13.1">and Info</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.15.1">Contrast</span></strong><span class="koboSpan" id="kobo.16.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.17.1">Brightness</span></strong><span class="koboSpan" id="kobo.18.1"> are UI elements that allow users to adjust the contrast and brightness of images. </span><span class="koboSpan" id="kobo.18.2">These features can help improve the visibility and clarity of the displayed image. </span><span class="koboSpan" id="kobo.18.3">Sliders and radio buttons are widgets that allow users to interact with and manipulate data within the web app. </span><span class="koboSpan" id="kobo.18.4">Sliders allow users to set a value within a range by dragging a slider button, while radio buttons allow users to select a single option from a group of options. </span><span class="koboSpan" id="kobo.18.5">Overall, contrast, brightness, sliders, and radio buttons are powerful UI features that enable us to create very engaging and interactive web applications for COVID-19 detection. </span><span class="koboSpan" id="kobo.18.6">In the case of applications that make predictions or forecasts, such as the one we are building together, it’s always very important to add a </span><em class="italic"><span class="koboSpan" id="kobo.19.1">Disclaimer</span></em><span class="koboSpan" id="kobo.20.1"> in order to not provide any kind of wrong message to </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">the users.</span></span></p>
<p><span class="koboSpan" id="kobo.22.1">By developing these new features, we have the chance to learn how to use the more advanced techniques and skills </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">of Streamlit.</span></span></p>
<p><span class="koboSpan" id="kobo.24.1">In this chapter, we’re going to cover the following </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">main topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.26.1">Dealing with more advanced web </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">app features</span></span></li>
<li><span class="koboSpan" id="kobo.28.1">Adding the </span><strong class="bold"><span class="koboSpan" id="kobo.29.1">Image Enhancement</span></strong><span class="koboSpan" id="kobo.30.1"> section using the </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">Pillow library</span></span></li>
<li><span class="koboSpan" id="kobo.32.1">Adding the </span><strong class="bold"><span class="koboSpan" id="kobo.33.1">Disclaimer and </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.34.1">Info</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.35.1"> section</span></span></li>
</ul>
<h1 id="_idParaDest-101"><a id="_idTextAnchor101"/><span class="koboSpan" id="kobo.36.1">Technical requirements</span></h1>
<ul>
<li><span class="koboSpan" id="kobo.37.1">In this chapter, we’ll use the following libraries, packages, </span><span class="No-Break"><span class="koboSpan" id="kobo.38.1">and tools:</span></span><ul><li><span class="No-Break"><span class="koboSpan" id="kobo.39.1">Sublime Text</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.40.1">Python 3</span></span></li><li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.41.1">pipenv</span></strong></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.42.1">Streamlit</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.43.1">Pillow</span></span></li><li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.44.1">numpy</span></strong></span></li></ul></li>
<li><span class="koboSpan" id="kobo.45.1">The code in the chapter can be accessed through the following GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.46.1">link: </span></span><a href="https://github.com/PacktPublishing/Web-App-Development-Made-Simple-with-Streamlit/tree/f1bd9c354072092c268f27621680c858ce93c823/Chapter09"><span class="No-Break"><span class="koboSpan" id="kobo.47.1">https://github.com/PacktPublishing/Web-App-Development-Made-Simple-with-Streamlit/tree/f1bd9c354072092c268f27621680c858ce93c823/Chapter09</span></span></a></li>
</ul>
<h1 id="_idParaDest-102"><a id="_idTextAnchor102"/><span class="koboSpan" id="kobo.48.1">Dealing with more advanced web app features</span></h1>
<p><span class="koboSpan" id="kobo.49.1">In </span><a href="B21147_08.xhtml#_idTextAnchor091"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.50.1">Chapter 8</span></em></span></a><span class="koboSpan" id="kobo.51.1">, we stopped our </span><a id="_idIndexMarker322"/><span class="koboSpan" id="kobo.52.1">development at the point shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.53.1">following figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer194">
<span class="koboSpan" id="kobo.54.1"><img alt="Figure 9.1: Chapter09 starting point" src="image/B21147_09_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.55.1">Figure 9.1: Chapter09 starting point</span></p>
<p><span class="koboSpan" id="kobo.56.1">So, let’s start </span><a id="_idIndexMarker323"/><span class="koboSpan" id="kobo.57.1">working on the menu’s three voices: </span><strong class="bold"><span class="koboSpan" id="kobo.58.1">Image Enhancement</span></strong><span class="koboSpan" id="kobo.59.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.60.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.61.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.62.1">Disclaimer and Info</span></strong><span class="koboSpan" id="kobo.63.1">. </span><span class="koboSpan" id="kobo.63.2">Before that, since we are entering some advanced features of Streamlit and considering that new versions </span><a id="_idIndexMarker324"/><span class="koboSpan" id="kobo.64.1">are released quite often, it’s very important to remember how Streamlit’s official documentation (</span><a href="https://docs.streamlit.io/"><span class="koboSpan" id="kobo.65.1">https://docs.streamlit.io/</span></a><span class="koboSpan" id="kobo.66.1">) is always the best place to get detailed info about all the available components and APIs; for example, in case you have any doubts about, let’s say, the </span><strong class="bold"><span class="koboSpan" id="kobo.67.1">Image</span></strong><span class="koboSpan" id="kobo.68.1"> widget, you can just search for it in the </span><strong class="bold"><span class="koboSpan" id="kobo.69.1">API reference</span></strong><span class="koboSpan" id="kobo.70.1"> menu on the left side of the official documentation page or directly in the search bar in the top-right corner and check out all </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">the results.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer195">
<span class="koboSpan" id="kobo.72.1"><img alt="Figure 9.2: Streamlit’s official documentation" src="image/B21147_09_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.73.1">Figure 9.2: Streamlit’s official documentation</span></p>
<p><span class="koboSpan" id="kobo.74.1">Let’s open </span><a id="_idIndexMarker325"/><span class="koboSpan" id="kobo.75.1">our code in Sublime Text and let’s continue with our development since, at the moment, we have only an </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">empty menu.</span></span></p>
<p><span class="koboSpan" id="kobo.77.1">We have already defined a list of voices for our menu, which is called </span><strong class="source-inline"><span class="koboSpan" id="kobo.78.1">activities</span></strong><span class="koboSpan" id="kobo.79.1">, and an </span><strong class="source-inline"><span class="koboSpan" id="kobo.80.1">if</span></strong><span class="koboSpan" id="kobo.81.1"> clause that checks which of these voices has been selected and put in a variable named </span><strong class="source-inline"><span class="koboSpan" id="kobo.82.1">choice</span></strong><span class="koboSpan" id="kobo.83.1">; our job now is to write the business logic for each one of these </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">three possibilities:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer196">
<span class="koboSpan" id="kobo.85.1"><img alt="Figure 9.3: The points where the business logic has to be inserted" src="image/B21147_09_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.86.1">Figure 9.3: The points where the business logic has to be inserted</span></p>
<p><span class="koboSpan" id="kobo.87.1">We know very well that </span><strong class="source-inline"><span class="koboSpan" id="kobo.88.1">pass</span></strong><span class="koboSpan" id="kobo.89.1"> is just a placeholder, so we can start our coding from the first one of the menu voices: </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.90.1">Image Enhancement</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.92.1">Images can be </span><a id="_idIndexMarker326"/><span class="koboSpan" id="kobo.93.1">enhanced in many ways – for example, by changing their brightness or contrast. </span><span class="koboSpan" id="kobo.93.2">So we can use some radio buttons in the sidebar to give the user the faculty to choose what kind of enhancement they want </span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">to perform.</span></span></p>
<p><span class="koboSpan" id="kobo.95.1">The radio buttons, as we should know, have a couple of mandatory arguments: a label (a title) and a list of all the items that can </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">be selected:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer197">
<span class="koboSpan" id="kobo.97.1"><img alt="Figure 9.4: Radio button for Image Enhancement" src="image/B21147_09_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.98.1">Figure 9.4: Radio button for Image Enhancement</span></p>
<p><span class="koboSpan" id="kobo.99.1">As usual, the list of items in the radio button contains all the features we want to show on </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">the screen:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer198">
<span class="koboSpan" id="kobo.101.1"><img alt="Figure 9.5: Radio button in the browser" src="image/B21147_09_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.102.1">Figure 9.5: Radio button in the browser</span></p>
<p><span class="koboSpan" id="kobo.103.1">It’s quite </span><a id="_idIndexMarker327"/><span class="koboSpan" id="kobo.104.1">clear that now we need some </span><strong class="source-inline"><span class="koboSpan" id="kobo.105.1">if</span></strong><span class="koboSpan" id="kobo.106.1"> clauses. </span><span class="koboSpan" id="kobo.106.2">This is because if the </span><strong class="source-inline"><span class="koboSpan" id="kobo.107.1">enhance_type</span></strong><span class="koboSpan" id="kobo.108.1"> variable is </span><strong class="source-inline"><span class="koboSpan" id="kobo.109.1">Original</span></strong><span class="koboSpan" id="kobo.110.1">, we need to do something; if it’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.111.1">Contrast</span></strong><span class="koboSpan" id="kobo.112.1">, we need to do something different, and if it’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.113.1">Brightness</span></strong><span class="koboSpan" id="kobo.114.1">, we need to do </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">something else:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer199">
<span class="koboSpan" id="kobo.116.1"><img alt="Figure 9.6: If clauses for “Image Enhancement”" src="image/B21147_09_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.117.1">Figure 9.6: If clauses for “Image Enhancement”</span></p>
<p><span class="koboSpan" id="kobo.118.1">As already said, </span><strong class="source-inline"><span class="koboSpan" id="kobo.119.1">pass</span></strong><span class="koboSpan" id="kobo.120.1"> is just a placeholder, so let’s take care of these </span><strong class="source-inline"><span class="koboSpan" id="kobo.121.1">if</span></strong><span class="koboSpan" id="kobo.122.1"> clauses one by one. </span><span class="koboSpan" id="kobo.122.2">The first one </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">is </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">Contrast</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.125.1">.</span></span></p>
<h1 id="_idParaDest-103"><a id="_idTextAnchor103"/><span class="koboSpan" id="kobo.126.1">Adding the Image Enhancement section using the Pillow library</span></h1>
<p><span class="koboSpan" id="kobo.127.1">Among the </span><a id="_idIndexMarker328"/><span class="koboSpan" id="kobo.128.1">libraries we imported </span><a id="_idIndexMarker329"/><span class="koboSpan" id="kobo.129.1">at the beginning, there is </span><strong class="bold"><span class="koboSpan" id="kobo.130.1">Pillow</span></strong><span class="koboSpan" id="kobo.131.1">. </span><span class="koboSpan" id="kobo.131.2">It contains a module named </span><strong class="source-inline"><span class="koboSpan" id="kobo.132.1">ImageEnhance</span></strong><span class="koboSpan" id="kobo.133.1"> that can actually take care of all the features related to any kind of image enhancement for us. </span><span class="koboSpan" id="kobo.133.2">This means that we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.134.1">Contrast</span></strong><span class="koboSpan" id="kobo.135.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.136.1">Brightness</span></strong><span class="koboSpan" id="kobo.137.1"> methods already included in Pillow’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.138.1">ImageEnhance</span></strong><span class="koboSpan" id="kobo.139.1"> module because all the functions we need, and many others, have been already implemented </span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">for us.</span></span></p>
<p><span class="koboSpan" id="kobo.141.1">Pillow, or </span><strong class="bold"><span class="koboSpan" id="kobo.142.1">Python Imaging Library</span></strong><span class="koboSpan" id="kobo.143.1">, is a </span><a id="_idIndexMarker330"/><span class="koboSpan" id="kobo.144.1">very powerful library and it can do more than the things we are showing in this book. </span><span class="koboSpan" id="kobo.144.2">For this reason, we suggest taking a look at its official page on PyPI (</span><a href="https://pypi.org/project/Pillow/"><span class="koboSpan" id="kobo.145.1">https://pypi.org/project/Pillow/</span></a><span class="koboSpan" id="kobo.146.1">) and reading all the documentation </span><span class="No-Break"><span class="koboSpan" id="kobo.147.1">contained there.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer200">
<span class="koboSpan" id="kobo.148.1"><img alt="Figure 9.7: The Pillow page on PyPI" src="image/B21147_09_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.149.1">Figure 9.7: The Pillow page on PyPI</span></p>
<p><span class="koboSpan" id="kobo.150.1">Let’s </span><a id="_idIndexMarker331"/><span class="koboSpan" id="kobo.151.1">start </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.153.1">Contrast</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">.</span></span></p>
<h2 id="_idParaDest-104"><a id="_idTextAnchor104"/><span class="koboSpan" id="kobo.155.1">Contrast</span></h2>
<p><span class="koboSpan" id="kobo.156.1">As </span><a id="_idIndexMarker332"/><span class="koboSpan" id="kobo.157.1">shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.158.1">Figure 9</span></em></span><em class="italic"><span class="koboSpan" id="kobo.159.1">.8</span></em><span class="koboSpan" id="kobo.160.1">, managing </span><strong class="source-inline"><span class="koboSpan" id="kobo.161.1">Contrast</span></strong><span class="koboSpan" id="kobo.162.1"> with Pillow’s methods is really </span><span class="No-Break"><span class="koboSpan" id="kobo.163.1">very simple:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer201">
<span class="koboSpan" id="kobo.164.1"><img alt="Figure 9.8: The Contrast feature" src="image/B21147_09_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.165.1">Figure 9.8: The Contrast feature</span></p>
<p><span class="koboSpan" id="kobo.166.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.167.1">if</span></strong><span class="koboSpan" id="kobo.168.1"> case immediately after the subheader, we start by adding a </span><em class="italic"><span class="koboSpan" id="kobo.169.1">slider</span></em><span class="koboSpan" id="kobo.170.1">. </span><span class="koboSpan" id="kobo.170.2">The values on this slider go from </span><strong class="source-inline"><span class="koboSpan" id="kobo.171.1">0.5</span></strong><span class="koboSpan" id="kobo.172.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.173.1">5.0</span></strong><span class="koboSpan" id="kobo.174.1">; you can play with this range to check the </span><span class="No-Break"><span class="koboSpan" id="kobo.175.1">different behaviors.</span></span></p>
<p><span class="koboSpan" id="kobo.176.1">After adding </span><a id="_idIndexMarker333"/><span class="koboSpan" id="kobo.177.1">the slider, we need to instantiate an </span><strong class="source-inline"><span class="koboSpan" id="kobo.178.1">ImageEnhance.Contrast</span></strong><span class="koboSpan" id="kobo.179.1"> object using the image we opened previously (</span><strong class="source-inline"><span class="koboSpan" id="kobo.180.1">our_image</span></strong><span class="koboSpan" id="kobo.181.1">) with </span><strong class="source-inline"><span class="koboSpan" id="kobo.182.1">file_uploader</span></strong><span class="koboSpan" id="kobo.183.1">. </span><span class="koboSpan" id="kobo.183.2">Then, we apply the </span><strong class="source-inline"><span class="koboSpan" id="kobo.184.1">enhance</span></strong><span class="koboSpan" id="kobo.185.1"> method to this image with the value selected by using </span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">the slider.</span></span></p>
<p><span class="koboSpan" id="kobo.187.1">Finally, the result is printed on the screen thanks to </span><strong class="source-inline"><span class="koboSpan" id="kobo.188.1">st.image</span></strong><span class="koboSpan" id="kobo.189.1">, one of Streamlit’s </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">classic widgets.</span></span></p>
<p><span class="koboSpan" id="kobo.191.1">This is the result from the </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">browser’s perspective:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer202">
<span class="koboSpan" id="kobo.193.1"><img alt="Figure 9.9: The Contrast feature in action" src="image/B21147_09_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.194.1">Figure 9.9: The Contrast feature in action</span></p>
<p><span class="koboSpan" id="kobo.195.1">It gives a </span><a id="_idIndexMarker334"/><span class="koboSpan" id="kobo.196.1">very nice result, and managing this kind of image enhancement with Pillow is really </span><span class="No-Break"><span class="koboSpan" id="kobo.197.1">very easy.</span></span></p>
<p><span class="koboSpan" id="kobo.198.1">As we just saw, Pillow contains the </span><strong class="source-inline"><span class="koboSpan" id="kobo.199.1">Contrast</span></strong><span class="koboSpan" id="kobo.200.1"> function out of the box. </span><span class="koboSpan" id="kobo.200.2">So, it’s quite obvious to imagine that it contains a </span><strong class="source-inline"><span class="koboSpan" id="kobo.201.1">Brightness</span></strong><span class="koboSpan" id="kobo.202.1"> function </span><span class="No-Break"><span class="koboSpan" id="kobo.203.1">as well.</span></span></p>
<h2 id="_idParaDest-105"><a id="_idTextAnchor105"/><span class="koboSpan" id="kobo.204.1">Brightness</span></h2>
<p><span class="koboSpan" id="kobo.205.1">In fact, the </span><a id="_idIndexMarker335"/><span class="koboSpan" id="kobo.206.1">code we need to write for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.207.1">Brightness</span></strong><span class="koboSpan" id="kobo.208.1"> feature is more or less the same as that for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.209.1">Contrast</span></strong><span class="koboSpan" id="kobo.210.1"> feature. </span><span class="koboSpan" id="kobo.210.2">We can type </span><span class="No-Break"><span class="koboSpan" id="kobo.211.1">the following:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer203">
<span class="koboSpan" id="kobo.212.1"><img alt="Figure 9.10: The Brightness feature" src="image/B21147_09_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.213.1">Figure 9.10: The Brightness feature</span></p>
<p><span class="koboSpan" id="kobo.214.1">The preceding </span><a id="_idIndexMarker336"/><span class="koboSpan" id="kobo.215.1">code is exactly the same as the code we wrote for </span><strong class="source-inline"><span class="koboSpan" id="kobo.216.1">Contrast</span></strong><span class="koboSpan" id="kobo.217.1">, but this time, we are using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">ImageEnhance.Brightness</span></strong><span class="koboSpan" id="kobo.219.1"> method instead of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">ImageEnhance.Contrast</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.221.1"> method.</span></span></p>
<p><span class="koboSpan" id="kobo.222.1">So, once again, we set a value for the brightness using a slider, create an </span><strong class="source-inline"><span class="koboSpan" id="kobo.223.1">enhancer</span></strong><span class="koboSpan" id="kobo.224.1"> object from the image opened thanks to </span><strong class="source-inline"><span class="koboSpan" id="kobo.225.1">file_uploader</span></strong><span class="koboSpan" id="kobo.226.1">, apply the brightness to this image, and print the result on </span><span class="No-Break"><span class="koboSpan" id="kobo.227.1">the screen.</span></span></p>
<p><span class="koboSpan" id="kobo.228.1">This is the result in our </span><span class="No-Break"><span class="koboSpan" id="kobo.229.1">web application:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer204">
<span class="koboSpan" id="kobo.230.1"><img alt="Figure 9.11: The Brightness feature in action" src="image/B21147_09_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.231.1">Figure 9.11: The Brightness feature in action</span></p>
<p><span class="koboSpan" id="kobo.232.1">In both cases, </span><strong class="source-inline"><span class="koboSpan" id="kobo.233.1">Brightness</span></strong><span class="koboSpan" id="kobo.234.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.235.1">Contrast</span></strong><span class="koboSpan" id="kobo.236.1">, you can change the strength of the effect by selecting </span><a id="_idIndexMarker337"/><span class="koboSpan" id="kobo.237.1">different values using the slider, and if you don’t like the outcome, you can always change the range that we set as </span><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">0.5</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.239.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.240.1">5.0</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.242.1">The final option we can select using the radio button </span><span class="No-Break"><span class="koboSpan" id="kobo.243.1">is </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.244.1">Original</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.245.1">.</span></span></p>
<h2 id="_idParaDest-106"><a id="_idTextAnchor106"/><span class="koboSpan" id="kobo.246.1">Original</span></h2>
<p><span class="koboSpan" id="kobo.247.1">In the </span><a id="_idIndexMarker338"/><span class="koboSpan" id="kobo.248.1">case of the </span><strong class="bold"><span class="koboSpan" id="kobo.249.1">Original</span></strong><span class="koboSpan" id="kobo.250.1"> voice, things are very easy since we don’t need sliders and values as in the case of </span><strong class="bold"><span class="koboSpan" id="kobo.251.1">Brightness</span></strong><span class="koboSpan" id="kobo.252.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.253.1">Contrast</span></strong><span class="koboSpan" id="kobo.254.1">, and we don’t need to modify anything. </span><span class="koboSpan" id="kobo.254.2">We just need to get the image we opened with </span><strong class="source-inline"><span class="koboSpan" id="kobo.255.1">file_uploader</span></strong><span class="koboSpan" id="kobo.256.1"> and show it on the screen. </span><span class="koboSpan" id="kobo.256.2">The code is </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer205">
<span class="koboSpan" id="kobo.258.1"><img alt="Figure 9.12: The Original Image feature" src="image/B21147_09_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.259.1">Figure 9.12: The Original Image feature</span></p>
<p><span class="koboSpan" id="kobo.260.1">If you want, you can try to set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.261.1">use_column_width</span></strong><span class="koboSpan" id="kobo.262.1"> argument in </span><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">st.image</span></strong><span class="koboSpan" id="kobo.264.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.265.1">False</span></strong><span class="koboSpan" id="kobo.266.1"> and check </span><a id="_idIndexMarker339"/><span class="koboSpan" id="kobo.267.1">the result, or, if you prefer, you can specify a width size different </span><span class="No-Break"><span class="koboSpan" id="kobo.268.1">from </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">600</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.270.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.271.1">This is the effect in </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">the browser:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer206">
<span class="koboSpan" id="kobo.273.1"><img alt="Figure 9.13: The Original Image feature in action" src="image/B21147_09_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.274.1">Figure 9.13: The Original Image feature in action</span></p>
<p><span class="koboSpan" id="kobo.275.1">With the </span><strong class="bold"><span class="koboSpan" id="kobo.276.1">Original</span></strong><span class="koboSpan" id="kobo.277.1"> image feature, we can consider the </span><strong class="bold"><span class="koboSpan" id="kobo.278.1">Image Enhancement</span></strong><span class="koboSpan" id="kobo.279.1"> voice of the menu completed. </span><span class="koboSpan" id="kobo.279.2">Thanks to the Pillow library, we could implement all features of this voice </span><a id="_idIndexMarker340"/><span class="koboSpan" id="kobo.280.1">in a very smooth way. </span><span class="koboSpan" id="kobo.280.2">This is one of the best aspects of Python, and you can always find a nice package that already has all the features </span><span class="No-Break"><span class="koboSpan" id="kobo.281.1">you need!</span></span></p>
<p><span class="koboSpan" id="kobo.282.1">Let’s move on to the </span><strong class="bold"><span class="koboSpan" id="kobo.283.1">Disclaimer and Info</span></strong><span class="koboSpan" id="kobo.284.1"> section. </span><span class="koboSpan" id="kobo.284.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.285.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.286.1"> section is a little bit more complex, so we will leave that for the </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">next chapter.</span></span></p>
<h1 id="_idParaDest-107"><a id="_idTextAnchor107"/><span class="koboSpan" id="kobo.288.1">Adding the Disclaimer and Info section</span></h1>
<p><span class="koboSpan" id="kobo.289.1">Dealing with applications that provide predictions, especially health predictions, can be a little bit </span><a id="_idIndexMarker341"/><span class="koboSpan" id="kobo.290.1">dangerous, so a good practice is to write down a disclaimer to avoid any kind </span><span class="No-Break"><span class="koboSpan" id="kobo.291.1">of misunderstanding.</span></span></p>
<p><span class="koboSpan" id="kobo.292.1">The disclaimer of this web application, named </span><strong class="bold"><span class="koboSpan" id="kobo.293.1">Disclaimer and Info</span></strong><span class="koboSpan" id="kobo.294.1">, also serves the function of providing some information about the model used to predict COVID-19 from images and about the dataset that was used to train </span><span class="No-Break"><span class="koboSpan" id="kobo.295.1">that model.</span></span></p>
<p><span class="koboSpan" id="kobo.296.1">In short, the main purpose of the disclaimer is to clarify that the application is just a demo of Streamlit’s capabilities and doesn’t have any value from a medical point of view. </span><span class="koboSpan" id="kobo.296.2">Additionally, the disclaimer also contains some information about the AI model used to make </span><span class="No-Break"><span class="koboSpan" id="kobo.297.1">the predictions.</span></span></p>
<p><span class="koboSpan" id="kobo.298.1">In </span><a href="B21147_10.xhtml#_idTextAnchor109"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.299.1">Chapter 10</span></em></span></a><span class="koboSpan" id="kobo.300.1">, we will see that every time we need to make predictions, a good strategy is to use a machine </span><span class="No-Break"><span class="koboSpan" id="kobo.301.1">learning model.</span></span></p>
<p><span class="koboSpan" id="kobo.302.1">In particular, the model </span><a id="_idIndexMarker342"/><span class="koboSpan" id="kobo.303.1">used in our web application is a so-called </span><strong class="bold"><span class="koboSpan" id="kobo.304.1">convolutional neural network</span></strong><span class="koboSpan" id="kobo.305.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.306.1">CNN</span></strong><span class="koboSpan" id="kobo.307.1">) developed using the library named </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">tensorflow</span></strong><span class="koboSpan" id="kobo.309.1"> and using a dataset comprising 206 images of affected people and 206 images of </span><span class="No-Break"><span class="koboSpan" id="kobo.310.1">healthy individuals.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.311.1">Additional information</span></p>
<p class="callout"><span class="koboSpan" id="kobo.312.1">CNNs are particular neural network architectures that perform very well with problems related to images, such as image classification. </span><span class="koboSpan" id="kobo.312.2">What we want to do with this application is precisely the classification of images, specifically X-ray images of the chest, to discover whether or not they show cases of COVID-19. </span><span class="koboSpan" id="kobo.312.3">Discovering whether or not a given image represents a COVID-19 case is a classic problem of binary classification, which means understanding whether something is true or false. </span><span class="koboSpan" id="kobo.312.4">CNNs are very good classifiers for this type of task. </span><span class="koboSpan" id="kobo.312.5">However, for better performance, they need a large number of images, so a big dataset is required to train </span><span class="No-Break"><span class="koboSpan" id="kobo.313.1">these models.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.314.1">The CNN we used performs quite well, even if it was trained with a limited number of images. </span><span class="koboSpan" id="kobo.314.2">The model performs well when classifying images representing COVID-19 cases and healthy individuals, but its predictive performance is poor for images representing SARS cases (SARS is rather close </span><span class="No-Break"><span class="koboSpan" id="kobo.315.1">to </span></span><span class="No-Break"><span class="koboSpan" id="kobo.316.1">Covid-19</span></span><span class="No-Break"><span class="koboSpan" id="kobo.317.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.318.1">The disclaimer </span><a id="_idIndexMarker343"/><span class="koboSpan" id="kobo.319.1">has to be inserted in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">else</span></strong><span class="koboSpan" id="kobo.321.1"> part of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">if</span></strong><span class="koboSpan" id="kobo.323.1"> clause related to the menu, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.324.1">following figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer207">
<span class="koboSpan" id="kobo.325.1"><img alt="Figure 9.14: The insertion point of the disclaimer" src="image/B21147_09_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.326.1">Figure 9.14: The insertion point of the disclaimer</span></p>
<p><span class="koboSpan" id="kobo.327.1">We can decide to write this disclaimer in many ways, but a very easy one is just to use some </span><strong class="source-inline"><span class="koboSpan" id="kobo.328.1">st.write</span></strong><span class="koboSpan" id="kobo.329.1"> objects. </span><span class="koboSpan" id="kobo.329.2">In this way, we can have very clear, well-presented, formatted text, and we can </span><a id="_idIndexMarker344"/><span class="koboSpan" id="kobo.330.1">add links to some websites that can be used as references. </span><span class="koboSpan" id="kobo.330.2">We are using the </span><strong class="bold"><span class="koboSpan" id="kobo.331.1">Markdown</span></strong><span class="koboSpan" id="kobo.332.1"> syntax, so it’s possible to use bold, italics, bullet points, lists, and </span><span class="No-Break"><span class="koboSpan" id="kobo.333.1">so on.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.334.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.335.1">The websites linked in the text are real websites that inspired the author to create this tool during the first COVID-19 lockdown. </span><span class="koboSpan" id="kobo.335.2">If you want to check them out, they are </span><span class="No-Break"><span class="koboSpan" id="kobo.336.1">quite interesting!</span></span></p>
<p><span class="koboSpan" id="kobo.337.1">Here is the code we can use to add </span><span class="No-Break"><span class="koboSpan" id="kobo.338.1">the disclaimer:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer208">
<span class="koboSpan" id="kobo.339.1"><img alt="Figure 9.15: The code used for the Disclaimer section" src="image/B21147_09_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.340.1">Figure 9.15: The code used for the Disclaimer section</span></p>
<p><span class="koboSpan" id="kobo.341.1">Actually, this code is just a proposal. </span><span class="koboSpan" id="kobo.341.2">You don’t need to copy it in your version of the </span><em class="italic"><span class="koboSpan" id="kobo.342.1">COVID-19 Detection Tool</span></em><span class="koboSpan" id="kobo.343.1"> web application. </span><span class="koboSpan" id="kobo.343.2">You can modify it as you like, and if you decide to use </span><a id="_idIndexMarker345"/><span class="koboSpan" id="kobo.344.1">another model to make the predictions (nowadays, it’s quite easy to find several pretrained models online, for example, </span><a href="https://ieeexplore.ieee.org/document/9340145"><span class="koboSpan" id="kobo.345.1">https://ieeexplore.ieee.org/document/9340145</span></a><span class="koboSpan" id="kobo.346.1"> or </span><a href="https://www.nature.com/articles/s41598-023-33685-z"><span class="koboSpan" id="kobo.347.1">https://www.nature.com/articles/s41598-023-33685-z</span></a><span class="koboSpan" id="kobo.348.1">), you can insert the information about your own version and your new model, together with an explanation about its performances </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">and accuracy.</span></span></p>
<p><span class="koboSpan" id="kobo.350.1">Here’s the </span><strong class="bold"><span class="koboSpan" id="kobo.351.1">Disclaimer</span></strong><span class="koboSpan" id="kobo.352.1"> section for my version of </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">the app:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer209">
<span class="koboSpan" id="kobo.354.1"><img alt="Figure 9.16: The ﻿disclaimer in the browser" src="image/B21147_09_16.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.355.1">Figure 9.16: The disclaimer in the browser</span></p>
<p><span class="koboSpan" id="kobo.356.1">The result </span><a id="_idIndexMarker346"/><span class="koboSpan" id="kobo.357.1">is very clean and neat because we used headers, bold, lists with bullet points, and hyperlinks to </span><span class="No-Break"><span class="koboSpan" id="kobo.358.1">external websites.</span></span></p>
<p><span class="koboSpan" id="kobo.359.1">As usual, let’s print the code we have implemented up to now in order to be sure that everything for our web application is written correctly </span><span class="No-Break"><span class="koboSpan" id="kobo.360.1">without mistakes:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer210">
<span class="koboSpan" id="kobo.361.1"><img alt="Figure 9.17: The first part of the code" src="image/B21147_09_17.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.362.1">Figure 9.17: The first part of the code</span></p>
<p><span class="koboSpan" id="kobo.363.1">To recap, in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.364.1">Figure 9</span></em></span><em class="italic"><span class="koboSpan" id="kobo.365.1">.17</span></em><span class="koboSpan" id="kobo.366.1">, we have the first part of the code, where we import all the relevant </span><a id="_idIndexMarker347"/><span class="koboSpan" id="kobo.367.1">libraries, set up the page title and icon, define the </span><strong class="source-inline"><span class="koboSpan" id="kobo.368.1">main</span></strong><span class="koboSpan" id="kobo.369.1"> function, and inside it, we put an image in the sidebar together with the menu of </span><span class="No-Break"><span class="koboSpan" id="kobo.370.1">the app.</span></span></p>
<p><span class="koboSpan" id="kobo.371.1">This menu contains three voices: </span><strong class="bold"><span class="koboSpan" id="kobo.372.1">Image Enhancement</span></strong><span class="koboSpan" id="kobo.373.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.374.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.375.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.376.1">Disclaimer and Info</span></strong><span class="koboSpan" id="kobo.377.1">. </span><span class="koboSpan" id="kobo.377.2">Inside </span><strong class="bold"><span class="koboSpan" id="kobo.378.1">Image Enhancement</span></strong><span class="koboSpan" id="kobo.379.1">, we can select between three options: </span><strong class="bold"><span class="koboSpan" id="kobo.380.1">Original</span></strong><span class="koboSpan" id="kobo.381.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.382.1">Contrast</span></strong><span class="koboSpan" id="kobo.383.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.384.1">and </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.385.1">Brightness</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer211">
<span class="koboSpan" id="kobo.387.1"><img alt="Figure 9.18: The second part of the code" src="image/B21147_09_18.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.388.1">Figure 9.18: The second part of the code</span></p>
<p><span class="koboSpan" id="kobo.389.1">In the </span><a id="_idIndexMarker348"/><span class="koboSpan" id="kobo.390.1">second part of the code, shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.391.1">Figure 9</span></em></span><em class="italic"><span class="koboSpan" id="kobo.392.1">.18</span></em><span class="koboSpan" id="kobo.393.1">, we complete the </span><strong class="bold"><span class="koboSpan" id="kobo.394.1">Disclaimer and Info</span></strong><span class="koboSpan" id="kobo.395.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.396.1">About the Author</span></strong><span class="koboSpan" id="kobo.397.1"> sections, while we leave the </span><strong class="bold"><span class="koboSpan" id="kobo.398.1">Diagnosis</span></strong><span class="koboSpan" id="kobo.399.1"> part blank </span><span class="No-Break"><span class="koboSpan" id="kobo.400.1">for now.</span></span></p>
<h1 id="_idParaDest-108"><a id="_idTextAnchor108"/><span class="koboSpan" id="kobo.401.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.402.1">In this chapter, we have completed two of the three voices composing the menu of our </span><em class="italic"><span class="koboSpan" id="kobo.403.1">COVID-19 Detection Tool</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.404.1">web application.</span></span></p>
<p><span class="koboSpan" id="kobo.405.1">To deal with the </span><strong class="bold"><span class="koboSpan" id="kobo.406.1">Image Enhancement</span></strong><span class="koboSpan" id="kobo.407.1"> voice, we leveraged the Pillow library, which is a very powerful library that makes it possible to manage some quite powerful functions, such as image contrast and brightness, with very few lines </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">of code.</span></span></p>
<p><span class="koboSpan" id="kobo.409.1">We also created multiple selections for the user, adopting radio buttons and </span><strong class="source-inline"><span class="koboSpan" id="kobo.410.1">if</span></strong><span class="koboSpan" id="kobo.411.1"> clauses. </span><span class="koboSpan" id="kobo.411.2">Radio buttons are a very clean and powerful way to propose selections, and there is no way to put any kind of ambiguity in </span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">the process.</span></span></p>
<p><span class="koboSpan" id="kobo.413.1">Using sliders in combination with image visualization is a powerful tool to adjust various parameters, such as contrast and brightness. </span><span class="koboSpan" id="kobo.413.2">Sliders provide the user with the ability to precisely and continuously select the desired value for any </span><span class="No-Break"><span class="koboSpan" id="kobo.414.1">given parameter.</span></span></p>
<p><span class="koboSpan" id="kobo.415.1">Another important trick to underline is that every time we modified images (for example, to perform brightness adjustments), we worked on their copies and not on the original image. </span><span class="koboSpan" id="kobo.415.2">In this way, it was quite simple to move back to the original situation just showing the image that was loaded thanks </span><span class="No-Break"><span class="koboSpan" id="kobo.416.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.417.1">file_uploader</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.418.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.419.1">We also learned how well-formatted text that leverages the Markdown syntax can be full of information to the user – for example, to show the technologies used and the sources and documents of inspiration. </span><span class="koboSpan" id="kobo.419.2">For sure, this clean and nicely formatted text is the perfect way to create disclaimers to avoid any </span><span class="No-Break"><span class="koboSpan" id="kobo.420.1">future problems.</span></span></p>
<p><span class="koboSpan" id="kobo.421.1">In the next chapter, we will learn how to integrate artificial intelligence and machine learning models into our </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">web applications.</span></span></p>
</div>
</body></html>