<html><head></head><body>
  <div id="_idContainer405">
    <h1 class="chapterNumber">9</h1>
    <h1 id="_idParaDest-185" class="chapterTitle">Visual Analytics – Trends, Clustering, Distributions, and Forecasting</h1>
    <p class="normal">The rapid visual analysis that is possible using Tableau is incredibly useful for answering numerous questions and making key decisions. But it barely scratches the surface of the possible analysis. For example, a simple scatterplot can reveal outliers, but often, you want to understand the distribution or identify clusters of similar observations. A simple time series helps you to see the rise and fall of a measure over time, but often, you want to see the trend or make predictions for future values.</p>
    <p class="normal">Tableau enables you to quickly enhance your data visualizations with statistical analysis. Built-in features such as trend models, clustering, distributions, and forecasting allow you to quickly add value to your visual analysis. Additionally, Tableau integrates with the R and Python platforms, which opens endless options for the manipulation and analysis of your data.</p>
    <p class="normal">This chapter will cover the built-in statistical models and analysis, including the following topics:</p>
    <ul>
      <li class="list">Trends</li>
      <li class="list">Clustering</li>
      <li class="list">Distributions</li>
      <li class="list">Forecasting</li>
    </ul>
    <p class="normal">We'll look at these concepts in the context of a few examples using some sample datasets. You can follow and reproduce these examples using the <code class="Code-In-Text--PACKT-">Chapter 9</code> workbook.</p>
    <p class="normal">When analyzing data that changes over time, understanding the overall nature of change is vitally important. Seeing and understanding trends is where we'll begin.</p>
    <h1 id="_idParaDest-186" class="title">Trends</h1>
    <p class="normal"><code class="Code-In-Text--PACKT-">World Population.xlsx</code> is included in the <code class="Code-In-Text--PACKT-">Chapter 09</code> directory. It contains one record for each country for <a id="_idIndexMarker815"/><a id="_idIndexMarker816"/>each year from <strong class="screen-text">1960</strong> to <strong class="screen-text">2015</strong>, measuring population. Using this dataset, let's take a look at the historical trends of various countries. Create a view similar to the one shown in the following screenshot, which shows the change in population over time for <strong class="screen-text">Afghanistan</strong> and <strong class="screen-text">Australia</strong>. You'll notice that <strong class="screen-text">Country Name</strong> has been filtered to include only <strong class="screen-text">Afghanistan</strong> and <strong class="screen-text">Australia</strong> and the field has additionally been added to the <strong class="screen-text">Color</strong> and <strong class="screen-text">Label</strong> shelves:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_01.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.1: Population values for Afghanistan and Australia over time</p>
    <p class="normal">From this visualization alone, you can make several interesting observations. The growth of the two countries' populations was fairly similar up to <strong class="screen-text">1980</strong>. At that point, the population of Afghanistan went into decline until <strong class="screen-text">1988</strong>, when it started to increase. At some point around <strong class="screen-text">1996</strong>, the population of Afghanistan exceeded that of Australia. The gap has grown wider ever since.</p>
    <p class="normal">While we have a sense of the two trends, they become even more obvious when we see the trend lines. Tableau offers several ways of adding trend lines:</p>
    <ul>
      <li class="list">From the menu, select <strong class="screen-text">Analysis</strong> | <strong class="screen-text">Trend Lines</strong> | <strong class="screen-text">Show Trend Lines</strong>.</li>
      <li class="list">Right-click on an empty area in the pane of the view and select <strong class="screen-text">Show Trend Lines</strong>.</li>
      <li class="list">Click on the <strong class="screen-text">Analytics</strong> tab on the left-hand sidebar to switch to the <strong class="screen-text">Analytics</strong> pane. Drag and drop <strong class="screen-text">Trend Line</strong> on the trend model of your choice (we'll use <strong class="screen-text">Linear</strong> in this <a id="_idIndexMarker817"/><a id="_idIndexMarker818"/>example and discuss the others later in this chapter):
    <figure class="mediaobject"><img src="../Images/B16021_09_02.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.2: Adding a trend line to a view by dragging and dropping from the Analytics pane</p></li>
    </ul>
    <p class="normal">Once you've added <strong class="screen-text">Trend Line</strong> to your view, you will see two trend lines: one for each country. We'll look at how we can customize the display shortly. For now, your view should look like this:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_03.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.3: Each trend line shows the overall trend for the respective country</p>
    <p class="normal">Trends are<a id="_idIndexMarker819"/><a id="_idIndexMarker820"/> computed by Tableau after the query of the data source and are based on various elements <a id="_idIndexMarker821"/><a id="_idIndexMarker822"/>in the view:</p>
    <ul>
      <li class="list"><strong class="bold">The two fields that define X and Y coordinates</strong>: The fields on <strong class="screen-text">Rows</strong> and <strong class="screen-text">Columns</strong> that define the <em class="italics">x</em> and <em class="italics">y</em> axes describe coordinates, allowing Tableau to calculate various trend models. In order to show trend lines, you must use a continuous (green) field on both <strong class="screen-text">Rows</strong> and <strong class="screen-text">Columns</strong>. The only exception to this rule is that you may use a discrete (blue) <strong class="screen-text">date</strong> field. If you use a discrete <strong class="screen-text">date</strong> field to define headers, the other field must be a continuous field.</li>
      <li class="list"><strong class="bold">Additional fields that create multiple, distinct trend lines</strong>: Discrete (blue) fields on the <strong class="screen-text">Rows</strong>, <strong class="screen-text">Columns</strong>, or <strong class="screen-text">Color</strong> shelves can be used as factors to split a single trend line into multiple, distinct trend lines.</li>
      <li class="list"><strong class="bold">The trend model selected</strong>: We'll examine the differences in models in the next section, <strong class="screen-text">Trend models</strong>.</li>
    </ul>
    <p class="normal">Observe in <em class="italics">Figure 9.3</em> that there are two trend lines. Since <strong class="screen-text">Country Name</strong> is a discrete (blue) field on <strong class="screen-text">Color</strong>, it defines a trend line per color by default.</p>
    <p class="normal">Earlier, we observed that the population of Afghanistan increased and decreased within various historical periods. Note that the trend lines are calculated along the entire date range. What if we want to see different trend lines for those time periods?</p>
    <p class="normal">One option is to simply select the marks in the view for the time period of interest. Tableau will, by default, calculate a trend line for the current selection. Here, for example, the points for Afghanistan from <strong class="screen-text">1980</strong> to <strong class="screen-text">1988</strong> have been selected and a new trend is<a id="_idIndexMarker823"/><a id="_idIndexMarker824"/> displayed:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_04.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.4: The default settings specify that trend lines will be drawn for selections</p>
    <p class="normal">Another option is to instruct Tableau to draw distinct trend lines using a discrete field on <strong class="screen-text">Rows</strong>, <strong class="screen-text">Columns</strong>, or <strong class="screen-text">Color</strong>.</p>
    <p class="normal">Go ahead and create a calculated field called <strong class="screen-text">Period</strong> that defines discrete values for the different historical periods using code like this:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">IF</span> [<span class="hljs-built_in">Year</span>] &lt;= <span class="hljs-number">1979</span>
  <span class="hljs-keyword">THEN</span> <span class="hljs-string">"1960 to 1979"</span>
<span class="hljs-keyword">ELSEIF</span> [<span class="hljs-built_in">Year</span>] &lt;= <span class="hljs-number">1988</span>
  <span class="hljs-keyword">THEN</span> <span class="hljs-string">"1980 to 1988"</span>
<span class="hljs-keyword">ELSE</span> <span class="hljs-string">"1988 to 2015"</span>
<span class="hljs-keyword">END</span> 
</code></pre>
    <p class="normal">When you place it on columns, you'll get a header for each time period, which breaks the lines and causes separate trends to be shown for each time period. You'll also observe that Tableau keeps the full date range in the axis for each period. You can set an independent range by right-clicking on one of the date axes, selecting <strong class="screen-text">Edit Axis</strong>, and then checking the <a id="_idIndexMarker825"/><a id="_idIndexMarker826"/>option for <strong class="screen-text">Independent axis range for each row or column</strong>:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_05.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.5: Here, the discrete dimension Period creates three separate time periods and a trend for each one</p>
    <p class="normal">In this view, transparency has been applied to <strong class="screen-text">Color</strong> to help the trend lines stand out. Additionally, the axis for <strong class="screen-text">Year</strong> was hidden (by unchecking the <strong class="screen-text">Show Header</strong> option on the field). Now you can clearly see the difference in trends for different periods of time. Australia's trends only slightly change in each period. Afghanistan's trends vary considerably.</p>
    <p class="normal">With an understanding of how to add trend lines to your visualization, let's dive a bit deeper to<a id="_idIndexMarker827"/><a id="_idIndexMarker828"/> understand how to customize the trend lines and model.</p>
    <h2 id="_idParaDest-187" class="title">Customizing trend lines</h2>
    <p class="normal">Let's examine another<a id="_idIndexMarker829"/><a id="_idIndexMarker830"/> example that will allow us to consider various options for trend lines. Using the <strong class="bold">Real Estate</strong> data source, create a view like this one:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_06.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.6: Trend lines on a scatterplot are often useful for better understanding correlation and outliers</p>
    <p class="normal">Here, we've created a scatterplot with the sum of <strong class="screen-text">Size (Sq Ft)</strong> on <strong class="screen-text">Columns</strong> to define the <em class="italics">x</em> axis and the sum of <strong class="screen-text">Price</strong> on <strong class="screen-text">Rows</strong> to define the <em class="italics">y</em> axis. <strong class="screen-text">Address</strong> has been added to the <strong class="screen-text">Detail</strong> of the <strong class="screen-text">Marks</strong> card to define the level of aggregation. So, each mark on the scatterplot is a distinct address at a location defined by the size and price. <strong class="screen-text">Type of Sale</strong> has been placed on <strong class="screen-text">Color</strong>. Trend lines have been shown. As per Tableau's default settings, there are three: one trend line per color. The confidence bands have been hidden.</p>
    <p class="normal">Assuming a good model, the trend lines demonstrate how much and how quickly <strong class="screen-text">Price</strong> is expected to rise in correlation with an increase in <strong class="screen-text">Size</strong> for each type of sale.</p>
    <div class="packt_tip">
      <p>In this dataset, we have two fields, <strong class="screen-text">Address</strong> and <strong class="screen-text">ID</strong>, each of which defines a unique record. Adding one of those fields to the <strong class="bold">Level of Detail</strong> effectively disaggregates the <a id="_idIndexMarker831"/><a id="_idIndexMarker832"/>data and allows us to plot a mark for each individual property. Sometimes, you may not have a dimension in the data that defines uniqueness. In those cases, you can disaggregate the data by unchecking <strong class="screen-text">Aggregate Measures</strong> from the <strong class="screen-text">Analysis</strong> menu.</p>
      <p>Alternately, you can use the drop-down menu on each of the measure fields on rows and columns to change them from measures to dimensions while keeping them continuous. As dimensions, each individual value will define a mark. Keeping them continuous will retain the axes required for trend lines.</p>
    </div>
    <p class="normal">Let's consider some of the options available for trend lines. You can edit trend lines by using the menu and selecting <strong class="screen-text">Analysis</strong> | <strong class="screen-text">Trend Lines</strong> | <strong class="screen-text">Edit Trend Lines...</strong> or by right-clicking on a trend line and then selecting <strong class="screen-text">Edit Trend Lines...</strong>. When you do, you'll see a dialog box like this:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_07.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.7: Tableau offers many options for configuring trend lines</p>
    <p class="normal">Here, you have<a id="_idIndexMarker833"/><a id="_idIndexMarker834"/> options for selecting a <strong class="screen-text">Model type</strong>; selecting applicable fields as factors in the model; allowing discrete colors to define distinct trend lines; showing <strong class="screen-text">Confidence Bands</strong>; forcing the y-intercept to zero; showing recalculated trends for selected marks; and showing <strong class="screen-text">tooltips</strong> for the trend line. We'll examine these options in further detail.</p>
    <div class="packt_tip">
      <p>You should only force the y-intercept to zero if you know that it must be zero. With this data, it is almost certainly not zero (that is, there are no houses in existence that are 0 square feet that are listed for $0).</p>
    </div>
    <p class="normal">For now, experiment with the options. Notice how either removing the <strong class="screen-text">Type of Sale</strong> field as a factor or unchecking the <strong class="screen-text">Allow a trend line per color</strong> option results in a single trend line.</p>
    <p class="normal">You can also see the result of excluding a field as a factor in the following view where <strong class="screen-text">Type of Sale</strong> has been added to <strong class="screen-text">Rows</strong>:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_08.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.8: Including a field as a factor tells Tableau whether it contributes to the trend model</p>
    <p class="normal">As represented in the<a id="_idIndexMarker835"/><a id="_idIndexMarker836"/> left-hand portion of the preceding screenshot, <strong class="screen-text">Type of Sale</strong> is included as a factor. This results in a distinct trend line for each type of sale. When <strong class="screen-text">Type of Sale</strong> is excluded as a factor, the same trend line (which is the overall trend for all types) is drawn three times. This technique can be quite useful for comparing subsets of data to the overall trend.</p>
    <p class="normal">Customizing the trend lines is only one aspect of using trends to understand the data. Also, of significant <a id="_idIndexMarker837"/><a id="_idIndexMarker838"/>importance is the trend model itself, which we'll consider customizing in the next section.</p>
    <h2 id="_idParaDest-188" class="title">Trend models</h2>
    <p class="normal">Let's return to the original <a id="_idIndexMarker839"/><a id="_idIndexMarker840"/>view and stick with a single trend line as we consider the trend models that are available in Tableau. The following models can be selected from the <strong class="screen-text">Trend Line Options</strong> window.</p>
    <h3 id="_idParaDest-189" class="title">Linear</h3>
    <p class="normal">We'd use<a id="_idIndexMarker841"/><a id="_idIndexMarker842"/> a linear model if we assumed that, as <strong class="screen-text">Size</strong> increases, <strong class="screen-text">Price</strong> will<a id="_idIndexMarker843"/><a id="_idIndexMarker844"/> increase at a constant rate. No matter how much <strong class="screen-text">Size</strong> increased, we'd expect <strong class="screen-text">Price</strong> to increase so that new data points fall close to the straight line:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_09.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.9: Linear trend</p>
    <h3 id="_idParaDest-190" class="title">Logarithmic</h3>
    <p class="normal">We'd employ<a id="_idIndexMarker845"/><a id="_idIndexMarker846"/> a logarithmic model if we expected<a id="_idIndexMarker847"/><a id="_idIndexMarker848"/> the <strong class="bold">law of diminishing returns</strong> in effect—that is, the size can only increase so much before buyers will stop paying much more:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_10.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.10: Logarithmic trend</p>
    <h3 id="_idParaDest-191" class="title">Exponential</h3>
    <p class="normal">We'd use an <a id="_idIndexMarker849"/><a id="_idIndexMarker850"/>exponential model to test the idea that each<a id="_idIndexMarker851"/><a id="_idIndexMarker852"/> additional increase in size results in a dramatic (exponential!) increase in price:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_11.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.11: Exponential trend</p>
    <h3 id="_idParaDest-192" class="title">Power</h3>
    <p class="normal">We'd employ a <a id="_idIndexMarker853"/><a id="_idIndexMarker854"/>power trend model if we felt the relationship<a id="_idIndexMarker855"/><a id="_idIndexMarker856"/> between size and price was non-linear and somewhere between a diminishing logarithmic trend and an explosive exponential trend. The curve would indicate that the price was a function of the size to a certain power. A power trend predicts certain events very well, such as the distance covered by the acceleration of a vehicle:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_12.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.12: Power trend</p>
    <h3 id="_idParaDest-193" class="title">Polynomial</h3>
    <p class="normal">We'd use this <a id="_idIndexMarker857"/><a id="_idIndexMarker858"/>model if we felt the relationship between <strong class="screen-text">Size</strong> and <strong class="screen-text">Price</strong> was <a id="_idIndexMarker859"/><a id="_idIndexMarker860"/>complex and followed more of an <strong class="bold">S</strong>-shaped curve where initially increasing the size dramatically increased the price but, at some point, the price leveled off. You can set the degree of the polynomial model anywhere from <code class="Code-In-Text--PACKT-">2</code> to <code class="Code-In-Text--PACKT-">8</code>. The trend line shown here is a 3<sup style="font-style: none;">rd</sup> degree polynomial:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_13.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.13: 3<sup style="font-style: none;">rd</sup> degree polynomial trend</p>
    <p class="normal">You'll want to <a id="_idIndexMarker861"/><a id="_idIndexMarker862"/>understand the basics of the trend models so that you can test and validate your assumptions of the data. Some of the trend models<a id="_idIndexMarker863"/><a id="_idIndexMarker864"/> are clearly wrong for our data (though statistically still valid, it is highly unlikely that prices will exponentially increase). A mixture of common sense along with an ever-increasing understanding of statistics will help you as you progress through your journey.</p>
    <p class="normal">You may also wish to analyze your models for accuracy, and we'll turn there next.</p>
    <h2 id="_idParaDest-194" class="title">Analyzing trend models</h2>
    <p class="normal">It can be useful to <a id="_idIndexMarker865"/><a id="_idIndexMarker866"/>observe trend lines, but often we want to understand whether the trend model we've selected is statistically meaningful. Fortunately, Tableau gives us some visibility into the trend models and calculations.</p>
    <p class="normal">Simply hovering over a single trend line will reveal the formula as well as the <strong class="screen-text">R-Squared</strong> and <strong class="screen-text">P-value</strong> for that trend line:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_14.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.14: Tooltip displayed by hovering over the trend line</p>
    <div class="note">
      <p class="Information-Box--PACKT-">A <strong class="bold">P-value</strong> is a statistical concept that describes the probability that the results of assuming no relationship between values (random chance) are at least as close as the results predicted by the trend model. A P-value of 5% (.05) would indicate a 5% chance of random chance describing the relationship between values at least as well as the trend model. This is why P-values of 5% or less are typically considered to indicate a significant trend model. A P-value higher than 5% often leads statisticians to question the correlation described by the trend model. </p>
    </div>
    <p class="normal">Additionally, you can see a much more detailed description of the trend model by selecting <strong class="screen-text">Analysis</strong> | <strong class="screen-text">Trend Lines</strong> | <strong class="screen-text">Describe Trend Model...</strong> from the menu or by using the similar menu from a right-click on the view's pane. When you view the trend model, you'll see the <strong class="screen-text">Describe Trend Model</strong> window:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_15.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.15: The Describe Trend Model window</p>
    <div class="packt_tip">
      <p>You can also get a trend model description in the worksheet description, which is available from the <strong class="screen-text">Worksheet</strong> menu or by pressing <em class="italics">Ctrl</em> + <em class="italics">E</em>. The worksheet description includes quite a bit of other useful summary information about the current view.</p>
    </div>
    <p class="normal">The wealth of <a id="_idIndexMarker867"/><a id="_idIndexMarker868"/>statistical information shown in the window includes a description of the trend model, the formula, the number of observations, and the <strong class="bold">p-value</strong> for the model as a whole and for each trend line. Note that, in the screenshot shown previously, the <strong class="screen-text">Type</strong> field was included as a factor that defined three trend lines. You may find that the p-value is different for different lines in a visualization (for example, the lines in <em class="italics">Figure 9.6</em>). At times, you may even observe that the model is statistically significant overall even though one or more trend lines may not be.</p>
    <div class="note">
      <p class="Information-Box--PACKT-">Additional summary statistical information can be displayed in Tableau Desktop for a given view by showing a summary. From the menu, select <strong class="screen-text">Worksheet</strong> | <strong class="screen-text">Show Summary</strong>. The information displayed in the summary can be expanded using the drop-down menu on the <strong class="screen-text">Summary</strong> card:</p>
      <p class="Information-Box--PACKT-"><img src="../Images/B16021_09_16.png" alt=""/></p>
      <p class="packt_figref">Figure 9.16: Summary information</p>
    </div>
    <p class="normal">The wealth of <a id="_idIndexMarker869"/><a id="_idIndexMarker870"/>information available via tooltips and summaries will help you evaluate your trend models and understand the accuracy and details. But we can even go further, by exporting and analyzing statistical data for the trend models. We'll consider that next.</p>
    <h3 id="_idParaDest-195" class="title">Exporting statistical model details</h3>
    <p class="normal">Tableau<a id="_idIndexMarker871"/><a id="_idIndexMarker872"/> also gives <a id="_idIndexMarker873"/><a id="_idIndexMarker874"/>you the ability to export data, including data related to trend models. This allows you to, more deeply—and even visually, analyze the trend model itself. Let's analyze the third-degree polynomial trend line of the real estate price and size scatterplot without any factors. To export data related to the current view, use the menu to select <strong class="screen-text">Worksheet</strong> | <strong class="screen-text">Export</strong> | <strong class="screen-text">Data</strong>. The data will be exported as a <strong class="screen-text">Microsoft Access Database</strong> (<code class="Code-In-Text--PACKT-">.mdb</code>) file and you'll be prompted where to save the file.</p>
    <div class="note">
      <p class="Information-Box--PACKT-">The ability to export data to <strong class="screen-text">Access</strong> is limited to a PC only. If you're using a Mac, you won't have the option. You may wish to skim this section, but don't worry that you aren't able to replicate the examples.</p>
    </div>
    <p class="normal">On the <strong class="screen-text">Export Data to Access</strong> screen, specify an access table name and select whether you wish to export data from the entire view or the current selection. You may also specify that Tableau<a id="_idIndexMarker875"/><a id="_idIndexMarker876"/> should connect to the data. This will generate the data source and make it available<a id="_idIndexMarker877"/><a id="_idIndexMarker878"/> with the specified name in the current workbook:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_17.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.17: The Export Data to Access dialog box</p>
    <p class="normal">The new data source connection will contain all the fields that were in the original view as well as additional fields related to the trend model. This allows us to build a view like the following, using the residuals and predictions:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_18.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.18: A view using residuals and predictions to test the model</p>
    <p class="normal">A scatterplot of predictions (<em class="italics">x</em> axis) and residuals (<em class="italics">y</em> axis) allows you to visually see how far each mark was<a id="_idIndexMarker879"/><a id="_idIndexMarker880"/> from the location predicted by the<a id="_idIndexMarker881"/><a id="_idIndexMarker882"/> trend line. It also allows you to see whether residuals are distributed evenly on either side of zero. An uneven distribution would likely indicate problems with the trend model.</p>
    <p class="normal">You can include this new view along with the original on a dashboard to explore the trend model visually. Use the highlight button on the toolbar to highlight the <strong class="screen-text">Address</strong> field:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_19.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.19: The highlight button</p>
    <p class="normal">With the highlight action defined, selecting marks in one view will allow you to see them in the other. You could extend this technique to export multiple trend models and dashboards<a id="_idIndexMarker883"/><a id="_idIndexMarker884"/> to evaluate several trend models at the<a id="_idIndexMarker885"/><a id="_idIndexMarker886"/> same time:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_20.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.20: Placing the original view alongside the testing view allows you to see the relationship</p>
    <h3 id="_idParaDest-196" class="title">Advanced statistics and more with R and Python</h3>
    <p class="normal">You can<a id="_idIndexMarker887"/><a id="_idIndexMarker888"/> achieve even more sophisticated statistical analysis<a id="_idIndexMarker889"/><a id="_idIndexMarker890"/> leveraging Tableau's<a id="_idIndexMarker891"/><a id="_idIndexMarker892"/> ability to integrate<a id="_idIndexMarker893"/><a id="_idIndexMarker894"/> with R or Python. <strong class="bold">R</strong> is an open source<a id="_idIndexMarker895"/><a id="_idIndexMarker896"/> statistical analysis platform and programming language<a id="_idIndexMarker897"/><a id="_idIndexMarker898"/> with which you can define advanced statistical models. <strong class="bold">Python</strong> is a high-level programming language that has quickly gained a wide following among data analysts and data scientists for its ease of use. It contains many capabilities for data cleansing as well as libraries of statistical functions.</p>
    <div class="note">
      <p class="Information-Box--PACKT-">To use R or Python, you'll first need to install either an <code class="Code-In-Text--PACKT-">R</code> <code class="Code-In-Text--PACKT-">server</code> or <code class="Code-In-Text--PACKT-">TabPy</code> (a Python<a id="_idIndexMarker899"/><a id="_idIndexMarker900"/> API available from Tableau) and then configure Tableau to use an R server or TabPy. To learn more about installing and using R Server or TabPy, check out these resources:</p>
      <p class="Information-Box--PACKT-"><strong class="bold">R</strong>: <a href="https://www.tableau.com/solutions/r"><span class="url">https://www.tableau.com/solutions/r</span></a></p>
      <p class="Information-Box--PACKT-"><strong class="bold">Python</strong>: <a href="https://www.tableau.com/about/blog/2017/1/building-advanced-analytics-applications-tabpy-64916"><span class="url">https://www.tableau.com/about/blog/2017/1/building-advanced-analytics-applications-tabpy-64916</span></a></p>
    </div>
    <p class="normal">It's beyond the <a id="_idIndexMarker901"/><a id="_idIndexMarker902"/>scope of this book to dive into the<a id="_idIndexMarker903"/><a id="_idIndexMarker904"/> complexities of R and Python, but having<a id="_idIndexMarker905"/><a id="_idIndexMarker906"/> an awareness of the capability will<a id="_idIndexMarker907"/><a id="_idIndexMarker908"/> enable you to<a id="_idIndexMarker909"/><a id="_idIndexMarker910"/> pursue<a id="_idIndexMarker911"/><a id="_idIndexMarker912"/> the topic further.</p>
    <p class="normal">Next, we'll take a look at Tableau's capability for identifying complex relationships within data using clustering.</p>
    <h1 id="_idParaDest-197" class="title">Clustering</h1>
    <p class="normal">Tableau gives<a id="_idIndexMarker913"/><a id="_idIndexMarker914"/> you the ability to quickly perform clustering analysis in your visualizations. This allows you to find groups, or <strong class="bold">clusters</strong>, of individual data points that are similar based on any number of your choosing. This can be useful in many different industries and fields of study, as in the following examples:</p>
    <ul>
      <li class="list">Marketing may find it useful to determine groups of customers related to each other based on spending amounts, frequency of purchases, or times and days of orders.</li>
      <li class="list">Patient care directors in hospitals may benefit from understanding groups of patients related to each other based on diagnoses, medication, length of stay, and the number of readmissions.</li>
      <li class="list">Immunologists may search for related strains of bacteria based on drug resistance or genetic markers.</li>
      <li class="list">Renewable energy consultants may like to pinpoint clusters of windmills based on energy production and then correlate that with geographic location.</li>
    </ul>
    <div class="note">
      <p class="Information-Box--PACKT-">Tableau uses a standard <strong class="bold">k-means clustering</strong> algorithm that will yield consistent results every<a id="_idIndexMarker915"/><a id="_idIndexMarker916"/> time the view is rendered. Tableau will automatically assign the number of clusters (k), but you have the option of adjusting the value as well as assigning any number of variables.</p>
    </div>
    <p class="normal">As we consider clustering, we'll turn once again to the real estate data to see whether we can find groupings of related houses on the market and then determine whether there's any geographic pattern based on the clusters we find.</p>
    <p class="normal">Although you can add clusters to any visualization, we'll start with a scatterplot, because it already allows us to see the relationship between two variables. That will give us some insight into how clustering works, and then we can add additional variables to see how the clusters are redefined.</p>
    <p class="normal">Beginning with the basic scatterplot of <strong class="screen-text">Address</strong> by <strong class="screen-text">Size</strong> and <strong class="screen-text">Price</strong>, switch to the <strong class="screen-text">Analytics</strong> pane<a id="_idIndexMarker917"/><a id="_idIndexMarker918"/> and drag <strong class="screen-text">Cluster</strong> to the view:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_21.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.21: Adding clusters by dragging and dropping from the Analytics pane</p>
    <p class="normal">When you drop <strong class="screen-text">Cluster</strong> onto the view, Tableau will generate a new <strong class="screen-text">Clusters</strong> field (automatically placed on <strong class="screen-text">Color</strong> here) and will display a <strong class="screen-text">Clusters</strong> window containing the fields used as <strong class="screen-text">Variables</strong> and an option to change the <strong class="screen-text">Number of Clusters</strong>. <strong class="screen-text">Variables</strong> will contain the measures already in the view by default:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_22.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.22: Clusters of individual addresses based on Price and Size</p>
    <p class="normal"><strong class="screen-text">Variables</strong> are<a id="_idIndexMarker919"/><a id="_idIndexMarker920"/> all the factors that the clustering algorithm uses to determine related data points. <strong class="screen-text">Number of Clusters</strong> determines into how many groups the data is partitioned. In the preceding view, you'll observe three clusters of houses:</p>
    <ul>
      <li class="list">Those with a low price and a smaller size (blue)</li>
      <li class="list">Those with an average price and size (orange)</li>
      <li class="list">Those with a high price and a large size (gray)</li>
    </ul>
    <p class="normal">Because the two variables used for the clusters are the same as those used for the scatterplot, it's relatively easy to see the boundaries of the clusters (you can imagine a couple of diagonal lines partitioning the data).</p>
    <p class="normal">You can drag and drop nearly any field into and out of the <strong class="screen-text">Variables</strong> section (from the data pane or the view) to add and remove variables. The clusters will automatically update as you do so. Experiment by adding <strong class="screen-text">Bedrooms</strong> to the <strong class="screen-text">Variables</strong> list and observe that there's now some overlap between <strong class="screen-text">Cluster 1</strong> and <strong class="screen-text">Cluster 2</strong> because some larger homes only have two or three bedrooms while some smaller homes might have four or five. The number of bedrooms now helps define the clusters. Remove <strong class="screen-text">Bedrooms</strong> and note that the clusters are immediately updated again.</p>
    <p class="normal">Once you have meaningful clusters, you can materialize the clusters as groups in the data source by<a id="_idIndexMarker921"/><a id="_idIndexMarker922"/> dragging them from the view and dropping them into the <strong class="screen-text">Data</strong> pane:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_23.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.23: Materializing a cluster by dragging the Clusters field from the view to the Data pane</p>
    <p class="normal">The cluster group will not be recalculated at render time. To recalculate the cluster group, use the dropdown on the field in the <strong class="screen-text">Data</strong> pane and select <strong class="screen-text">Refit</strong>.</p>
    <p class="normal">Using a cluster group allows you to accomplish a lot, including the following:</p>
    <ul>
      <li class="list">Cluster groups can be used across multiple visualizations and can be used in actions on dashboards.</li>
      <li class="list">Cluster groups can be edited, and individual members moved between groups if desired.</li>
      <li class="list">Cluster group names can be aliased, allowing more descriptive names than <strong class="screen-text">Cluster 1</strong> and <strong class="screen-text">Cluster 2</strong>.</li>
      <li class="list">Cluster groups can be used in calculated fields, while clusters can't.</li>
    </ul>
    <p class="normal">In the following example, a map of the properties has been color-coded by the <strong class="screen-text">Address (clusters)</strong> group in the previous view to help us to see whether there's any geographic correlation to the clusters based on price and size. While the clusters could have been created directly<a id="_idIndexMarker923"/><a id="_idIndexMarker924"/> in this visualization, the group has some of the advantages mentioned:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_24.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.24: This view uses the clusters we identified to additionally understand any geospatial relationships</p>
    <p class="normal">In the view here, each original cluster is now a group that has been aliased to give a better description of the cluster. You can use the drop-down menu for the group field in the data pane or, alternately, right-click the item in the color legend to edit aliases.</p>
    <div class="packt_tip">
      <p>There are a lot of options for editing how maps appear. You can adjust the layers that are shown on maps to help to provide additional context for the data you are plotting. From the top menu, select <strong class="screen-text">Maps</strong> | <strong class="screen-text">Map Layers</strong>. The layer options will show in the left-hand sidebar. The preceding map has had <strong class="screen-text">Streets</strong>, <strong class="screen-text">Highways</strong>, <strong class="screen-text">County Borders</strong>, and <strong class="screen-text">Zip Code Borders</strong> enabled to give each address a more precise context of location. The layers that are available to select will depend on the zoom level of the map. </p>
    </div>
    <p class="normal">In looking at the<a id="_idIndexMarker925"/><a id="_idIndexMarker926"/> previous view, you do indeed find neighborhoods that are almost exclusively <strong class="screen-text">Low Price &amp; Size</strong> (<strong class="screen-text">Cluster 1</strong>) and others that are almost exclusively <strong class="screen-text">Mid-Range</strong> (<strong class="screen-text">Cluster 2</strong>). Consider how a real-estate investor might use such a visualization to look for a low-priced house in a mid-range neighborhood.</p>
    <h1 id="_idParaDest-198" class="title">Distributions</h1>
    <p class="normal">Analyzing distributions can<a id="_idIndexMarker927"/><a id="_idIndexMarker928"/> be quite useful. We've already seen that certain calculations are available for determining statistical information such as averages, percentiles, and standard deviations. Tableau also makes it easy to quickly visualize various distributions, including confidence intervals, percentages, percentiles, quantiles, and standard deviations.</p>
    <p class="normal">You may add any of these visual analytic features using the <strong class="screen-text">Analytics</strong> pane (alternately, you can right-click an axis and select <strong class="screen-text">Add Reference Line</strong>). Just like reference lines and bands, distribution analytics can be applied within the scope of a table, pane, or cell. When you drag and drop the desired visual analytic, you'll have options for selecting the scope and the axis. In the following example, we've dragged and dropped <strong class="screen-text">Distribution Band</strong> from the <strong class="screen-text">Analytics</strong> pane onto the scope of <strong class="screen-text">Pane</strong> for the axis defined by <code class="Code-In-Text--PACKT-">Sum(Price)</code>:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_25.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.25: Defining the scope and axis as you add reference lines and distributions from the Analytics pane</p>
    <p class="normal">Once you've selected the scope and axis, you'll be given options to change settings. You may also edit lines, bands, distributions, and box plots by right-clicking the analytic feature in the view or<a id="_idIndexMarker929"/><a id="_idIndexMarker930"/> by right-clicking the axis or the reference lines themselves.</p>
    <p class="normal">As an example, let's take the scatterplot of addresses by price and size with <strong class="screen-text">Type of Sale</strong> on <strong class="screen-text">Columns</strong> in addition to color:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_26.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.26: A scatterplot divided into three columns</p>
    <p class="normal">Next, we drag and drop the <strong class="screen-text">Distribution </strong>band from the <strong class="screen-text">Analytics</strong> pane onto <strong class="screen-text">Pane</strong> only for the axis defined by <strong class="screen-text">Price</strong>. This brings up a dialog box to set the options:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_27.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.27: The dialog box for adding or editing lines, bands, distributions, or box plots</p>
    <p class="normal">Each<a id="_idIndexMarker931"/><a id="_idIndexMarker932"/> specific <strong class="screen-text">Distribution</strong> option specified in the <strong class="screen-text">Value</strong> drop-down menu under <strong class="screen-text">Computation</strong> has unique settings. <strong class="bold">Confidence Interval</strong>, for example, allows you<a id="_idIndexMarker933"/><a id="_idIndexMarker934"/> to specify a percent value for the interval. <strong class="screen-text">Standard Deviation</strong> allows you to enter a comma-delimited list of values that describe how many standard deviations and at what intervals. The preceding settings reflect specifying standard deviations of <strong class="screen-text">-2</strong>, <strong class="screen-text">-1</strong>, <strong class="screen-text">1</strong>, and <strong class="screen-text">2</strong>. After adjusting the label and formatting as shown in the preceding screenshot, you should see results like this:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_28.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.28: Two standard deviations of Price for each Type of Sale</p>
    <p class="normal">Since you applied the standard deviations per pane, you get different bands for each type of sale. Each axis<a id="_idIndexMarker935"/><a id="_idIndexMarker936"/> can support multiple distributions, reference lines, and bands. You could, for example, add an average line in the preceding view to help a viewer to understand the center of the standard deviations.</p>
    <p class="normal">On a scatterplot, using a distribution for each axis can yield a very useful way to analyze outliers. Showing a single standard deviation for both <strong class="screen-text">Area</strong> and <strong class="screen-text">Price</strong> allows you to easily see properties that fall within norms for both, one, or neither (you might consider purchasing a house that was on the high end of size but within normal price limits!):</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_29.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.29: One standard deviation for both Price and Size of all houses</p>
    <h1 id="_idParaDest-199" class="title">Forecasting</h1>
    <p class="normal">As we've seen, trend models<a id="_idIndexMarker937"/><a id="_idIndexMarker938"/> make predictions. Given a good model, you expect additional data to follow the trend. When the trend is over time, you can get some idea of where future values may fall. However, predicting future values often requires a different type of model. Factors such as seasonality can make a difference not predicted by a trend alone. Tableau includes built-in forecasting models that can be used to predict and visualize future values.</p>
    <p class="normal">To use forecasting, you'll need a view that includes a date field or enough date parts for Tableau to reconstruct a date (for example, a <strong class="screen-text">Year</strong> and a <strong class="screen-text">Month</strong> field). Tableau also allows forecasting based on integers instead of dates. You may drag and drop a forecast from the <strong class="screen-text">Analytics</strong> pane, select <strong class="screen-text">Analytics </strong>| <strong class="screen-text">Forecast</strong> | <strong class="screen-text">Show Forecast</strong> from the menu, or right-click on the view's pane and select the option from the context menu.</p>
    <p class="normal">Here, for example, is the view of the population growth over time of Afghanistan and Australia with forecasts shown:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_30.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.30: A forecast of the population for both Afghanistan and Australia</p>
    <p class="normal">Note that, when you<a id="_idIndexMarker939"/><a id="_idIndexMarker940"/> show the forecast, Tableau adds a forecast icon to the <code class="Code-In-Text--PACKT-">SUM(Population)</code> field on <strong class="screen-text">Rows</strong> to indicate that the measure is being forecast. Additionally, Tableau adds a new special <strong class="screen-text">Forecast indicator</strong> field to <strong class="screen-text">Color</strong> so that forecast values are differentiated from actual values in the view.</p>
    <div class="packt_tip">
      <p>You can move the <strong class="screen-text">Forecast indicator</strong> field or even copy it (hold the <em class="italics">Ctrl</em> key while dragging and dropping) to other shelves to further customize your view.</p>
    </div>
    <p class="normal">When you edit the forecast by selecting <strong class="screen-text">Analytics</strong> | <strong class="screen-text">Forecast</strong> | <strong class="screen-text">Forecast Options...</strong> from the menu or use the right-click context menu on the view, you'll be presented with various options for customizing the trend model, like this:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_31.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.31: The Forecast Options dialog box</p>
    <p class="normal">Here, you have options<a id="_idIndexMarker941"/><a id="_idIndexMarker942"/> to set the length of the forecast, determine aggregations, customize the model, and set whether you wish to show prediction intervals. The forecast length is set to <strong class="screen-text">Automatic</strong> by default, but you can extend the forecast by a custom value.</p>
    <p class="normal">The options under <strong class="screen-text">Source Data</strong> allow you to optionally specify a different grain of data for the model. For example, your view might show a measure by year, but you could allow Tableau to query the source data to retrieve values by month and use the finer grain to potentially achieve better forecasting results.</p>
    <div class="note">
      <p class="Information-Box--PACKT-">Tableau's ability to separately query the data source to obtain data at a finer grain for more precise results works well with relational data sources. However, <strong class="bold">Online Analytical Processing</strong> (<strong class="bold">OLAP</strong>) data sources aren't compatible with this<a id="_idIndexMarker943"/><a id="_idIndexMarker944"/> approach, which is one reason why forecasting isn't available when working with cubes.</p>
    </div>
    <p class="normal">By default, the last value is excluded from the model. This is useful when you're working with data where the most recent time period is incomplete. For example, when records are added daily, the last (current) month isn't complete until the final records are added on the last day of the month. Prior to that last day, the incomplete time period might skew the model if it's not ignored.</p>
    <p class="normal">The model itself can be set to automatic with or without seasonality, or can be customized to set options for seasonality and trend. To understand the options, consider the following <a id="_idIndexMarker945"/><a id="_idIndexMarker946"/>view of <strong class="screen-text">Sales</strong> by <strong class="screen-text">Month</strong> from the <code class="Code-In-Text--PACKT-">Superstore</code> sample data:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_32.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.32: This time series shows a cyclical or seasonal pattern</p>
    <p class="normal">The data displays a distinct cyclical or seasonal pattern. This is very typical for retail sales and other types of data. The following are the results of selecting various custom options:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_33.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.33: Selecting various forecast models will yield different results</p>
    <p class="normal">Examining the differences<a id="_idIndexMarker947"/><a id="_idIndexMarker948"/> above will help you understand the differences in the options. For example, note that no seasonality results in a straight line that does not fluctuate with seasons. Multiplicative trends result in sharper inclines and decreases, while multiplicative seasonality results in sharper variations.</p>
    <p class="normal">Much like trends, forecast models and summary information can be accessed using the menu. Selecting <strong class="screen-text">Analytics</strong> | <strong class="screen-text">Forecast</strong> | <strong class="screen-text">Describe Forecast</strong> will display a window with tabs for both the summary and details concerning the model:</p>
    <figure class="mediaobject"><img src="../Images/B16021_09_34.png" alt=""/></figure>
    <p class="packt_figref">Figure 9.34: Tableau describes the forecast model</p>
    <p class="normal">Clicking the <strong class="screen-text">Learn more about the forecast summary</strong> link at the bottom of the window will give you<a id="_idIndexMarker949"/><a id="_idIndexMarker950"/> much more information on the forecast models used in Tableau.</p>
    <div class="note">
      <p class="Information-Box--PACKT-">Forecast models are only enabled given a certain set of conditions. If the option is disabled, ensure that you're connected to a relational database and not OLAP, that you're not using table calculations, and that you have at least five data points.</p>
    </div>
    <h1 id="_idParaDest-200" class="title">Summary</h1>
    <p class="normal">Tableau provides an extensive set of features for adding value to your analysis. Trend lines allow you to more precisely identify outliers, determine which values fall within the predictions of certain models, and even make predictions of where measurements are expected. Tableau gives extensive visibility into the trend models and even allows you to export data containing trend model predictions and residuals. Clusters enable you to find groups of related data points based on various factors. Distributions are useful for understanding a spread of values across a dataset. Forecasting allows a complex model of trends and seasonality to predict future results. Having a good understanding of these tools will give you the ability to clarify and validate your initial visual analyses.</p>
    <p class="normal">Next, we'll consider some advanced visualization types that will expand the horizons of what you are able to accomplish with Tableau and the way in which you communicate data to others!</p>
  </div>
</body></html>