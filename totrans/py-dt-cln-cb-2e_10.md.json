["```py\n    import pandas as pd\n    import numpy as np\n    import os \n    ```", "```py\n    ltcameroon = pd.read_csv(\"data/ltcountry/ltcameroon.csv\")\n    ltoman = pd.read_csv(\"data/ltcountry/ltoman.csv\")\n    ltcameroon.shape \n    ```", "```py\n    (48, 11) \n    ```", "```py\n    ltoman.shape \n    ```", "```py\n    (288, 10) \n    ```", "```py\nltcameroon.columns \n```", "```py\nIndex(['locationid', 'year', 'month', 'temperature',\n       'latitude', 'longitude', 'elevation', 'station',\n       'countryid', 'country', 'latabs'],\n      dtype='object') \n```", "```py\nltoman.columns \n```", "```py\nIndex(['locationid', 'year', 'month', 'temperature',\n       'latitude', 'longitude', 'elevation', 'station',\n       'countryid', 'country'],\n      dtype='object') \n```", "```py\nltcameroon.columns.\\\n  symmetric_difference(ltoman.columns) \n```", "```py\nIndex(['latabs'], dtype='object') \n```", "```py\n    ltall = pd.concat([ltcameroon, ltoman])\n    ltall.country.value_counts() \n    ```", "```py\n    country\n    Oman        288\n    Cameroon     48\n    Name: count, dtype: int64 \n    ```", "```py\n    ltall[['country','station','temperature',\n      'latitude','latabs']].\\\n      sample(5, random_state=3) \n    ```", "```py\n     country          station    temperature    latitude    latabs\n    276        Oman            BAHLA          21.44      23.000       NaN\n    26         Oman             DIBA          21.85      25.617       NaN\n    281        Oman      RAS_AL_HADD          23.74      22.300       NaN\n    15     Cameroon           GAROUA          33.91       9.336     9.336\n    220        Oman      SOHAR_MAJIS          30.85      24.467       NaN \n    ```", "```py\n    ltall.groupby(['country'])['latabs'].count() \n    ```", "```py\n    country\n    Cameroon    48\n    Oman         0\n    Name: latabs, dtype: int64 \n    ```", "```py\n    def concatfiles(filelist):\n      directory = \"data/ltcountry/\"\n      ltall = pd.DataFrame()\n      for filename in filelist:\n        ltnew = pd.read_csv(directory + filename + \".csv\")\n        print(filename + \" has \" +\n          str(ltnew.shape[0]) + \" rows.\")\n        ltall = pd.concat([ltall, ltnew])\n      return ltall\n    ltall = concatfiles(['ltcameroon','ltoman']) \n    ```", "```py\n    ltcameroon has 48 rows.\n    ltoman has 288 rows. \n    ```", "```py\n    ltall.country.value_counts() \n    ```", "```py\n    country\n    Oman        288\n    Cameroon     48\n    Name: count, dtype: int64 \n    ```", "```py\ndef concatallfiles():\n  directory = \"data/ltcountry\"\n  ltall = pd.DataFrame()\n  for filename in os.listdir(directory):\n    if filename.endswith(\".csv\"):\n      fileloc = os.path.join(directory, filename)\n\n      # open the next file\n      with open(fileloc):\n        ltnew = pd.read_csv(fileloc)\n        print(filename + \" has \" +\n          str(ltnew.shape[0]) + \" rows.\")\n        ltall = pd.concat([ltall, ltnew])\n\n        # check for differences in columns\n        columndiff = ltall.columns.\\\n          symmetric_difference(ltnew.columns)\n        if (not columndiff.empty):\n          print(\"\", \"Different column names for:\",\n           filename, columndiff, \"\", sep=\"\\n\")\n\n  return ltall \n```", "```py\n    ltall = concatallfiles() \n    ```", "```py\n    ltpoland.csv has 120 rows.\n    ltcameroon.csv has 48 rows.\n    ltmexico.csv has 852 rows.\n    ltjapan.csv has 1800 rows.\n    ltindia.csv has 1116 rows.\n    ltoman.csv has 288 rows.\n    Different column names for:\n    ltoman.csv\n    Index(['latabs'], dtype='object')\n    ltbrazil.csv has 1008 rows. \n    ```", "```py\n    ltall[['country','station','month',\n     'temperature','latitude']].\\\n     sample(5, random_state=1) \n    ```", "```py\n     country               station   month   temperature   latitude\n    583   Japan             TOKUSHIMA       4            16         34\n    635   India   NEW_DELHI_SAFDARJUN       7            31         29\n    627  Mexico      COATZACOALCOSVER       9            30         18\n    28   Poland               WLODAWA       3             5         52\n    775  Mexico           ARRIAGACHIS      11            28         16 \n    ```", "```py\nltall.country.value_counts().sort_index() \n```", "```py\ncountry\nBrazil      1008\nCameroon      48\nIndia       1116\nJapan       1800\nMexico       852\nOman         288\nPoland       120\nName: count, dtype: int64 \n```", "```py\nltall.groupby(['country']).\\\n  agg({'temperature':['mean','max','count'],\n  'latabs':['mean','max','count']}) \n```", "```py\n temperature              latabs         \n                mean   max   count     mean   max   count\ncountry                                       \nBrazil            25    34     900       14    34    1008\nCameroon          27    35      39        8    10      48\nIndia             26    35    1096       21    34    1116\nJapan             14    31    1345       36    45    1800\nMexico            23    36     685       22    32     852\nOman              28    38     264      NaN   NaN       0\nPoland            10    21     120       52    55     120 \n```", "```py\nltall['latabs'] = np.where(ltall.country==\"Oman\", ltall.latitude, ltall.latabs)\nltall.groupby(['country']).\\\n...   agg({'temperature':['mean','max','count'],\n...   'latabs':['mean','max','count']}) \n```", "```py\n temperature             latabs         \n                mean   max   count     mean   max   count\ncountry                                       \nBrazil            25    34     900       14    34    1008\nCameroon          27    35      39        8    10      48\nIndia             26    35    1096       21    34    1116\nJapan             14    31    1345       36    45    1800\nMexico            23    36     685       22    32     852\nOman              28    38     264       22    26     288\nPoland            10    21     120       52    55     120 \n```", "```py\n    import pandas as pd\n    nls97 = pd.read_csv(\"data/nls97f.csv\", low_memory=False)\n    nls97.set_index(\"personid\", inplace=True)\n    nls97add = pd.read_csv(\"data/nls97add.csv\") \n    ```", "```py\n    nls97.head() \n    ```", "```py\n     gender    birthmonth    birthyear  ...  \\\n    personid                                       ...  \n    135335      Female             9         1981  ...  \n    999406        Male             7         1982  ...  \n    151672      Female             9         1983  ...  \n    750699      Female             2         1981  ...  \n    781297        Male            10         1982  ...  \n                  colenrfeb22   colenroct22    originalid \n    personid                                          \n    135335                NaN           NaN             1 \n    999406                NaN           NaN             2 \n    151672    1\\. Not enrolled           NaN             3 \n    750699                NaN           NaN             4 \n    781297                NaN           NaN             5 \n    [5 rows x 106 columns] \n    ```", "```py\n    nls97.shape \n    ```", "```py\n    (8984, 106) \n    ```", "```py\n    nls97add.head() \n    ```", "```py\n     originalid    motherage    parentincome  \\\n    0             1           26              -3  \n    1             2           19              -4  \n    2             3           26           63000  \n    3             4           33           11700  \n    4             5           34              -3  \n         fatherhighgrade    motherhighgrade \n    0                 16                  8 \n    1                 17                 15 \n    2                 -3                 12 \n    3                 12                 12 \n    4                 12                 12 \n    ```", "```py\n    nls97add.shape \n    ```", "```py\n    (8984, 5) \n    ```", "```py\nnls97.originalid.nunique()==nls97.shape[0] \n```", "```py\nTrue \n```", "```py\nnls97add.originalid.nunique()==nls97add.shape[0] \n```", "```py\nTrue \n```", "```py\nnls97 = nls97.sort_values('originalid')\nnls97add = nls97add.sort_values('originalid')\nnls97.loc[[135335,999406], \"originalid\"] = \\\n  nls97.originalid+10000\nnls97.originalid.head(2) \n```", "```py\npersonid\n135335    10001\n999406    10002\nName: originalid, dtype: int64 \n```", "```py\nnls97add.loc[[0,1], \"originalid\"] = \\\n  nls97add.originalid+20000\nnls97add.originalid.head(2) \n```", "```py\n0    20001\n1    20002\nName: originalid, dtype: int64 \n```", "```py\nnls97.set_index(\"originalid\", inplace=True)\nnls97add.set_index(\"originalid\", inplace=True)\nnlsnew = nls97.join(nls97add)\nnlsnew.loc[nlsnew.index>9999, ['originalid','gender','birthyear','motherage','parentincome']] \n```", "```py\n gender    birthyear    motherage    parentincome\noriginalid                                           \n10001         Female         1981          NaN             NaN\n10002           Male         1982          NaN             NaN \n```", "```py\nnlsnew = pd.merge(nls97, nls97add, on=['originalid'], how=\"left\")\nnlsnew.loc[nlsnew.index>9999, ['gender','birthyear','motherage','parentincome']] \n```", "```py\n gender    birthyear    motherage   parentincome\noriginalid                                \n10001         Female         1981          NaN            NaN\n10002           Male         1982          NaN            NaN \n```", "```py\nnlsnew = pd.merge(nls97, nls97add, on=['originalid'], how=\"right\")\nnlsnew.loc[nlsnew.index>9999, ['gender','birthyear','motherage','parentincome']] \n```", "```py\n gender    birthyear    motherage    parentincome\noriginalid                               \n20001           NaN          NaN           26              -3\n20002           NaN          NaN           19              -4 \n```", "```py\nnlsnew = pd.merge(nls97, nls97add, on=['originalid'], how=\"inner\")\nnlsnew.loc[nlsnew.index>9999, ['gender','birthyear','motherage','parentincome']] \n```", "```py\nEmpty DataFrame\nColumns: [gender, birthyear, motherage, parentincome]\nIndex: [] \n```", "```py\nnlsnew = pd.merge(nls97, nls97add, on=['originalid'], how=\"outer\")\nnlsnew.loc[nlsnew.index>9999, ['gender','birthyear','motherage','parentincome']] \n```", "```py\n gender    birthyear    motherage      parentincome\noriginalid                                \n10001         Female        1,981          NaN               NaN\n10002           Male        1,982          NaN               NaN\n20001            NaN          NaN           26                -3\n20002            NaN          NaN           19                -4 \n```", "```py\ndef checkmerge(dfleft, dfright, idvar):\n...   dfleft['inleft'] = \"Y\"\n...   dfright['inright'] = \"Y\"\n...   dfboth = pd.merge(dfleft[[idvar,'inleft']],\\\n...     dfright[[idvar,'inright']], on=[idvar], how=\"outer\")\n...   dfboth.fillna('N', inplace=True)\n...   print(pd.crosstab(dfboth.inleft, dfboth.inright))\n...\ncheckmerge(nls97.reset_index(),nls97add.reset_index(), \"originalid\") \n```", "```py\ninright    N       Y\ninleft         \nN          0       2\nY          2    8982 \n```", "```py\nnlsnew = pd.merge(right=nls97add, left=nls97, on=['originalid'], how=\"left\") \n```", "```py\nnlsnew = pd.merge(nls97, nls97add, left_on=['originalid'], right_on=['originalid'], how=\"left\") \n```", "```py\n    import pandas as pd\n    nls97weeksworked = pd.read_csv(\"data/nls97weeksworked.csv\")\n    nls97colenr = pd.read_csv(\"data/nls97colenr.csv\") \n    ```", "```py\n    nls97weeksworked.loc[nls97weeksworked.\\\n      originalid.isin([2,3])] \n    ```", "```py\n     originalid    year    weeksworked\n    5            2    2017             52\n    6            2    2018             52\n    7            2    2019             52\n    8            2    2020             52\n    9            2    2021             46\n    10           3    2017             52\n    11           3    2018             52\n    12           3    2019              9\n    13           3    2020              0\n    14           3    2021              0 \n    ```", "```py\n    nls97weeksworked.shape \n    ```", "```py\n    (44920, 3) \n    ```", "```py\n    nls97weeksworked.originalid.nunique() \n    ```", "```py\n    8984 \n    ```", "```py\n    nls97colenr.loc[nls97colenr.\\\n      originalid.isin([2,3])] \n    ```", "```py\n     originalid    year             colenr\n    1                 2    2017    1\\. Not enrolled\n    2                 3    2017    1\\. Not enrolled\n    8985              2    2018    1\\. Not enrolled\n    8986              3    2018    1\\. Not enrolled\n    17969             2    2019    1\\. Not enrolled\n    17970             3    2019    1\\. Not enrolled\n    26953             2    2020    1\\. Not enrolled\n    26954             3    2020    1\\. Not enrolled\n    35937             2    2021    1\\. Not enrolled\n    35938             3    2021    1\\. Not enrolled \n    ```", "```py\n    nls97colenr.shape \n    ```", "```py\n    (44920, 3) \n    ```", "```py\n    nls97colenr.originalid.nunique() \n    ```", "```py\n    8984 \n    ```", "```py\nnls97weeksworked.groupby(['originalid','year'])\\\n...   ['originalid'].count().shape \n```", "```py\n(44920,) \n```", "```py\nnls97colenr.groupby(['originalid','year'])\\\n...   ['originalid'].count().shape \n```", "```py\n(44920,) \n```", "```py\n    def checkmerge(dfleft, dfright, idvar):\n    ...   dfleft['inleft'] = \"Y\"\n    ...   dfright['inright'] = \"Y\"\n    ...   dfboth = pd.merge(dfleft[idvar + ['inleft']],\\\n    ...     dfright[idvar + ['inright']], on=idvar, how=\"outer\")\n    ...   dfboth.fillna('N', inplace=True)\n    ...   print(pd.crosstab(dfboth.inleft, dfboth.inright))\n    ...\n    checkmerge(nls97weeksworked.copy(),nls97colenr.copy(), ['originalid','year']) \n    ```", "```py\n    inright      Y\n    inleft       \n    Y        44920 \n    ```", "```py\n    nls97workschool = \\\n      pd.merge(nls97weeksworked, nls97colenr,\n      on=['originalid','year'], how=\"inner\")\n    nls97workschool.shape \n    ```", "```py\n    (44920, 4) \n    ```", "```py\n    nls97workschool.loc[nls97workschool.\\\n      originalid.isin([2,3])] \n    ```", "```py\n     originalid    year    weeksworked             colenr\n    5            2    2017             52    1\\. Not enrolled\n    6            2    2018             52    1\\. Not enrolled\n    7            2    2019             52    1\\. Not enrolled\n    8            2    2020             52    1\\. Not enrolled\n    9            2    2021             46    1\\. Not enrolled\n    10           3    2017             52    1\\. Not enrolled\n    11           3    2018             52    1\\. Not enrolled\n    12           3    2019              9    1\\. Not enrolled\n    13           3    2020              0    1\\. Not enrolled\n    14           3    2021              0    1\\. Not enrolled \n    ```", "```py\n    import pandas as pd\n    countries = pd.read_csv(\"data/ltcountries.csv\")\n    locations = pd.read_csv(\"data/ltlocations.csv\") \n    ```", "```py\ncountries.set_index(['countryid'], inplace=True)\nlocations.set_index(['countryid'], inplace=True)\ncountries.head() \n```", "```py\n country\ncountryid                     \nAC              Antigua and Barbuda\nAE             United Arab Emirates\nAF                      Afghanistan\nAG                          Algeria\nAJ                       Azerbaijan \n```", "```py\ncountries.index.nunique()==countries.shape[0] \n```", "```py\nTrue \n```", "```py\nlocations[['locationid','latitude','stnelev']].head(10) \n```", "```py\n locationid\tlatitude\tstnelev\ncountryid                               \nAC\t\tACW00011604\t58\t\t18\nAE\t\tAE000041196\t25\t\t34\nAE\t\tAEM00041184\t26\t\t31\nAE\t\tAEM00041194\t25\t\t10\nAE\t\tAEM00041216\t24\t\t3\nAE\t\tAEM00041217\t24\t\t27\nAE\t\tAEM00041218\t24\t\t265\nAF\t\tAF000040930\t35\t\t3,366\nAF\t\tAFM00040911\t37\t\t378\nAF\t\tAFM00040938\t34\t\t977 \n```", "```py\n    stations = countries.join(locations)\n    stations[['locationid','latitude',\n    ...   'stnelev','country']].head(10) \n    ```", "```py\n     locationid\tlatitude\tstnelev  \\\n    countryid                                  \n    AC\t\tACW00011604\t58\t\t18  \n    AE\t\tAE000041196\t25\t\t34  \n    AE\t\tAEM00041184\t26\t\t31  \n    AE\t\tAEM00041194\t25\t\t10  \n    AE\t\tAEM00041216\t24\t\t3  \n    AE\t\tAEM00041217\t24\t\t27  \n    AE\t\tAEM00041218\t24\t\t265  \n    AF\t\tAF000040930\t35\t\t3,366  \n    AF\t\tAFM00040911\t37\t\t378  \n    AF\t\tAFM00040938\t34\t\t977  \n                               country \n    countryid                       \n    AC             Antigua and Barbuda \n    AE            United Arab Emirates \n    AE            United Arab Emirates \n    AE            United Arab Emirates \n    AE            United Arab Emirates \n    AE            United Arab Emirates \n    AE            United Arab Emirates \n    AF                     Afghanistan \n    AF                     Afghanistan \n    AF                     Afghanistan \n    ```", "```py\ncountries = pd.read_csv(\"data/ltcountries.csv\")\nlocations = pd.read_csv(\"data/ltlocations.csv\")\ndef checkmerge(dfleft, dfright, idvar):\n...   dfleft['inleft'] = \"Y\"\n...   dfright['inright'] = \"Y\"\n...   dfboth = pd.merge(dfleft[[idvar,'inleft']],\\\n...     dfright[[idvar,'inright']], on=[idvar], how=\"outer\")\n...   dfboth.fillna('N', inplace=True)\n...   print(pd.crosstab(dfboth.inleft, dfboth.inright))\n...   print(dfboth.loc[(dfboth.inleft=='N') | (dfboth.inright=='N')])\n...\ncheckmerge(countries.copy(), locations.copy(), \"countryid\") \n```", "```py\ninright\tN\tY\ninleft          \nN\t0\t1\nY\t2\t27472\n      countryid inleft inright\n9715         LQ      Y       N\n13103        ST      Y       N\n27474        FO      N       Y \n```", "```py\ncountries.loc[countries.countryid.isin([\"LQ\",\"ST\"])] \n```", "```py\n countryid                          country\n124          LQ    Palmyra Atoll [United States]\n195          ST                      Saint Lucia \n```", "```py\nlocations.loc[locations.countryid==\"FO\"] \n```", "```py\n locationid  latitude  longitude  stnelev   station countryid\n7363  FOM00006009        61         -7      102  AKRABERG        FO \n```", "```py\nstations = pd.merge(countries, locations, on=[\"countryid\"], how=\"left\")\nstations[['locationid','latitude',\n...   'stnelev','country']].head(10) \n```", "```py\n locationid\tlatitude\tstnelev\t\tcountry\n0\tACW00011604\t58\t\t18\t\tAntigua and Barbuda\n1\tAE000041196\t25\t\t34\t\tUnited Arab Emirates\n2\tAEM00041184\t26\t\t31\t\tUnited Arab Emirates\n3\tAEM00041194\t25\t\t10\t\tUnited Arab Emirates\n4\tAEM00041216\t24\t\t3\t\tUnited Arab Emirates\n5\tAEM00041217\t24\t\t27\t\tUnited Arab Emirates\n6\tAEM00041218\t24\t\t265\t\tUnited Arab Emirates\n7\tAF000040930\t35\t\t3,366\t\tAfghanistan\n8\tAFM00040911\t37\t\t378\t\tAfghanistan\n9\tAFM00040938\t34\t\t977\t\tAfghanistan \n```", "```py\nstations.shape \n```", "```py\n(27474, 7) \n```", "```py\nstations.loc[stations.countryid.isin([\"LQ\",\"ST\"])].isnull().sum() \n```", "```py\ncountryid\t0\ncountry\t0\nlocationid\t2\nlatitude\t2\nlongitude\t2\nstnelev\t2\nstation\t2\ndtype: int64 \n```", "```py\ncheckmerge(countries.copy(), locations.copy(), \"countryid\") \n```", "```py\n    import pandas as pd\n    cmacitations = pd.read_csv(\"data/cmacitations.csv\")\n    cmacreators = pd.read_csv(\"data/cmacreators.csv\") \n    ```", "```py\n    cmacitations['citation'] = cmacitations.citation.str[0:15]\n    cmacitations.head(10) \n    ```", "```py\n     itemid            citation\n    0   94979     Perkins, August\n    1   94979     Bayley, Frank W\n    2   94979     W. H. D. \"The F\n    3   94979     <em>The America\n    4   94979     \"Clevel'd Gets\n    5   94979     \"The Inaugurati\n    6   94979     Bell, Hamilton.\n    7   94979     Cleveland Museu\n    8   94979     \"Special Exhibi\n    9   94979     Dunlap, William \n    ```", "```py\n    cmacitations.shape \n    ```", "```py\n    (16053, 2) \n    ```", "```py\n    cmacitations.itemid.nunique() \n    ```", "```py\n    974 \n    ```", "```py\n    cmacreators['creator'] = cmacreators.creator.str[0:15]\n    cmacreators.loc[:,['itemid','creator','birth_year',\n     'creatorid']].head(10) \n    ```", "```py\n     itemid            creator   birth_year    creatorid\n    0   94979    John Singleton          1738         2409\n    1  102578    William Merritt         1849         3071\n    2   92937    George Bellows          1882         3005\n    3  151904    Thomas Eakins (         1844         4037\n    4  141639    Frederic Edwin          1826         2697\n    5  110180    Albert Pinkham          1847         3267\n    6  149112    Charles Sheeler         1883          889\n    7  126769    Henri Rousseau          1844         1804\n    8  149410    Paul Gauguin (F         1848         1776\n    9  135299    Vincent van Gog         1853         1779 \n    ```", "```py\n    cmacreators.shape \n    ```", "```py\n    (694, 8) \n    ```", "```py\n    cmacreators.itemid.nunique() \n    ```", "```py\n    618 \n    ```", "```py\n    cmacreators.creatorid.nunique() \n    ```", "```py\n    486 \n    ```", "```py\ncmacitations.itemid.value_counts().head(10) \n```", "```py\nitemid\n148758    182\n113164    127\n122351    125\n155783    119\n151904    112\n124245    108\n92937     104\n123168     98\n94979      98\n149112     97\nName: count, dtype: int64 \n```", "```py\n    cmacreators.itemid.value_counts().head(10) \n    ```", "```py\n    itemid\n    149386    4\n    142753    3\n    112932    3\n    149042    3\n    114538    3\n    140001    3\n    146797    3\n    149041    3\n    140427    3\n    109147    2\n    Name: count, dtype: int64 \n    ```", "```py\ndef checkmerge(dfleft, dfright, idvar):\n...   dfleft['inleft'] = \"Y\"\n...   dfright['inright'] = \"Y\"\n...   dfboth = pd.merge(dfleft[[idvar,'inleft']],\\\n...     dfright[[idvar,'inright']], on=[idvar], how=\"outer\")\n...   dfboth.fillna('N', inplace=True)\n...   print(pd.crosstab(dfboth.inleft, dfboth.inright))\n...\ncheckmerge(cmacitations.copy(), cmacreators.copy(), \"itemid\") \n```", "```py\ninright     N      Y\ninleft             \nN           0     14\nY        4277  12710 \n```", "```py\n    cmacitations.loc[cmacitations.itemid==124733] \n    ```", "```py\n     itemid             citation\n    14533      124733      Weigel, J. A. G\n    14534      124733      Winkler, Friedr\n    14535      124733       Francis, Henry\n    14536      124733      Kurz, Otto. <em\n    14537      124733      Minneapolis Ins\n    14538      124733      Pilz, Kurt. \"Ha\n    14539      124733      Koschatzky, Wal\n    14540      124733      Johnson, Mark M\n    14541      124733      Kaufmann, Thoma\n    14542      124733        Koreny, Fritz.\n    14543      124733      Achilles-Syndra\n    14544      124733       Schoch, Rainer,\n    14545      124733      DeGrazia, Diane\n    14546      124733       Dunbar, Burton \n    ```", "```py\n    cmacreators.loc[cmacreators.itemid==124733,\n    ...   ['itemid','creator','birth_year','title']] \n    ```", "```py\n     itemid              creator      birth_year                title\n    591  124733      Hans Hoffmann (           1545      Dead Blue Roller\n    592  124733      Albrecht Dürer            1471      Dead Blue Roller \n    ```", "```py\n    cma = pd.merge(cmacitations, cmacreators, on=['itemid'], how=\"outer\")\n    cma.set_index(\"itemid\", inplace=True)\n    cma.loc[124733, ['citation','creator','birth_year']] \n    ```", "```py\n     citation             creator    birth_year\n    itemid                                                      \n    124733     Weigel, J. A. G     Hans Hoffmann (          1545\n    124733     Weigel, J. A. G     Albrecht Dürer           1471\n    124733     Winkler, Friedr     Hans Hoffmann (          1545\n    124733     Winkler, Friedr     Albrecht Dürer           1471\n    124733      Francis, Henry     Hans Hoffmann (          1545\n    124733     Francis, Henry      Albrecht Dürer           1471\n    124733     Kurz, Otto. <em     Hans Hoffmann (          1545\n    124733     Kurz, Otto. <em     Albrecht Dürer           1471\n    124733     Minneapolis Ins     Hans Hoffmann (          1545\n    124733     Minneapolis Ins     Albrecht Dürer           1471\n    124733     Pilz, Kurt. \"Ha     Hans Hoffmann (          1545\n    124733     Pilz, Kurt. \"Ha     Albrecht Dürer           1471\n    124733     Koschatzky, Wal     Hans Hoffmann (          1545\n    124733     Koschatzky, Wal     Albrecht Dürer           1471\n    ... last 14 rows removed to save space \n    ```", "```py\n    import pandas as pd\n    countries = pd.read_csv(\"data/ltcountries.csv\")\n    locations = pd.read_csv(\"data/ltlocations.csv\") \n    ```", "```py\n    def checkmerge(dfleft, dfright, mergebyleft, mergebyright):\n    ...   dfleft['inleft'] = \"Y\"\n    ...   dfright['inright'] = \"Y\"\n    ...   dfboth = \\\n    ...     pd.merge(dfleft[[mergebyleft,'inleft']],\\\n    ...     dfright[[mergebyright,'inright']],\\\n    ...     left_on=[mergebyleft],\\\n    ...     right_on=[mergebyright], how=\"outer\")\n    ...   dfboth.fillna('N', inplace=True)\n    ...   print(pd.crosstab(dfboth.inleft,\n    ...     dfboth.inright))\n    ...   print(dfboth.loc[(dfboth.inleft=='N') | \\\n    ...     (dfboth.inright=='N')].head(20))\n    checkmerge(countries.copy(), locations.copy(), \"countryid\", \"countryid\") \n    ```", "```py\n    inright            N         Y\n    inleft                        \n    N                  0         1\n    Y                  2     27472\n          countryid inleft inright\n    7363         FO      N       Y\n    9716         LQ      Y       N\n    13104        ST      Y       N \n    ```", "```py\n    stations = pd.merge(countries, locations, left_on=[\"countryid\"], right_on=[\"countryid\"], how=\"left\")\n    stations[['locationid','latitude',\n    ...   'stnelev','country']].head(10) \n    ```", "```py\n     locationid      latitude      stnelev                 country\n    0  ACW00011604       57.7667         18.0     Antigua and Barbuda\n    1  AE000041196       25.3330         34.0    United Arab Emirates\n    2  AEM00041184       25.6170         31.0    United Arab Emirates\n    3  AEM00041194       25.2550         10.4    United Arab Emirates\n    4  AEM00041216       24.4300          3.0    United Arab Emirates\n    5  AEM00041217       24.4330         26.8    United Arab Emirates\n    6  AEM00041218       24.2620        264.9    United Arab Emirates\n    7  AF000040930       35.3170       3366.0             Afghanistan\n    8  AFM00040911       36.7000        378.0             Afghanistan\n    9  AFM00040938       34.2100        977.2             Afghanistan \n    ```", "```py\n    stations.shape \n    ```", "```py\n    (27474, 7) \n    ```"]