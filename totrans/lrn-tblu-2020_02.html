<html><head></head><body>
  <div id="_idContainer095">
    <h1 class="chapterNumber">2</h1>
    <h1 id="_idParaDest-34" class="chapterTitle">Connecting to Data in Tableau</h1>
    <p class="normal">Tableau offers the ability to connect to nearly any data source. It does this with a unique paradigm that leverages the power and efficiency of existing database engines or alternately extracts the data locally. We'll look at joins, blends, unions, and the brand new object model in <em class="italics">Chapter 13</em>, <em class="italics">Understanding the Tableau Data Model, Joins, and Blends</em>. In this chapter, we'll focus on essential concepts of how Tableau connects to and works with data. We'll cover the following topics:</p>
    <ul>
      <li class="list">The Tableau paradigm</li>
      <li class="list">Connecting to data</li>
      <li class="list">Managing data source metadata</li>
      <li class="list">Working with extracts instead of live connections</li>
      <li class="list">Filtering data</li>
    </ul>
    <p class="normal">We'll start by gaining an understanding of the underlying paradigm of how Tableau works with data.</p>
    <h1 id="_idParaDest-35" class="title">The Tableau paradigm</h1>
    <p class="normal">The unique <a id="_idIndexMarker095"/>and exciting experience of working with data in Tableau is a result of <strong class="bold">VizQL</strong> (<strong class="bold">Visual Query Language</strong>).</p>
    <p class="normal">VizQL was <a id="_idIndexMarker096"/>developed as a Stanford University research project, focusing on the natural ways that humans visually perceive the world and how that could be applied to data visualization. We naturally perceive differences in size, shape, spatial location, and color. VizQL allows Tableau to translate your actions, as you drag and drop fields of data in a visual environment, into a query language that defines how the data encodes those visual elements. You will never need to read, write, or debug VizQL. As you drag and drop fields onto various shelves defining size, color, shape, and spatial location, Tableau will generate the VizQL behind the scenes. This allows you to focus on visualizing data, not writing code!</p>
    <p class="normal">One of the benefits of VizQL is that it provides a common way of describing how the arrangement of various fields in a view defines a query related to the data. This common <a id="_idIndexMarker097"/>baseline can then be translated into numerous flavors of SQL, MDX, and <strong class="bold">Tableau Query Language </strong>(<strong class="bold">TQL</strong>, used for extracted data). Tableau will <a id="_idIndexMarker098"/>automatically perform the translation of VizQL into a native query to be run by the source data engine.</p>
    <p class="normal">In its simplest form, the Tableau paradigm of working with data looks like the following diagram:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_01.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.1: The basic Tableau paradigm for working with data</p>
    <p class="normal">Let's look at how this paradigm works in a practical example.</p>
    <h2 id="_idParaDest-36" class="title">A simple example</h2>
    <p class="normal">Open the <code class="Code-In-Text--PACKT-">Chapter 02 Starter.twbx</code> workbook located in the <code class="Code-In-Text--PACKT-">\Learning Tableau\Chapter 02</code> directory and navigate to the <code class="Code-In-Text--PACKT-">Tableau Paradigm</code> sheet. That view was created <a id="_idIndexMarker099"/>by dropping the <strong class="screen-text">Region</strong> dimension on <strong class="screen-text">Columns</strong> and the <strong class="screen-text">Sales</strong> measure on <strong class="screen-text">Rows</strong>. Here is a screenshot:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_02.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.2: This bar chart is the result of a query that returned four aggregate rows of data</p>
    <p class="normal">The view is defined by two fields. <strong class="screen-text">Region</strong> is the only dimension, which means it defines the level of detail in the view and slices the measure so that there will be a bar per region. <strong class="screen-text">Sales</strong> is used as a measure aggregated by summing each sale within each region. (Notice also that <strong class="screen-text">Region</strong> is discrete, resulting in column <strong class="bold">headers</strong> while <strong class="screen-text">Sales</strong> is continuous, resulting in an <strong class="bold">axis</strong>.)</p>
    <p class="normal">For the purpose of this example (although the principle is applicable to any data source), let's say you were connected live to a SQL Server database with the <code class="Code-In-Text--PACKT-">Superstore</code> data stored in a table. When you first create the preceding screenshot, Tableau generates a VizQL script, which is translated into an SQL script and sent to the SQL Server. The SQL Server database engine evaluates the query and returns aggregated results to Tableau, which are then rendered visually. </p>
    <p class="normal">The entire process would look something like the following diagram in Tableau's paradigm:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_03.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.3: Tableau generated the bar chart in the previous image using a paradigm like this</p>
    <p class="normal">There may <a id="_idIndexMarker100"/>have been hundreds, thousands, or even millions of rows of sales data in SQL Server. However, when SQL Server processes the query, it returns aggregate results. In this case, SQL Server returns only four aggregate rows of data to Tableauâ€”one row for each region.</p>
    <div class="packt_tip">
      <p>On occasion, a database administrator may want to find out what scripts are running against a certain database to debug performance issues or to determine more efficient indexing or data structures. Many databases supply profiling utilities or log execution of queries. In addition, you can find SQL or MDX generated by Tableau in the logs located in the <code class="Code-In-Text--PACKT-">My Tableau Repository\Logs</code> directory.</p>
      <p>You may also <a id="_idIndexMarker101"/>use Tableau's built-in <strong class="bold">Performance Recorder</strong> to locate the queries that have been executed. From the top menu, select <strong class="screen-text">Help | Settings and Performance | Start Performance Recording</strong>, then interact with a view, and finally, stop the recording from the menu. Tableau will open a dashboard that will allow you to see tasks, performance, and queries that were executed during the recording session. </p>
    </div>
    <p class="normal">To see the aggregate data that Tableau used to draw the view, press <em class="italics">Ctrl +</em> <em class="italics">A</em> to select all the bars, and <a id="_idIndexMarker102"/>then right-click one of them and select <strong class="screen-text">View Data</strong>.</p>
    <figure class="mediaobject"> <img src="../Images/B16021_02_04.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.4: Use the View Data tooltip option to see a summary or underlying data for a mark</p>
    <p class="normal">This will reveal a <strong class="screen-text">View Data</strong> window:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_05.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.5: The Summary tab displays the aggregate data Tableau used to render each mark in the view</p>
    <p class="normal">The <strong class="screen-text">View Data</strong> screen allows you to observe the data in the view. The <strong class="screen-text">Summary</strong> tab displays the <a id="_idIndexMarker103"/>aggregate-level data that was used to render the view. The <strong class="screen-text">Sales</strong> values here are the sum of sales for each region. When you click the <strong class="screen-text">Full Data </strong>(previously named <strong class="screen-text">Underlying</strong>) tab, Tableau will query the data source to retrieve all the records that make up the aggregate records. In this case, there are <strong class="screen-text">9,426</strong> underlying records, as indicated on the status bar in the lower-right corner of the following screenshot:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_06.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.6: The Full Data tab reveals the row-level data in the database</p>
    <p class="normal">Tableau did not need <strong class="screen-text">9,426</strong> records to draw the view and did not request them from the data source until the <strong class="screen-text">Full Data</strong> data tab was clicked.</p>
    <p class="normal">Database engines are optimized to perform aggregations on data. Typically, these database engines are also located on powerful servers. Tableau leverages the optimization and power of the underlying data source. In this way, Tableau can visualize massive datasets with relatively little local processing of the data.</p>
    <p class="normal">Additionally, Tableau will only query the data source when you make changes requiring a new <a id="_idIndexMarker104"/>query or a view refresh. Otherwise, it will use the aggregate results stored in a local cache, as illustrated here:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_07.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.7: The first rendering with a given set of fields queries the data source directly. Subsequent renderings will query the cache, even if the same fields are re-arranged in the view</p>
    <p class="normal">In the preceding example, the query with <strong class="screen-text">Region</strong> as a dimension and the sum of <strong class="screen-text">Sales</strong> as a measure will only be issued once to the data source. When the four rows of aggregated results are returned, they are stored in the cache. After the initial rendering, if you were to move <strong class="screen-text">Region</strong> to another visual encoding shelf, such as color, or <strong class="screen-text">Sales</strong> to a different visual encoding shelf, such as size, then Tableau will retrieve the aggregated rows from the cache and simply re-render the view.</p>
    <div class="packt_tip">
      <p>You can force Tableau to bypass the cache and refresh the data from a data source by pressing <em class="italics">F5</em> or selecting your data source from the <strong class="screen-text">Data</strong> menu and selecting <strong class="screen-text">Refresh</strong>. Do this any time you want a view to reflect the most recent changes in a live data source.</p>
    </div>
    <p class="normal">If you <a id="_idIndexMarker105"/>were to introduce new fields into the view that did not have cached results, Tableau would send a new query to the data source, retrieve the aggregated results, and add those results to the cache.</p>
    <h1 id="_idParaDest-37" class="title">Connecting to data</h1>
    <p class="normal">There is virtually no limit to the data that Tableau can visualize! Almost every new version of Tableau <a id="_idIndexMarker106"/>adds new native connectors. Tableau continues to <a id="_idIndexMarker107"/>add native connectors for cloud-based data. The <strong class="bold">web data connector</strong> allows you to write a connector for any online data you wish to retrieve. The <strong class="bold">Tableau Hyper API</strong> allows <a id="_idIndexMarker108"/>you to programmatically read and write extracts of data, enabling you to access data from any source and write it to a native Tableau format. Additionally, for any database without a built-in connection, Tableau gives <a id="_idIndexMarker109"/>you the ability to use a generic <strong class="bold">ODBC</strong> connection.</p>
    <p class="normal">You may have multiple data sources in the same workbook. Each source will show up under the <strong class="screen-text">Data</strong> tab on the left sidebar.</p>
    <div class="note">
      <p class="Information-Box--PACKT-">Although the terms are often used interchangeably, it is helpful to make a distinction. A <strong class="bold">connection</strong> technically <a id="_idIndexMarker110"/>refers to the connection made to data in a single location, such as tables in a single database, or files of the same type in the same directory structure. A <strong class="bold">data source</strong> may <a id="_idIndexMarker111"/>contain more than one connection that can be joined together, such as a table in SQL Server joined to tables in a Snowflake database that are joined to an Excel table. You can think about it this way: a Tableau workbook may contain one or more data sources and each data source may contain one or more connections. We'll maintain this distinction throughout the book.</p>
    </div>
    <p class="normal">This section will focus on a few practical examples of connecting to various data sources. There's no way to cover every possible type of connection but we will cover several that are representative <a id="_idIndexMarker112"/>of others. You may or may not have access to some of the data sources in the following examples. Don't worry if you aren't able to follow each example. Merely observe the differences.</p>
    <h2 id="_idParaDest-38" class="title">Connecting to data in a file</h2>
    <p class="normal">File-based <a id="_idIndexMarker113"/>data includes all sources of data where the data is stored in a file. File-based data sources include the following:</p>
    <ul>
      <li class="list"><strong class="bold">Extracts</strong>: A <code class="Code-In-Text--PACKT-">.hyper</code> or <code class="Code-In-Text--PACKT-">.tde</code> file <a id="_idIndexMarker114"/>containing data that was extracted from an original source.</li>
      <li class="list"><strong class="bold">Microsoft Access</strong>: An <code class="Code-In-Text--PACKT-">.mdb</code> or <code class="Code-In-Text--PACKT-">.accdb</code> database <a id="_idIndexMarker115"/>file created in Access.</li>
      <li class="list"><strong class="bold">Microsoft Excel:</strong> An <code class="Code-In-Text--PACKT-">.xls</code>, <code class="Code-In-Text--PACKT-">.xlsx</code>, or <code class="Code-In-Text--PACKT-">.xlsm</code> spreadsheet created in Excel. Multiple Excel sheets <a id="_idIndexMarker116"/>or sub-tables may be joined or unioned together in a single connection.</li>
      <li class="list"><strong class="bold">Text file</strong>: A delimited <a id="_idIndexMarker117"/>text file, most commonly <code class="Code-In-Text--PACKT-">.txt</code>, <code class="Code-In-Text--PACKT-">.csv</code>, or <code class="Code-In-Text--PACKT-">.tab</code>. Multiple text files in a single directory may be joined or unioned together in a single connection.</li>
      <li class="list"><strong class="bold">Local cube file</strong>: A <code class="Code-In-Text--PACKT-">.cub</code> file <a id="_idIndexMarker118"/>that contains multi-dimensional data. These files are typically exported from OLAP databases.</li>
      <li class="list"><strong class="bold">Adobe PDF</strong>: A<strong class="bold"> </strong><code class="Code-In-Text--PACKT-">.pdf</code> file that <a id="_idIndexMarker119"/>may contain tables of data that can be parsed by Tableau.</li>
      <li class="list"><strong class="bold">Spatial file</strong>: A wide <a id="_idIndexMarker120"/>variety of spatial formats are supported such as <code class="Code-In-Text--PACKT-">.kml</code>, <code class="Code-In-Text--PACKT-">.shp</code>, <code class="Code-In-Text--PACKT-">.tab</code>, <code class="Code-In-Text--PACKT-">.mif</code>, spatial JSON, and ESRI database files. These formats contain spatial objects that can be rendered by Tableau.</li>
      <li class="list"><strong class="bold">Statistical file</strong>: A <code class="Code-In-Text--PACKT-">.sav</code>, <code class="Code-In-Text--PACKT-">.sas7bdat</code>, <code class="Code-In-Text--PACKT-">.rda</code>, or <code class="Code-In-Text--PACKT-">.rdata</code> file generated by statistical tools, such <a id="_idIndexMarker121"/>as SAS or R.</li>
      <li class="list"><strong class="bold">JSON</strong> <strong class="bold">file</strong>: A <code class="Code-In-Text--PACKT-">.json</code> file <a id="_idIndexMarker122"/>that contains data in JSON format.</li>
    </ul>
    <p class="normal">In addition to those mentioned previously, you can connect to Tableau files to import connections that you have saved in another Tableau workbook (<code class="Code-In-Text--PACKT-">.twb</code> or <code class="Code-In-Text--PACKT-">.twbx</code>). The connection will be imported, and changes will only affect the current workbook.</p>
    <p class="normal">Follow this example to see a connection to an Excel file:</p>
    <ol>
      <li class="list">Navigate to the <strong class="screen-text">Connect to Excel</strong> sheet in the <code class="Code-In-Text--PACKT-">Chapter 02 Starter.twbx</code> workbook.</li>
      <li class="list">From the menu, select <strong class="screen-text">Data | New Data Source</strong> and select <strong class="screen-text">Microsoft Excel</strong> from the list of possible connections.</li>
      <li class="list">In the open dialogue, open the <code class="Code-In-Text--PACKT-">Superstore.xlsx</code> file from the <code class="Code-In-Text--PACKT-">\Learning Tableau\Chapter 02</code> directory. Tableau will open the <strong class="screen-text">Data Source</strong> screen. You should see the two sheets of the Excel document listed on the left.</li>
    
      <li class="list" value="4">Double-click the <strong class="screen-text">Orders</strong> sheet and then the <strong class="screen-text">Returns</strong> sheet. Tableau will prompt you with an <strong class="screen-text">Edit Relationship</strong> dialog. We'll cover relationships in depth in <em class="italics">Chapter 13</em>, <em class="italics">Understanding the Tableau Data Model, Joins, and Blends</em>. For now, accept the defaults by closing the dialog.</li>
    </ol>
    <p class="normal">Your data <a id="_idIndexMarker123"/>source screen should look similar to the following screenshot:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_08.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.8: The data source screen with two objects (Orders and Returns)</p>
    <p class="normal">Take some time to familiarize yourself with the <strong class="screen-text">Data Source</strong> screen interface, which has the following features (numbered in the preceding screenshot):</p>
    <ul>
      <li class="list"><strong class="screen-text">Toolbar</strong>: The toolbar has a few of the familiar controls, including undo, redo, and save. It also includes the option to refresh the current data source.</li>
      <li class="list"><strong class="screen-text">Connections</strong>: All the connections in the current data source. Click <strong class="screen-text">Add</strong> to add a new connection to the current data source. This allows you to join data across different connection types. Each connection will be color-coded so that you can distinguish what data is coming from which connection.</li>
      <li class="list"><strong class="screen-text">Sheets (or Tables)</strong>: This lists all the tables of data available for a given connection. This includes sheets, sub-tables, and named ranges for Excel; tables, views, and stored procedures for relational databases; and other connection-dependent options, such as <strong class="bold">New Union</strong> or <strong class="bold">Custom SQL</strong>.</li>
      <li class="list"><strong class="bold">Data Source Name</strong>: This is the name of the currently selected data source. You may select a different data source using the drop-down arrow next to the database icon. You may click the name of the data source to edit it.</li>
      <li class="list"><strong class="bold">Object / Data Model Canvas</strong>: Drop sheets and tables from the left into this area to make them part of the connection. You may add additional tables by dragging and dropping or double-clicking them. Each will be added as an object to the object model. You may <a id="_idIndexMarker124"/>also add tables as unions or double-click an object to edit the underlying tables and joins. We'll cover the details extensively in <em class="italics">Chapter 13</em>, <em class="italics">Understanding the Tableau Data Model, Joins, and Blends</em>. For now, simply note that Orders and Returns are related together by the Order ID.</li>
      <li class="list"><strong class="screen-text">Live</strong><strong class="bold"> or </strong><strong class="screen-text">Extract</strong><strong class="bold"> Options</strong>: For many data sources, you may choose whether you would like to have a live connection or an extracted connection. We'll look at these in further detail later in the chapter.</li>
      <li class="list"><strong class="bold">Data Source </strong><strong class="screen-text">Filters</strong>: You may add filters to the data source. These will be applied at the data-source level, and thus to all views of the data using this data source in the workbook.</li>
      <li class="list"><strong class="bold">Preview Pane Options</strong>: These options allow you to specify whether you'd like to see a preview of the data or a list of metadata, and how you would like to preview the data (examples include alias values, hidden fields shown, and how many rows you'd like to preview).</li>
      <li class="list"><strong class="bold">Preview Pane/Metadata View</strong>: Depending on your selection in the options, this space either displays a preview of data or a list of all fields with additional metadata. Notice that these views give you a wide array of options, such as changing data types, hiding or renaming fields, and applying various data transformation functions. We'll consider some of these options in this and later chapters.</li>
    </ul>
    <div class="packt_tip">
      <p>Once you have created and configured your data source, you may click any sheet to start using it.</p>
    </div>
    <p class="normal">Conclude this exercise with the following steps:</p>
    <ol>
      <li class="list" value="1">Click the data source name to edit the text and rename the data source to <code class="Code-In-Text--PACKT-">Orders and Returns</code>.</li>
    </ol>
    <ol>
      <li class="list" value="2">Navigate to the <strong class="screen-text">Connect to Excel</strong> sheet and, using the <code class="Code-In-Text--PACKT-">Orders and Returns</code> data source, create a <a id="_idIndexMarker125"/>time series showing <strong class="screen-text">Returns (Count)</strong> by <strong class="screen-text">Return Reason</strong>. Your view should look like the following screenshot:
    <figure class="mediaobject"> <img src="../Images/B16021_02_09.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.9: The number of returns by return reason</p></li>
    </ol>
    <p class="normal">If you need to edit the connection at any time, select <strong class="screen-text">Data</strong> from the menu, locate your connection, and then select <strong class="screen-text">Edit Data Source...</strong>. Alternately, you may right-click any data source under the <strong class="screen-text">Data</strong> tab on the left sidebar and select <strong class="screen-text">Edit Data Source...</strong>, or click the <strong class="screen-text">Data Source</strong> tab in the lower-left corner. You may access the data source screen at any time by clicking the <strong class="screen-text">Data Source</strong> tab in the lower-left corner of Tableau Desktop.</p>
    <h2 id="_idParaDest-39" class="title">Connecting to data on a server</h2>
    <p class="normal">Database servers, such as SQL Server, Snowflake, Vertica, and Oracle, host data on one or more server <a id="_idIndexMarker126"/>machines and use powerful database engines to store, aggregate, sort, and serve data based on queries from client applications. Tableau can leverage the capabilities of these servers to retrieve data for visualization and analysis. Alternately, data can be extracted from these sources and stored in an extract.</p>
    <p class="normal">As an example of connecting to a server data source, we'll demonstrate connecting to SQL Server. If you have access to a server-based data source, you may wish to create a new data source and explore the details. However, this specific example is not included in the workbook in this chapter.</p>
    <p class="normal">As soon as the Microsoft SQL Server connection is selected, the interface displays options for some initial configuration as follows:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_10.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.10: The connection editor for Microsoft SQL Server</p>
    <p class="normal">A connection to SQL Server requires the <strong class="screen-text">Server</strong> name, as well as authentication information.</p>
    <p class="normal">A database administrator can configure SQL Server to <strong class="screen-text">Use Windows Authentication</strong> or a SQL Server <a id="_idIndexMarker127"/>username and password. With SQL Server, you can also optionally allow reading uncommitted data. This can potentially improve performance but may also lead to unpredictable results if data is being inserted, updated, or deleted at the same time as Tableau is querying. Additionally, you may specify SQL to be run at connect time using the <strong class="screen-text">Initial SQL...</strong> link in the lower-left corner.</p>
    <div class="note">
      <p class="Information-Box--PACKT-">In order to maintain high standards of security, Tableau will not save a password as part of a data source connection. This means that if you share a workbook using a live connection with someone else, they will need to have credentials to access the data. This also means that when you first open the workbook, you will need to re-enter your password for any connections requiring a password.</p>
    </div>
    <p class="normal">Once you click the orange <strong class="screen-text">Sign In</strong> button, you will see a screen that is very similar to the connection screen you saw for Excel. The main difference is on the left, where you have an option for selecting a <strong class="screen-text">Database</strong>, as shown in the following screenshot:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_11.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.11: Once connected to a database, Tableau will display tables, views, and stored procedures as options to add to the object model</p>
    <p class="normal">Once you've <a id="_idIndexMarker128"/>selected a database, you will see the following:</p>
    <ul>
      <li class="list"><strong class="bold">Table</strong>: This shows any data tables or views contained in the selected database.</li>
      <li class="list"><strong class="bold">New Custom SQL</strong>: You may write your own custom SQL scripts and add them as tables. You may join these as you would any other table or view.</li>
      <li class="list"><strong class="bold">New Union</strong>: You may union together tables in the database. Tableau will match fields based on name and data type, and you may additionally merge fields as needed.</li>
      <li class="list"><strong class="bold">Stored Procedures</strong>: You may use a stored procedure that returns a table of data. You will be given the option of setting values for stored procedure parameters or using or creating a Tableau parameter to pass values.</li>
    </ul>
    <p class="normal">Once you have finished configuring the connection, click a tab for any sheet to begin visualizing the data.</p>
    <h2 id="_idParaDest-40" class="title">Using extracts</h2>
    <p class="normal">Any data source <a id="_idIndexMarker129"/>that is using an extract will have a distinctive icon that indicates the data has been pulled from an original source into an extract, as shown in the following screenshot:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_12.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.12: The icon next to a data source indicates whether it is extracted or not</p>
    <p class="normal">The first data connection in the preceding data pane is extracted, while the second is not. After an extract has been created, you may choose to use the extract or not. When you right-click a data source (or <strong class="screen-text">Data</strong> from the menu and then the data source), you will see the following menu options:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_13.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.13: The context menu for a data connection in the Data pane with Extract options numbered</p>
    <p class="normal">Let's cover them in more detail:</p>
    <ol>
      <li class="list" value="1"><strong class="screen-text">Refresh</strong>: The <strong class="screen-text">Refresh</strong> option under the data source simply tells Tableau to refresh the <a id="_idIndexMarker130"/>local cache of data. With a live data source, this would re-query the underlying data. With an extracted source, the cache is cleared and the extract is required, but this <strong class="screen-text">Refresh</strong> option does not update the extract from the original source. To do that, use <strong class="screen-text">Refresh</strong> under the <strong class="screen-text">Extract</strong> sub-menu (see number 4 in this list).</li>
      <li class="list"><strong class="screen-text">Extract Data...</strong>: This creates a new extract from the data source (replacing an existing extract if it exists).</li>
      <li class="list"><strong class="screen-text">Use Extract</strong>: This option is enabled if there is an extract for a given data source. Unchecking the option will tell Tableau to use a live connection instead of the extract. The extract will not be removed and may be used again by checking this option at any time. If the original data source is not available to this workbook, Tableau will ask where to find it.</li>
      <li class="list"><strong class="screen-text">Refresh</strong>: This <strong class="screen-text">Refresh</strong> option refreshes the extract with data from the original source. It does not optimize the extract for some changes you make (such as hiding fields or creating new calculations).</li>
      <li class="list"><strong class="screen-text">Append Data from File...</strong> or <strong class="screen-text">Append Data from Data Sourceâ€¦</strong>:These options allow you to append additional files or data sources to an existing extract, provided they have the same exact data structure as the original source. This adds rows to your existing extract; it will not add new columns.</li>
      <li class="list"><strong class="screen-text">Compute Calculations Now</strong>: This will restructure the extract, based on changes you've made since originally creating the extract, to make it as efficient as possible. Certain calculated fields may be <em class="italics">materialized </em>(that is, calculated once so that the <a id="_idIndexMarker131"/>resulting value can be stored) and newly hidden columns or deleted calculations will be removed from the extract.</li>
      <li class="list"><strong class="screen-text">Remove</strong>: This removes the definition of the extract, optionally deletes the extract file, and resumes a live connection to the original data source.</li>
      <li class="list"><strong class="screen-text">History</strong>: This allows you to view the history of the extract and refreshes.</li>
    
      <li class="list" value="9"><strong class="screen-text">Properties</strong>: This enables you to view the properties of the extract, such as the location, underlying source, filters, and row limits.</li>
    </ol>
    <p class="normal">Let's next consider the performance ramifications of using extracts.</p>
    <h2 id="_idParaDest-41" class="title">Connecting to data in the cloud</h2>
    <p class="normal">Certain data <a id="_idIndexMarker132"/>connections are made to data that is hosted in <a id="_idIndexMarker133"/>the cloud. These include <strong class="bold">Amazon RDS</strong>, <strong class="bold">Google BigQuery</strong>, <strong class="bold">Microsoft SQL Azure</strong>, <strong class="bold">Snowflake</strong>, <strong class="bold">Salesforce</strong>, <strong class="bold">Google Sheets</strong>, and many others. It is beyond the <a id="_idIndexMarker134"/>scope of this <a id="_idIndexMarker135"/>book to cover each <a id="_idIndexMarker136"/>connection <a id="_idIndexMarker137"/>in depth, but as an example of a cloud <a id="_idIndexMarker138"/>data source, we'll consider connecting to Google Sheets.</p>
    <p class="normal">Google Sheets allows users to create and maintain spreadsheets of data online. Sheets may be shared and collaborated on by many different users. Here, we'll walk through an example of connecting to a sheet that is shared via a link.</p>
    <p class="normal">To follow the example, you'll need a free Google account. With your credentials, follow these steps:</p>
    <ol>
      <li class="list" value="1">Click the <strong class="screen-text">Add new data source</strong> button on the toolbar, as shown here:<figure class="mediaobject"><img src="../Images/B16021_02_14.png" alt=""/></figure>
        <p class="packt_figref">Figure 2.14: The Add Data button</p>
      </li>
      <li class="list">Select <strong class="screen-text">Google Sheets</strong> from the list of possible data sources. You may use the search <a id="_idIndexMarker139"/>box to quickly narrow the list.</li>
    </ol>
    <ol>
      <li class="list" value="3">On the next screen, sign in to your Google account and allow Tableau Desktop the appropriate permissions. You will then be presented with a list of all your Google Sheets, along with preview and search capabilities, as shown in the following screenshot:
    <figure class="mediaobject"><img src="../Images/B16021_02_15.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.15: You may select any Google Sheet you have permissions to view or you may enter the URL for a shared sheet</p></li>
    </ol>
    <ol>
      <li class="list" value="4">Enter the <a id="_idIndexMarker140"/>following URL (for convenience, it is included in the <code class="Code-In-Text--PACKT-">Chapter 02 Starter</code> workbook in the <strong class="screen-text">Connect to Google Sheets</strong> tab, and may be copied and pasted) into the search box and click the <strong class="screen-text">Search</strong> button: <a href="https://docs.google.com/spreadsheets/d/1fWMGkPt0o7sdbW50tG4QLSZDwkjNO9X0mCkw-LKYu1A/edit?usp=sharing"><span class="url">https://docs.google.com/spreadsheets/d/1fWMGkPt0o7sdbW50tG4QLSZDwkjNO9X0mCkw-LKYu1A/edit?usp=sharing</span></a>:</li>
      <li class="list">Select the resulting <code class="Code-In-Text--PACKT-">Superstore</code> sheet in the list and then click the <strong class="screen-text">Connect</strong> button. You should now see the <strong class="screen-text">Data Source</strong> screen.</li>
      <li class="list">Click the <strong class="screen-text">Data Source</strong> name to rename it to <code class="Code-In-Text--PACKT-">Superstore (Google Sheets)</code>:<figure class="mediaobject"><img src="../Images/B16021_02_16.png" alt=""/></figure>
        <p class="packt_figref">Figure 2.16: Renaming a Data Source</p>
      </li>
      <li class="list">For the <a id="_idIndexMarker141"/>purpose of this example, switch the connection option from <strong class="screen-text">Live</strong> to <strong class="screen-text">Extract</strong>. When connecting to your own Google Sheets data, you may choose either <strong class="screen-text">Live</strong> or <strong class="screen-text">Extract</strong>:<figure class="mediaobject"><img src="../Images/B16021_02_17.png" alt=""/></figure>
        <p class="packt_figref">Figure 2.17: Switch between Live and Extract, Edit extract options, and Add Filters</p>
      </li>
      <li class="list">Click the tab for the <strong class="screen-text">Connect to Google Sheets</strong> sheet. You will be prompted for a location to save the extract. Accept the default name and save it in the <code class="Code-In-Text--PACKT-">Learning Tableau\Chapter 02</code> directory (selecting <strong class="screen-text">Yes</strong> to overwrite the existing file if needed). The data should be extracted within a few seconds.</li>
    </ol>
    <ol>
      <li class="list" value="9">Create a filled map of <strong class="screen-text">Profit</strong> by <strong class="screen-text">State</strong>, with <strong class="screen-text">Profit</strong> defining the <strong class="screen-text">Color</strong> and <strong class="screen-text">Label</strong>:
    <figure class="mediaobject"><img src="../Images/B16021_02_18.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.18: The filled map demonstrates the ability to connect to a cloud-based data source</p></li>
    </ol>
    <div class="note">
      <p class="Information-Box--PACKT-">If your location is outside the United States, you may need to change your regional settings for Tableau to properly show the states in the map. Use the menu and select <strong class="screen-text">File</strong> | <strong class="screen-text">Workbook Locale</strong> | <strong class="screen-text">More</strong> and select <strong class="screen-text">English (United States)</strong>.</p>
    </div>
    <p class="normal">Now that <a id="_idIndexMarker142"/>we've seen a few specific examples of connecting to data, let's consider some shortcuts and how to manage our data sources.</p>
    <h2 id="_idParaDest-42" class="title">Shortcuts for connecting to data</h2>
    <p class="normal">You can <a id="_idIndexMarker143"/>make certain connections very quickly. These options will allow you to begin analyzing more quickly:</p>
    <ul>
      <li class="list">Paste data from the clipboard. If you have copied data in your system's clipboard from any source (for example, a spreadsheet, a table on a web page, or a text file), you can then paste the data directly into Tableau. This can be done using <em class="italics">Ctrl + V</em>, or <strong class="screen-text">Data | Paste Data</strong> from the menu. The data will be stored as a file and you will be alerted to its location when you save the workbook.</li>
      <li class="list">Select<strong class="bold"> </strong><strong class="screen-text">File | Open</strong><strong class="bold"> </strong>from the menu. This will allow you to open any data file that Tableau supports, such as text files, Excel files, Access files (not available on macOS), spatial files, statistical files, JSON, and even offline cube (<code class="Code-In-Text--PACKT-">.cub</code>) files.</li>
      <li class="list">Drag and <a id="_idIndexMarker144"/>drop a file from Windows Explorer or Finder onto the Tableau workspace. Any valid file-based data source can be dropped onto the Tableau workspace or even the Tableau shortcut on your desktop or taskbar.</li>
      <li class="list">Duplicate an existing data source. You can duplicate an existing data source by right-clicking and selecting <strong class="screen-text">Duplicate</strong>.</li>
    </ul>
    <p class="normal">These shortcuts provide a quick way for analyzing the data you need. Let's turn our attention to managing the data sources.</p>
    <h1 id="_idParaDest-43" class="title">Managing data source metadata</h1>
    <p class="normal">Data sources <a id="_idIndexMarker145"/>in Tableau store information about the connection(s). In addition to the connection itself (for example, database server name, database, and/or filenames), the data source also contains information about all the fields available (such as field name, data type, default format, comments, and aliases). Often, this <em class="italics">data about the data</em> is referred to as <strong class="bold">metadata</strong>.</p>
    <p class="normal">Right-clicking <a id="_idIndexMarker146"/>a field in the data pane reveals a menu of metadata options. Some of these options will be demonstrated in a later exercise; others will be explained throughout the book. These are some of the options available via right-clicking:</p>
    <ul>
      <li class="list">Renaming the field</li>
      <li class="list">Hiding the field</li>
      <li class="list">Changing aliases for values of a non-date dimension</li>
      <li class="list">Creating calculated fields, groups, sets, bins, or parameters</li>
      <li class="list">Splitting the field</li>
      <li class="list">Changing the default use of a date or numeric field to either discrete or continuous</li>
      <li class="list">Redefining the field as a dimension or a measure</li>
      <li class="list">Changing the data type of the field</li>
      <li class="list">Assigning a geographic role to the field</li>
      <li class="list">Changing defaults for how a field is displayed in a visualization, such as the default colors and shapes, number or date format, sort order (for dimensions), or type of aggregation (for measures)</li>
      <li class="list">Adding a default comment for a field (which will be shown as a tooltip when hovering over a field in the data pane, or shown as part of the description when <strong class="screen-text">Describe...</strong> is selected from the menu)</li>
      <li class="list">Adding <a id="_idIndexMarker147"/>or removing the field from a hierarchy</li>
    </ul>
    <div class="packt_tip">
      <p>Metadata options that relate to the visual display of the field, such as default sort order or default number format, define the overall default for a field. However, you can override the defaults in any individual view by right-clicking the active field on the shelf and selecting the desired options. </p>
    </div>
    <p class="normal">To see how this works, use the filled map view of <code class="Code-In-Text--PACKT-">Profit</code> by <code class="Code-In-Text--PACKT-">State</code> that you created in the <strong class="screen-text">Connect to Google Sheets</strong> view. If you did not create this view, you may use the <strong class="screen-text">Orders and Returns</strong> data source, though the resulting view will be slightly different. With the filled map in front of you, follow these steps:</p>
    <ol>
      <li class="list" value="1">Right-click the <strong class="screen-text">Profit</strong> field in the data pane and select <strong class="screen-text">Default Properties</strong> | <strong class="screen-text">Number Format...</strong>. The resulting dialog gives you many options for numeric format.</li>
      <li class="list">Set the number format to <strong class="screen-text">Currency (Custom)</strong> with <code class="Code-In-Text--PACKT-">0</code> <strong class="screen-text">Decimal places</strong> and the <strong class="screen-text">Display Units</strong> in <code class="Code-In-Text--PACKT-">Thousands (K)</code>. After clicking <strong class="screen-text">OK</strong>, you should notice that the labels on the map have updated to include currency notation:
    <figure class="mediaobject"><img src="../Images/B16021_02_19.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.19: Editing the default number format of a field</p></li>
    </ol>
    <ol>
      <li class="list" value="3">Right-click <a id="_idIndexMarker148"/>the <strong class="screen-text">Profit</strong> field again and select <strong class="screen-text">Default properties</strong> | <strong class="screen-text">Color...</strong>. The resulting dialog gives you an option to select and customize the default color encoding of the <strong class="screen-text">Profit</strong> field. Experiment with various palettes and settings. Notice that every time you click the <strong class="screen-text">Apply</strong> button, the visualization updates.</li>
    </ol>
    <div class="packt_tip">
      <p>Diverging palettes (palettes that blend from one color to another) work particularly well for fields such as <strong class="screen-text">Profit</strong>, which can have negative and positive values. The default center of <code class="Code-In-Text--PACKT-">0</code> allows you to easily tell what values are positive or negative based on the color shown.</p>
    </div>
    <figure class="mediaobject"><img src="../Images/B16021_02_20.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.20: Customizing color</p>
    <p class="normal">Because you <a id="_idIndexMarker149"/>have set the default format for the field at the data-source level, any additional views you create using <strong class="screen-text">Profit</strong> will include the default formatting you specified.</p>
    <div class="packt_tip">
      <p>Consider using color blind-safe colors in your visualizations. Orange and blue are usually considered a color blind-safe alternative to red and green. Tableau also includes a discrete color blind-safe palette. Additionally, consider adjusting the intensity of the colors, using labels, or different visualizations to make your visualizations more accessible.</p>
    </div>
    <h1 id="_idParaDest-44" class="title">Working with extracts instead of live connections</h1>
    <p class="normal">Nearly all <a id="_idIndexMarker150"/>data sources allow the option of either connecting live or extracting the data. A few cloud-based data sources require an extract. Conversely, OLAP data sources cannot be extracted and require live connections.</p>
    <p class="normal">Extracts extend the way in which Tableau works with data. Consider the following diagram:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_21.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.21: Data from the original Data Source is extracted into a self-contained snapshot of the data</p>
    <p class="normal">When using <a id="_idIndexMarker151"/>a live connection, Tableau issues queries directly to the data source (or uses data in the cache, if possible). When you extract the data, Tableau pulls some or all of the data from the original source and stores it in an extract file. Prior to version 10.5, Tableau used a Tableau Data Extract (<code class="Code-In-Text--PACKT-">.tde</code>) file. Starting with version 10.5, Tableau uses Hyper extracts (<code class="Code-In-Text--PACKT-">.hyper</code>) and will convert <code class="Code-In-Text--PACKT-">.tde</code> files to <code class="Code-In-Text--PACKT-">.hyper</code> as you update older workbooks.</p>
    <p class="normal">The fundamental paradigm of how Tableau works with data does not change, but you'll notice that Tableau is now querying and getting results from the extract. Data can be retrieved from <a id="_idIndexMarker152"/>the source again to refresh the extract. Thus, each extract is a snapshot of the data source at the time of the latest refresh. Extracts offer the benefit of being portable and extremely efficient.</p>
    <h2 id="_idParaDest-45" class="title">Creating extracts</h2>
    <p class="normal">Extracts can <a id="_idIndexMarker153"/>be created in multiple ways, as follows:</p>
    <ul>
      <li class="list">Select <strong class="screen-text">Extract</strong> on the <strong class="screen-text">Data Source</strong> screen as follows. The <strong class="screen-text">Edit...</strong> link will allow you to configure the extract:
    <figure class="mediaobject"><img src="../Images/B16021_02_22.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.22: Select either Live or Extract for a connection and configure options for the extract by clicking Edit.</p>
	</li>
    </ul>
    <ul>
      <li class="list">Select the data source from the <strong class="screen-text">Data</strong> menu, or right-click the data source on the data pane and select <strong class="screen-text">Extract data</strong>. You will be given a chance to set configuration options for the extract, as demonstrated in the following screenshot:
    <figure class="mediaobject"><img src="../Images/B16021_02_23.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.23: The Extract dataâ€¦ option</p>
		</li>
    </ul>
    <ul>
      <li class="list">Developers may create an extract using the Tableau Hyper API. This API allows you to use Python, Java, C++, or C#/.NET to programmatically read and write Hyper extracts. The details of this approach are beyond the scope of this book, but <a id="_idIndexMarker154"/>documentation is readily available on Tableau's website at <a href="https://help.tableau.com/current/api/hyper_api/en-us/index.html"><span class="url">https://help.tableau.com/current/api/hyper_api/en-us/index.html</span></a>.</li>
      <li class="list">Certain tools, such as <code class="Code-In-Text--PACKT-">Alteryx</code> or <code class="Code-In-Text--PACKT-">Tableau Prep</code>, can output Tableau extracts.</li>
    </ul>
    <p class="normal">You'll have <a id="_idIndexMarker155"/>quite a few options for configuring an extract. To edit these options, select <strong class="screen-text">Extract</strong> and then <strong class="screen-text">Editâ€¦</strong> on the <strong class="screen-text">Data Source</strong> screen or <strong class="screen-text">Extract dataâ€¦</strong> from the context menu of a connection in the <strong class="screen-text">Data</strong> pane. When you configure an extract, you will be prompted to select certain options, as shown here:</p>
    <figure class="mediaobject"> <img src="../Images/B16021_02_24.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.24: The Extract Data dialog gives quite a few options for how to configure the extract</p>
    <p class="normal">You have a great deal of control when configuring an extract. Here are the various options, and the impact your choices will make on performance and flexibility:</p>
    <ul>
      <li class="list">Depending on the data source and object model you've created, you may select between <strong class="screen-text">Logical Tables</strong> and <strong class="screen-text">Physical Tables</strong>. We'll explore the details in <em class="italics">Chapter 13</em>, <em class="italics">Understanding the Tableau Data Model, Joins, and Blends</em>.</li>
      <li class="list">You may optionally add extract <strong class="screen-text">Filters</strong>, which limit the extract to a subset of the original source. In this example only, records where <strong class="screen-text">Region</strong> is <strong class="screen-text">Central</strong> or <strong class="screen-text">South</strong> and where <strong class="screen-text">Category</strong> is <strong class="screen-text">Office Machines</strong> will be included in the extract.</li>
      <li class="list">You may aggregate an extract by checking the box. This means that data will be rolled up to the level of visible dimensions and, optionally, to a specified date level, such as year or month.<div class="note">
          <p class="Information-Box--PACKT-"><strong class="bold">Visible fields</strong> are those <a id="_idIndexMarker156"/>that are shown in the data pane. You may hide a field from the Data Source screen or from the data pane by right-clicking a field and selecting <strong class="screen-text">Hide</strong>. This option will be disabled if the field is used in any view in the workbook. <code class="Code-In-Text--PACKT-">Hidden</code> fields are not available to be used in a view. <code class="Code-In-Text--PACKT-">Hidden</code> fields are not included in an extract as long as they are hidden prior to creating or optimizing the extract.</p>
        </div>
      </li>
    </ul>
    <p class="normal">In the preceding <a id="_idIndexMarker157"/>example, if only the <strong class="screen-text">Region</strong> and <strong class="screen-text">Category</strong> dimensions were visible, the resulting extract would only contain two rows of data (one row for <strong class="bold">Central</strong> and another for <strong class="bold">South</strong>). Additionally, any measures would be aggregated at the <strong class="screen-text">Region</strong>/<strong class="screen-text">Category</strong> level and would be done with respect to the <strong class="screen-text">Extract</strong> filters. For example, <strong class="screen-text">Sales</strong> would be rolled up to the sum of sales in <strong class="screen-text">Central</strong>/<strong class="screen-text">Office Machines</strong> and <strong class="screen-text">South</strong>/<strong class="screen-text">Office Machines</strong>. All measures are aggregated according to their default aggregation.</p>
    <p class="normal">You may adjust the number of rows in the extract by including all rows or a sampling of the top <em class="italics">n</em> rows in the dataset. If you select all rows, you can indicate an incremental refresh. If your source data incrementally adds records, and you have a field such as an identity column or date field that can be used reliably to identify new records as they are added, then an incremental extract can allow you to add those records to the extract without recreating the entire extract. In the preceding example, any new rows where <strong class="bold">Row ID</strong> is higher than the highest value of the previous extract refresh would be included in the next incremental refresh.</p>
    <div class="packt_tip">
      <p>Incremental refreshes can be a great way to deal with large volumes of data that grow over time. However, use incremental refreshes with care, because the incremental refresh will only add new rows of data based on the field you specify. You won't get changes to existing rows, nor will rows be removed if they were deleted at the source. You will also miss any new rows if the value for the incremental field is less than the maximum value in the existing extract.</p>
    </div>
    <p class="normal">Now that <a id="_idIndexMarker158"/>we've considered how to create and configure extracts, let's turn our attention to using them.</p>
    <h2 id="_idParaDest-46" class="title">Performance</h2>
    <p class="normal">There <a id="_idIndexMarker159"/>are two types <a id="_idIndexMarker160"/>of extracts in Tableau:</p>
    <ul>
      <li class="list">Tableau Data Extracts (<code class="Code-In-Text--PACKT-">.tde</code> files): prior to Tableau 10.5, these were the only type of extract available.</li>
      <li class="list">Hyper (<code class="Code-In-Text--PACKT-">.hyper</code> files) are available in Tableau 10.5 or later.</li>
    </ul>
    <p class="normal">Depending on scale and volume, both <code class="Code-In-Text--PACKT-">.hyper</code> and <code class="Code-In-Text--PACKT-">.tde</code> extracts may perform faster than most traditional live database connections. For the most part, Tableau will default to creating Hyper extracts. Unless you are using older versions of Tableau, there is little reason to use the older <code class="Code-In-Text--PACKT-">.tde</code>. The incredible performance of Tableau extracts is based on several factors, including the following:</p>
    <ul>
      <li class="list">Hyper extracts make use of a hybrid of OLTP and OLAP models and the engine determines the optimal query. Tableau Data Extracts are columnar and very efficient to query.</li>
      <li class="list">Extracts are structured so they can be loaded quickly into memory without additional processing and moved between memory and disk storage, so the size is not limited to the amount of RAM available, but RAM is efficiently used to boost performance.</li>
      <li class="list">Many calculated fields are materialized in the extract. The pre-calculated value stored in the extract can often be read faster than executing the calculation every time the query is executed. Hyper extracts extend this by potentially materializing many aggregations.</li>
    </ul>
    <p class="normal">You may choose to use extracts to increase performance over traditional databases. To maximize your performance gain, consider the following actions:</p>
    <ul>
      <li class="list">Prior to creating the extract, hide unused fields. If you have created all desired visualizations, you can click the <strong class="screen-text">Hide Unused Fields</strong> button on the <strong class="screen-text">Extract</strong> dialog to hide all fields not used in any view or calculation.</li>
      <li class="list">If possible, use a subset of data from the original source. For example, if you have historical data for the last 10 years but only need the last two years for analysis, then filter the extract by the <code class="Code-In-Text--PACKT-">Date</code> field.</li>
      <li class="list">Optimize <a id="_idIndexMarker161"/>an extract after creating or editing calculated fields or deleting or hiding fields.</li>
      <li class="list">Store extracts on solid-state drives.</li>
    </ul>
    <p class="normal">Although performance is one major reason to consider using extracts, there are other factors to consider, which we will do next.</p>
    <h2 id="_idParaDest-47" class="title">Portability and security</h2>
    <p class="normal">Let's say that your data is hosted on a database server accessible only from inside your office network. Normally, you'd have to be onsite or using a VPN to work with the data. Even cloud-based <a id="_idIndexMarker162"/>data sources require an internet connection. With an extract, you can take the data with you and work offline.</p>
    <p class="normal">An extract file contains data extracted from the source. When you save a workbook, you may save it as a Tableau workbook (<code class="Code-In-Text--PACKT-">.twb</code>) file or a Tableau Packaged Workbook (<code class="Code-In-Text--PACKT-">.twbx</code>) file. Let's consider the difference:</p>
    <ul>
      <li class="list">A Tableau workbook (<code class="Code-In-Text--PACKT-">.twb</code>) contains definitions for all the connections, fields, visualizations, and dashboards, but does not contain any data or external files, such as images. A Tableau workbook can be edited in Tableau Desktop and published to Tableau Server.</li>
      <li class="list">A Tableau packaged workbook (<code class="Code-In-Text--PACKT-">.twbx</code>) contains everything in a (<code class="Code-In-Text--PACKT-">.twb</code>) file but also includes extracts and external files that are packaged together in a single file with the workbook. A packaged workbook using extracts can be opened with Tableau Desktop, Tableau Reader, and published to Tableau Public or Tableau Online.</li>
    </ul>
    <div class="packt_tip">
      <p>A packaged workbook file (<code class="Code-In-Text--PACKT-">.twbx</code>) is really just a compressed <code class="Code-In-Text--PACKT-">.zip</code> file. If you rename the extension from <code class="Code-In-Text--PACKT-">.twbx</code> to <code class="Code-In-Text--PACKT-">.zip</code>, you can access the contents as you would any other <code class="Code-In-Text--PACKT-">.zip</code> file. </p>
    </div>
    <p class="normal">There are a couple of security considerations to keep in mind when using an extract. First, any security layers that limit which data can be accessed according to the credentials used will not be effective after the extract is created. An extract does not require a username or password. All data in an extract can be read by anyone. Second, any data for visible (non-hidden) fields contained in an extract file (<code class="Code-In-Text--PACKT-">.hyper</code> or <code class="Code-In-Text--PACKT-">.tde</code>), or an extract <a id="_idIndexMarker163"/>contained in a packaged workbook (<code class="Code-In-Text--PACKT-">.twbx</code>), can be accessed even if the data is not shown in the visualization. Be very careful to limit access to extracts or packaged workbooks containing sensitive or proprietary data.</p>
    <h2 id="_idParaDest-48" class="title">When to use an extract</h2>
    <p class="normal">You should <a id="_idIndexMarker164"/>consider various factors when determining whether to use an extract. In some cases, you won't have an option (for example, OLAP requires a live connection and some cloud-based data sources require an extract). In other cases, you'll want to evaluate your options.</p>
    <p class="normal">In general, use an extract when:</p>
    <ul>
      <li class="list">You need better performance than you can get with the live connection.</li>
      <li class="list">You need the data to be portable.</li>
      <li class="list">You need to use functions that are not supported by the database data engine (for example, <code class="Code-In-Text--PACKT-">MEDIAN</code> is not supported with a live connection to SQL Server).</li>
      <li class="list">You want to share a packaged workbook. This is especially true if you want to share a packaged workbook with someone who uses the free Tableau Reader, which can only read packaged workbooks with data extracted.</li>
    </ul>
    <p class="normal">In general, do not <a id="_idIndexMarker165"/>use an extract when you have any of the following use cases:</p>
    <ul>
      <li class="list">You have sensitive data that should not be accessible by certain users, or you have no control over who will be able to access the extract. However, you may hide sensitive fields prior to creating the extract, in which case they are no longer part of the extract.</li>
      <li class="list">You need to manage security based on login credentials. (However, if you are using Tableau Server, you may still use extracted connections hosted on Tableau Server that are secured by a login. We'll consider sharing your work with Tableau Server in <em class="italics">Chapter 16</em>, <em class="italics">Sharing Your Data Story</em>).</li>
      <li class="list">You need to see changes in the source data updated in real time.</li>
      <li class="list">The volume of data makes the time required to build the extract impractical. The number of records that can be extracted in a reasonable amount of time will depend on factors such as the data types of fields, the number of fields, the speed of the data source, and network bandwidth. The Hyper engine typically builds <code class="Code-In-Text--PACKT-">.hyper</code> extracts much faster than the older <code class="Code-In-Text--PACKT-">.tde</code> files were built.</li>
    </ul>
    <p class="normal">With an <a id="_idIndexMarker166"/>understanding of how to create, manage, and use extracts (and when not to use them), we'll turn our attention to various ways of filtering data in Tableau.</p>
    <h1 id="_idParaDest-49" class="title">Filtering data</h1>
    <p class="normal">Often, you will <a id="_idIndexMarker167"/>want to filter data in Tableau in order to perform an analysis on a subset of data, narrow your focus, or drill into details. Tableau offers multiple ways to filter data.</p>
    <p class="normal">If you want to limit the scope of your analysis to a subset of data, you can filter the data at the source using one of the following techniques:</p>
    <ul>
      <li class="list"><strong class="bold">Data Source Filters</strong> are applied <a id="_idIndexMarker168"/>before all other filters and are useful when you want to limit your analysis to a subset of data. These filters are applied before any other filters.</li>
      <li class="list"><strong class="bold">Extract Filters</strong> limit the <a id="_idIndexMarker169"/>data that is stored in an extract (<code class="Code-In-Text--PACKT-">.tde</code> or <code class="Code-In-Text--PACKT-">.hyper</code>). Data source filters are often converted into extract filters if they are present when you extract the data.</li>
      <li class="list"><strong class="bold">Custom SQL Filters</strong> can be <a id="_idIndexMarker170"/>accomplished using a live connection with custom SQL, which has a Tableau parameter in the <code class="Code-In-Text--PACKT-">WHERE</code> clause. We'll examine parameters in <em class="italics">Chapter 4</em>, <em class="italics">Starting an Adventure with Calculations and Parameters</em>.</li>
    </ul>
    <p class="normal">Additionally, you can apply filters to one or more views using one of the following techniques:</p>
    <ul>
      <li class="list">Drag and drop fields from the data pane to the <strong class="screen-text">Filters</strong> shelf.</li>
      <li class="list">Select one or more marks or headers in a view and then select <strong class="screen-text">Keep Only</strong> or <strong class="screen-text">Exclude</strong>, as shown here:</li>
    </ul>
    <figure class="mediaobject"><img src="../Images/B16021_02_25.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.25: Based on the mark selection, you may Keep Only values that match or Exclude such values.</p>
    <ul>
      <li class="list">Right-click any field in the data pane or in the view and select <strong class="screen-text">Show Filter</strong>. The filter will be shown as a control (examples include a drop-down list and checkbox) to allow the end user of the view or dashboard the ability to change the filter.</li>
      <li class="list">Use an action filter. We'll look more at filters and action filters in the context of dashboards.</li>
    </ul>
    <p class="normal">Each of these options adds one or more fields to the <strong class="screen-text">Filters</strong> shelf of a view. When you drop a field on the <strong class="screen-text">Filters</strong> shelf, you will be prompted with options to define the filter. The filter <a id="_idIndexMarker171"/>options will differ most noticeably based on whether the field is discrete or continuous. Whether a field is filtered as a dimension or as a measure will greatly impact how the filter is applied and the results.</p>
    <h2 id="_idParaDest-50" class="title">Filtering discrete (blue) fields</h2>
    <p class="normal">When you <a id="_idIndexMarker172"/>filter using a discrete field, you will be given options for selecting individual values to keep or exclude. For example, when you drop the discrete <strong class="screen-text">Department</strong> dimension onto the <strong class="screen-text">Filters</strong> shelf, Tableau will give you the following options:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_26.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.26: A filter for a discrete field will show options for including or excluding individual values</p>
    <p class="normal">The <strong class="screen-text">Filter</strong> options include <strong class="screen-text">General</strong>, <strong class="screen-text">Wildcard</strong>, <strong class="screen-text">Condition</strong>, and <strong class="screen-text">Top</strong> tabs. Your filter can include options <a id="_idIndexMarker173"/>from each tab. The <strong class="screen-text">Summary</strong> section on the <strong class="screen-text">General</strong> tab will show all options selected:</p>
    <ul>
      <li class="list">The <strong class="screen-text">General</strong> tab allows you to select items from a list (you can use the custom list to add items manually if the dimension contains a large number of values that take a long time to load). You may use the <strong class="screen-text">Exclude</strong> option to exclude the selected items.</li>
      <li class="list">The <strong class="screen-text">Wildcard</strong> tab allows you to match string values that contain, start with, end with, or exactly match a given value.</li>
      <li class="list">The <strong class="screen-text">Condition</strong> tab allows you to specify conditions based on aggregations of other fields that meet conditions (for example, a condition to keep any <strong class="screen-text">Department</strong> where the sum of sales was greater than $1,000,000). Additionally, you can write a custom calculation to form complex conditions. We'll cover calculations more in <em class="italics">Chapter 4</em>, <em class="italics">Starting an Adventure with Calculations and Parameters</em>, and <em class="italics">Chapter 6</em>, <em class="italics">Diving Deep with Table Calculations</em>.</li>
      <li class="list">The <strong class="screen-text">Top</strong> tab allows you to limit the filter to only the top or bottom items. For example, you might decide to keep only the top five items by the sum of sales.</li>
    </ul>
    <div class="packt_tip">
      <p>Discrete measures (except for calculated fields using table calculations) cannot be added to the <strong class="screen-text">Filters</strong> shelf. If the field holds a date or numeric value, you can convert it to a continuous field before filtering. Other data types will require the creation of a calculated field to convert values you wish to filter into continuous numeric values.</p>
    </div>
    <p class="normal">Let's next <a id="_idIndexMarker174"/>consider how continuous filters are filtered.</p>
    <h2 id="_idParaDest-51" class="title">Filtering continuous (green) fields</h2>
    <p class="normal">If you drop a <a id="_idIndexMarker175"/>continuous dimension onto the <strong class="screen-text">Filters</strong> shelf, you'll get a different set of options. Often, you will first be prompted as to how you want to filter the field, asÂ follows:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_27.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.27: For numeric values, you'll often see options for aggregating the value as part of the filter</p>
    <p class="normal">The options here are divided into two major categories:</p>
    <ul>
      <li class="list"><strong class="screen-text">All values</strong>: The filter will be based on each individual value of the field, <em class="italics">row by row</em>. For example, an <strong class="screen-text">All values</strong> filter keeping only sales above $100 will evaluate each record of underlying data and keep only individual sales above $100.</li>
      <li class="list"><strong class="bold">Aggregation</strong>: The filter will be based on the aggregation specified (for example, <strong class="screen-text">Sum</strong>, <strong class="screen-text">Average</strong>, <strong class="screen-text">Minimum</strong>, <strong class="screen-text">Maximum</strong>, <strong class="screen-text">Standard deviation</strong>, and <strong class="screen-text">Variance</strong>) and the aggregation will be performed at the level of detail of the view. For example, a filter keeping only the sum of sales above $100,000 on a view at the level of category will keep only categories that had at least $100,000 in total sales.</li>
    </ul>
    <p class="normal">Once you've <a id="_idIndexMarker176"/>made a selection (or if the selection wasn't applicable for the field selected), you will be given another interface for setting the actual filter, as follows:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_28.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.28: Filter options for Sales (as a SUM)</p>
    <p class="normal">Here, you'll see options for filtering continuous values based on a range with a start, end, or both. The <strong class="screen-text">Special</strong> tab gives options for showing all values, <code class="Code-In-Text--PACKT-">NULL</code> values, or non-<code class="Code-In-Text--PACKT-">NULL</code> values.</p>
    <div class="packt_tip">
      <p>From a user-interface perspective, the most dramatic difference in filtering options comes from whether a field is discrete or continuous. However, you should always <a id="_idIndexMarker177"/>think about whether you are using the field as a <strong class="bold">Dimension Filter</strong> or a <strong class="bold">Measure Filter</strong> to understand what kind of results you will <a id="_idIndexMarker178"/>get based on the order of operations, which is discussed in the <em class="italics">Appendix</em>.</p>
      <ul>
        <li class="Bullet-Within-Tip--PACKT-">Dimension filters will filter <em class="italics">detail rows of data</em>. For example, filtering out the Central Region will eliminate all rows for that region. You will not see any states for that region and your aggregate results, such as <code class="Code-In-Text--PACKT-">SUM(Sales)</code>, will not include any values from that region.</li>
        <li class="Bullet-Within-Tip-End--PACKT-">Measure filters will filter <em class="italics">aggregate rows of data</em> at the level of detail defined by the dimensions included in your view. For example, if you filtered to include only where <code class="Code-In-Text--PACKT-">SUM(Sales)</code> was greater than $100,000 and your view included <code class="Code-In-Text--PACKT-">Region</code> and <code class="Code-In-Text--PACKT-">Month</code>, then the resulting view would include only values where the <code class="Code-In-Text--PACKT-">Region</code> had more than $100,000 in sales for the given month.</li>
      </ul>
    </div>
    <p class="normal">Other than <a id="_idIndexMarker179"/>filtering discrete and continuous fields, you'll also notice some different options for filtering dates, which we'll consider next.</p>
    <h2 id="_idParaDest-52" class="title">Filtering dates</h2>
    <p class="normal">We'll take a <a id="_idIndexMarker180"/>look at the special way Tableau handles dates in the <em class="italics">Visualizing dates and times</em> section of <em class="italics">Chapter 3</em>, <em class="italics">Moving Beyond Basic Visualizations</em>. For now, consider the options available when you drop an <strong class="screen-text">Order Date</strong> field onto the <strong class="screen-text">Filters</strong> shelf, as follows:</p>
    <figure class="mediaobject"><img src="../Images/B16021_02_29.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.29: Initial filter options for a date field</p>
    <p class="normal">The options <a id="_idIndexMarker181"/>here include the following:</p>
    <ul>
      <li class="list"><strong class="screen-text">Relative date</strong>: This option allows you to filter a date based on a specific date (for example, keeping the last three weeks from today, or the last six months from January 1).</li>
      <li class="list"><strong class="screen-text">Range of dates</strong>: This option allows you to filter a date based on a range with a starting date, ending date, or both.</li>
      <li class="list"><strong class="bold">Date Part</strong>: This option allows you to filter based on discrete parts of dates, such as <strong class="screen-text">Years</strong>, <strong class="screen-text">Months</strong>, <strong class="screen-text">Days</strong>, or combinations of parts, such as <strong class="screen-text">Month/Year</strong>. Based on your selection, you will have various options for filtering and have the option of defaulting to the latest value in the data.</li>
      <li class="list"><strong class="screen-text">Individual dates</strong>: This option allows you to filter based on each individual value of the date field in the data.</li>
      <li class="list"><strong class="screen-text">Count </strong>or <strong class="screen-text">Count (Distinct)</strong>: This option allows you to filter based on the count, or distinct count, of date values in the data.</li>
    </ul>
    <p class="normal">Depending on your selection, you will be given additional options for filtering.</p>
    <h2 id="_idParaDest-53" class="title">Other filtering options</h2>
    <p class="normal">You will <a id="_idIndexMarker182"/>also want to be aware of the following options when it comes to filtering:</p>
    <ul>
      <li class="list">You may display a filter control for nearly any field by right-clicking it and selecting <strong class="screen-text">Show Filter</strong>. The type of control depends on the type of field, whether it is discrete or continuous, and may be customized by using the little drop-down arrow at the upper-right of the filter control.</li>
      <li class="list"><strong class="bold">Filters</strong> may be added to the <strong class="bold">context</strong>. Context is described in detail in the <em class="italics">Appendix</em> and we'll see why it's important in various examples throughout the book. For now, just note the option. This option is available via the drop-down menu on the filter control or the field on the <strong class="screen-text">Filters</strong> shelf.</li>
      <li class="list"><strong class="bold">Filters</strong> may be set to show all values in the database, all values in the context, all values in a hierarchy, or only values that are relevant based on other filters. These options are available via the drop-down menu on the <strong class="screen-text">Filter</strong> control or the field on the <strong class="screen-text">Filters</strong> shelf.</li>
      <li class="list">When using Tableau Server, you may define user filters that allow you to provide row-level security by filtering based on user credentials.</li>
      <li class="list">By default, any field placed on the <strong class="screen-text">Filters</strong> shelf defines a filter that is specific to the current view. However, you may specify the scope by using the menu for the field on the <strong class="screen-text">Filters</strong> shelf. Select <strong class="screen-text">Apply to</strong> and choose one of the following options:<ul>
          <li class="Bullet-Within-Bullet--PACKT-"><strong class="bold">All related data sources</strong>: All data sources will be filtered by the value(s) specified. The relationships of fields are the same as blending (that is, the default by name and type match, or customized through the <strong class="screen-text">Data | Edit Relationships...</strong> menu option). All views using any of the related data sources <a id="_idIndexMarker183"/>will be affected by the filter. This option is sometimes referred to as <strong class="bold">cross-data source filtering</strong>.</li>
          <li class="Bullet-Within-Bullet--PACKT-"><strong class="bold">Current data source</strong>: The data source for that field will be filtered. Any views using that data source will be affected by the filter.</li>
          <li class="Bullet-Within-Bullet--PACKT-"><strong class="bold">Selected worksheets</strong>: Any worksheets selected that use the data source of the field will be affected by the filter.</li>
          <li class="Bullet-Within-Bullet-End--PACKT-"><strong class="bold">Current worksheet</strong>: Only the current view will be affected by the filter.</li>
        </ul>
      </li>
    </ul>
    <p class="normal">We'll see plenty of practical examples of filtering data throughout the book, many of which will make use of some of these options.</p>
    <h1 id="_idParaDest-54" class="title">Summary</h1>
    <p class="normal">This chapter covered key concepts of how Tableau works with data. Although you will not usually be concerned with what queries Tableau generates to query underlying data engines, having a solid understanding of Tableau's paradigm will greatly aid you as you analyze data.</p>
    <p class="normal">We looked at multiple examples of different connections to different data sources, considered the benefits and potential drawbacks of using data extracts, considered how to manage metadata, and considered options for filtering data.</p>
    <p class="normal">Working with data is fundamental to everything you do in Tableau. Understanding how to connect to various data sources, when to work with extracts, and how to customize metadata will be key as you begin deeper analysis and more complex visualizations, such as those covered in <em class="italics">Chapter 3</em>, <em class="italics">Moving Beyond Basic Visualizations</em>.</p>
  </div>
</body></html>