<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;A Tour of the IPython Notebook"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. A Tour of the IPython Notebook</h1></div></div></div><p>This chapter gives a brief introduction to the <span class="strong"><strong>IPython notebook</strong></span> and highlights some of its special<a class="indexterm" id="id0"/> features that make it a great tool for scientific and data-oriented computing. IPython notebooks use a standard text format that makes it easy to share results.</p><p>After the quick installation instructions, you will learn how to start the notebook and be able to immediately use IPython to perform computations. This simple, initial setup is all that is needed to take advantage of the many notebook features, such as interactively producing high quality graphs, performing advanced technical computations, and handling data with specialized libraries.</p><p>All examples are explained in detail in this book and available online. We do not expect the readers to have deep knowledge of Python, but readers unfamiliar with the Python syntax can consult <a class="link" href="apb.html" title="Appendix B. A Brief Review of Python">Appendix B</a>, <span class="emphasis"><em>A Brief Review of Python</em></span>, for an introduction/refresher.</p><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Getting started with Anaconda or Wakari</li><li class="listitem" style="list-style-type: disc">Creating notebooks and then learning about the basics of editing and executing statements</li><li class="listitem" style="list-style-type: disc">An applied example highlighting the notebook features</li></ul></div><div class="section" title="Getting started with Anaconda or Wakari"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Getting started with Anaconda or Wakari</h1></div></div></div><p>There<a class="indexterm" id="id1"/> are several approaches to setting up an IPython notebook environment. We <a class="indexterm" id="id2"/>suggest you use Anaconda, a free distribution designed for large-scale data processing, predictive analytics, and scientific computing. Alternatively, you can use Wakari, which is a web-based installation of Anaconda. Wakari has several levels of service, but the basic level is free and suitable for experimenting and learning.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p>We recommend that you set up both a Wakari account and a local Anaconda installation. Wakari has the functionality of easy sharing and publication. This local installation does not require an Internet connection and may be more responsive. Thus, you<a class="indexterm" id="id3"/> get<a class="indexterm" id="id4"/> the best of both worlds!</p></div></div><div class="section" title="Installing Anaconda"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec06"/>Installing Anaconda</h2></div></div></div><p>To install<a class="indexterm" id="id5"/> Anaconda on your computer, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download<a class="indexterm" id="id6"/> Anaconda for your platform from <a class="ulink" href="https://store.continuum.io/cshop/anaconda/">https://store.continuum.io/cshop/anaconda/</a>.</li><li class="listitem">After the file is completely downloaded, install Anaconda:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Windows users can double-click on the installer and follow the on-screen instruction</li><li class="listitem" style="list-style-type: disc">Mac users can double-click the <code class="literal">.pkg</code> file and follow the instructions displayed on screen</li><li class="listitem" style="list-style-type: disc">Linux users can run the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>bash &lt;downloaded file&gt;</strong></span>
</pre></div></li></ul></div></li></ol></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>Anaconda supports several different versions of Python. This book assumes you are using Version 2.7, which is the standard version that comes with Anaconda. The most recent version of Python, Version 3.0, is significantly different and is just starting to gain popularity. Many Python packages are still only fully supported in Version 2.7.</p></div></div></div></div></div>
<div class="section" title="Running the notebook"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Running the notebook</h1></div></div></div><p>You<a class="indexterm" id="id7"/> are now ready to run the notebook. First, we create a directory named <code class="literal">my_notebooks</code> to hold your notebooks and open a terminal window at this directory. Different operating systems perform different steps.</p><p>Microsoft Windows users need to perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open Window Explorer.</li><li class="listitem">Navigate to the location where your notebooks are stored.</li><li class="listitem">Click on the <span class="strong"><strong>New Folder</strong></span> button.</li><li class="listitem">Rename the folder <code class="literal">my_notebooks</code>.</li><li class="listitem">Right-click<a class="indexterm" id="id8"/> on the <code class="literal">my_notebooks</code> folder and select <span class="strong"><strong>Open command window here</strong></span> from the context menu.</li></ol></div><p>Mac OS X and other Unix-like systems' users need to perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open a terminal window.</li><li class="listitem">Run the following commands:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mkdir my_notebooks</strong></span>
<span class="strong"><strong>cd my_notebooks</strong></span>
</pre></div></li><li class="listitem">Then, execute the following command on the terminal window:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>ipython notebook</strong></span>
</pre></div></li></ol></div><p>After a while, your browser will automatically load the notebook dashboard as shown in the following screenshot. The dashboard is a mini filesystem where you can manage your notebooks. The notebooks listed in the dashboard correspond exactly to the files you have in the directory where the notebook server was launched.</p><div class="mediaobject"><img alt="Running the notebook" src="graphics/8341OS_01_01.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="tip03"/>Tip</h3><p>Internet Explorer does not fully support all features in the IPython notebook. It is suggested that you use Chrome, Firefox, Safari, Opera, or another standards-conforming browser. If your default browser is one of those, you are ready to go. Alternatively, close the Internet Explorer notebook, open a compatible browser, and enter the notebook address given in the command window from which you started IPython. This will be something like <code class="literal">http://127.0.0.1:8888</code> for the first notebook you open.</p></div></div><div class="section" title="Creating a Wakari account"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec07"/>Creating a Wakari account</h2></div></div></div><p>To <a class="indexterm" id="id9"/>access Wakari, simply go to <a class="ulink" href="https://www.wakari.io">https://www.wakari.io</a> and create an account. After logging in, you will be automatically <a class="indexterm" id="id10"/>directed to an introduction to using the notebook interface <a class="indexterm" id="id11"/>in Wakari. This interface is shown in the following screenshot:</p><div class="mediaobject"><img alt="Creating a Wakari account" src="graphics/8341OS_01_02.jpg"/></div><p>The interface elements as seen in the preceding screenshot are described as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The section marked <span class="strong"><strong>1</strong></span> shows the directory listing of your notebooks and files. On the top of this area, there is a toolbar with buttons to create new files and directories as well as download and upload files.</li><li class="listitem" style="list-style-type: disc">The section marked <span class="strong"><strong>2</strong></span> shows the <span class="strong"><strong>Welcome to Wakari</strong></span> notebook. This is the initial notebook with information about IPython and Wakari. The notebook interface is discussed in detail in <a class="link" href="ch02.html" title="Chapter 2. The Notebook Interface">Chapter 2</a>, <span class="emphasis"><em>The Notebook Interface</em></span>.</li><li class="listitem" style="list-style-type: disc">The section marked <span class="strong"><strong>3</strong></span> shows the Wakari toolbar. This has the <span class="strong"><strong>New Notebook</strong></span> button and drop-down menus with other tools.</li></ul></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>This book concentrates on using IPython through the notebook interface. However, it's worth mentioning the two other ways to run IPython.</p><p>The simplest way to run IPython is to issue the <code class="literal">ipython</code> command in a terminal <a class="indexterm" id="id12"/>window. This starts a command-line session of IPython. As the reader may have guessed, this is the original interface for IPython.</p><p>Alternatively, IPython can be started using the <code class="literal">ipython qtconsole</code> command. This <a class="indexterm" id="id13"/>starts an IPython session <a class="indexterm" id="id14"/>attached to a QT window. QT is a popular<a class="indexterm" id="id15"/> multiplatform windowing system that is bundled with the Anaconda distribution. These alternatives may be useful in systems that, for some reason, do not support the notebook interface.</p></div></div></div><div class="section" title="Creating your first notebook"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec08"/>Creating your first notebook</h2></div></div></div><p>We are <a class="indexterm" id="id16"/>ready to create our first notebook! Simply click on the <span class="strong"><strong>New</strong></span> <span class="strong"><strong>Notebook</strong></span> button to create a new notebook.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">In a local notebook installation, the <span class="strong"><strong>New Notebook</strong></span> button appears in the upper-left corner of the dashboard.</li><li class="listitem" style="list-style-type: disc">In Wakari, the <span class="strong"><strong>New Notebook</strong></span> button is at the top of the dashboard, in a distinct color. <span class="emphasis"><em>Do not</em></span> use the <span class="strong"><strong>Add File</strong></span> button.</li></ul></div><p>Notice that the Wakari dashboard contains a directory list on the left. You can use this to organize your notebooks in any convenient way you choose. Wakari actually provides access to a fully working Linux shell.</p><p>We are now ready to start computing. The notebook interface is displayed in the following screenshot:</p><div class="mediaobject"><img alt="Creating your first notebook" src="graphics/8341OS_01_03.jpg"/></div><p>By default, new notebooks are named <code class="literal">UntitledX</code>, where <code class="literal">X</code>
<span class="strong"><strong> </strong></span>is a number. To change it, just click on the current title and edit the dialog that pops up.</p><p>At the top of the notebook, you will see an empty box with the <code class="literal">In [ ]:</code> text on the left-hand side. This box is<a class="indexterm" id="id17"/> called a <span class="strong"><strong>code cell</strong></span> and it is where the IPython shell commands are entered. Usually, the first command we issue in a new notebook is <code class="literal">%pylab inline</code>. Go ahead <a class="indexterm" id="id18"/>and type this line in the code cell and then press <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>Enter</em></span> (this is the most usual way to execute commands. Simply pressing <span class="emphasis"><em>Enter</em></span> will create a new line in the current cell.) Once executed, this command will issue a message as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Populating the interactive namespace from numpy and matplotlib</strong></span>
</pre></div><p>This <a class="indexterm" id="id19"/>command makes several computational tools easily available and is the recommended way to use the IPython notebook for interactive computations. The <code class="literal">inline </code>directive tells IPython that we want graphics embedded in the notebook and not rendered with an external program.</p><p>Commands that start with <code class="literal">%</code> and <code class="literal">%%</code> are <a class="indexterm" id="id20"/>called <span class="strong"><strong>magic</strong></span> commands and are used to set up configuration options and special features. The <code class="literal">%pylab</code> magic command<a class="indexterm" id="id21"/> imports a large collection of names into the IPython namespace. This command is usually frowned upon for causing <span class="strong"><strong>namespace pollution</strong></span>. The<a class="indexterm" id="id22"/> recommended way to use libraries in scripts is to use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>import numpy as np</strong></span>
</pre></div><p>Then, for example, to access the <code class="literal">arange()</code> function in the <code class="literal">NumPy</code> package, one uses <code class="literal">np.arange()</code>. The problem with this approach is that it becomes cumbersome to use common mathematical functions, such as <code class="literal">sin()</code>, <code class="literal">cos()</code>, and so on. These would have to be entered as <code class="literal">np.sin()</code>, <code class="literal">np.cos()</code>, and so on, which makes the notebook much less readable.</p><p>In this book, we adopt the following middle-of-the road convention: when doing interactive computations, we will use the <code class="literal">%pylab</code> directive to make it easier to type formulae. However, when using other libraries or writing scripts, we will use the recommended best practices to import libraries.</p></div></div>
<div class="section" title="Example &#x2013; the coffee cooling problem"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Example – the coffee cooling problem</h1></div></div></div><p>Suppose <a class="indexterm" id="id23"/>you get a cup of coffee at a coffee shop. Should you mix the cream into the coffee at the shop or wait until you reach your office? The goal, we assume, is to have the coffee as hot as possible. So, the main question is how the coffee is going to cool as you walk back to the office.</p><p>The difference between the two strategies of mixing cream is:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If you pour the cream at the shop, there is a sudden drop of temperature <span class="emphasis"><em>before</em></span> the coffee starts to cool down as you walk back to the office</li><li class="listitem" style="list-style-type: disc">If you pour the cream after getting back to the office, the sudden drop occurs <span class="emphasis"><em>after</em></span> the cooling period during the walk</li></ul></div><p>We need <a class="indexterm" id="id24"/>a model for the cooling process. The simplest such model is Newton's cooling law, which states that the rate of cooling is proportional to the temperature difference between the coffee in the cup and the ambient temperature. This reflects the intuitive notion that, for example, if the outside temperature is 40°F, the coffee cools faster than if it is 50°F. This assumption leads to a well-known formula for the way the temperature changes:</p><div class="mediaobject"><img alt="Example – the coffee cooling problem" src="graphics/8341OS_01_08.jpg"/></div><p>The constant <span class="emphasis"><em>r</em></span> is a number between 0 and 1, representing the heat exchange between the coffee cup and the outside environment. This constant depends on several factors, and may be hard to estimate without experimentation. We just chose it somewhat arbitrarily in this first example.</p><p>We will start by setting variables to represent the outside temperature and the rate of cooling and defining a function that computes the temperatures as the liquid cools. Then, type the lines of code representing the cooling law in a single code cell. Press <span class="emphasis"><em>Enter</em></span> or click on <span class="strong"><strong>Return</strong></span> to add new lines to the cell.</p><p>As discussed, we will first define the variables to hold the outside temperature and the rate of cooling:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>temp_out = 70.0</strong></span>
<span class="strong"><strong>r = 0.9</strong></span>
</pre></div><p>After entering the preceding code on the cell, press <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>Enter</em></span> to execute the cell. Notice that after the cell is executed, a new cell is created.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note05"/>Note</h3><p>Notice that we entered the value of <code class="literal">temp_out</code> as <code class="literal">70.0</code> even though the value is an integer in this case. This is not strictly necessary in this case, but it is considered good practice. Some code may behave differently, depending on whether it operates on integer or floating-point variables. For example, evaluating <code class="literal">20/8</code> in Python Version 2.7 results in <code class="literal">2</code>, which is the integer quotient of 20 divided by 8. On the other hand, <code class="literal">20.0/8.0</code> evaluates to the floating-point value <code class="literal">2.5</code>. By forcing the variable <code class="literal">temp_out</code> to be a floating-point value, we prevent this somewhat unexpected kind of behavior.</p><p>A second <a class="indexterm" id="id25"/>reason is to simply improve code clarity and readability. A reader of the notebook on seeing the value <code class="literal">70.0</code> will easily understand that the variable <code class="literal">temp_out</code> represents a real number. So, it becomes clear that a value of <code class="literal">70.8</code>, for example, would also be acceptable for the outside temperature.</p></div></div><p>Next, we define <a class="indexterm" id="id26"/>the function representing the cooling law:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>def cooling_law(temp_start, walk_time):</strong></span>
<span class="strong"><strong>    return temp_out + (temp_start - temp_out) * r ** walk_time </strong></span>
</pre></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note06"/>Note</h3><p>Please be careful with the way the lines are indented, since indentation is used by Python to define code blocks. Again, press <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>Enter</em></span> to execute the cell.</p></div></div><p>The <code class="literal">cooling_law()</code>function<a class="indexterm" id="id27"/> accepts the starting temperature and walking time as the input and returns the final temperature of the coffee. Notice that we are only defining the function, so no output is produced. In our examples, we will always choose meaningful names for variables. To be consistent, we use the conventions in the Google style of coding for Python as shown in <a class="ulink" href="http://google-styleguide.googlecode.com/svn/trunk/pyguide.html#Python_Language_Rules">http://google-styleguide.googlecode.com/svn/trunk/pyguide.html#Python_Language_Rules</a>.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note07"/>Note</h3><p>Notice that the exponentiation (power) operator in Python is <code class="literal">**</code> and not <code class="literal">^</code> as in other mathematical software. If you get the following error when trying to compute a power, it is likely that you meant to use the <code class="literal">**</code> operator:</p><div class="informalexample"><pre class="programlisting">TypeError: unsupported operand type(s) for ^: 'float' and 'float'</pre></div></div></div><p>We can now compute the effect of cooling given any starting temperature and walking time. For example, to compute the temperature of the coffee after 10 minutes, assuming the initial temperature to be 185°F, run the following code in a cell:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>cooling_law(185.0, 10.0)</strong></span>
</pre></div><p>The corresponding output is:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>110.0980206115</strong></span>
</pre></div><p>What if we want to know what the final temperature for several walking times is? For example, suppose that we want to compute the final temperature every 5 minutes up to 20 minutes. This is where <code class="literal">NumPy</code> makes things easy:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>times = arange(0.,21.,5.)</strong></span>
<span class="strong"><strong>temperatures = cooling_law(185., times)</strong></span>
<span class="strong"><strong>temperatures</strong></span>
</pre></div><p>We start by defining <code class="literal">times</code> to be a <code class="literal">NumPy</code> array, using the <code class="literal">arange()</code> function. This function takes <a class="indexterm" id="id28"/>three arguments: the starting value <a class="indexterm" id="id29"/>of the range, the ending value of the range, and the increment.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note08"/>Note</h3><p>You may be wondering why the ending value of the range is <code class="literal">21</code> and not <code class="literal">20</code>. It's a common convention in Computer Science, followed by Python. <span class="emphasis"><em>When a range is specified, the right endpoint never belongs to the range</em></span>. So, if we had specified <code class="literal">20</code> as the right endpoint, the range would only contain the values <code class="literal">0</code>, <code class="literal">5</code>, <code class="literal">10</code>, and <code class="literal">15</code>.</p></div></div><p>After defining the <code class="literal">times</code> array, we can simply call the <code class="literal">cooling_law()</code> function with <code class="literal">times</code> as the second argument. This computes the temperatures at the given times.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note09"/>Note</h3><p>You may have noticed that there is something strange going on here. The first time the <code class="literal">cooling_law()</code> function was called, the second argument was a floating-point number. The second time, it was a <code class="literal">NumPy</code> array. This is possible thanks to Python's dynamic typing and polymorphism. <code class="literal">NumPy</code> redefines the arithmetic operators to work with arrays in a smart way. So, we do not need to define a new function especially for this case.</p></div></div><p>Once we have the temperatures, we can display them in a graph. To display the graph, execute the following command line in a cell:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>plot(times, temperatures, 'o')</strong></span>
</pre></div><p>The preceding command line produces the following plot:</p><div class="mediaobject"><img alt="Example – the coffee cooling problem" src="graphics/8341OS_01_04.jpg"/></div><p>The <code class="literal">plot()</code> function is a part of the <code class="literal">matplotlib</code> package, which will be studied in detail<a class="indexterm" id="id30"/> in <a class="link" href="ch03.html" title="Chapter 3. Graphics with matplotlib">Chapter 3</a>, <span class="emphasis"><em>Graphics with matplotlib</em></span>. In this example, the first two arguments to <code class="literal">plot()</code> are <code class="literal">NumPy</code> arrays that specify the data for the horizontal and vertical axes, respectively. The third argument specifies the plot symbol to be a filled circle.</p><p>We are<a class="indexterm" id="id31"/> now ready to tackle the original problem: should we mix the cream in at the coffee shop or wait until we get back to the office? When we mix the cream, there is a sudden drop in temperature. The temperature of the mixture is the average of the temperature of the two liquids, weighted by volume. The following code defines a function to compute the resulting temperature in a mix:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>def temp_mixture(t1, v1, t2, v2):</strong></span>
<span class="strong"><strong>    return (t1 * v1 + t2 * v2) / (v1 + v2)</strong></span>
</pre></div><p>The arguments in the function are the temperature and volume of each liquid. Using this function, we can now compute the temperature evolution when the cream is added at the coffee shop:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>temp_coffee = 185.</strong></span>
<span class="strong"><strong>temp_cream = 40.</strong></span>
<span class="strong"><strong>vol_coffee = 8.</strong></span>
<span class="strong"><strong>vol_cream = 1.</strong></span>
<span class="strong"><strong>initial_temp_mix_at_shop = temp_mixture(temp_coffee, vol_coffee, temp_cream, vol_cream)</strong></span>
<span class="strong"><strong>temperatures_mix_at_shop = cooling_law(initial_temp_mix_at_shop, times)</strong></span>
<span class="strong"><strong>temperatures_mix_at_shop</strong></span>
</pre></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="tip04"/>Tip</h3><p>Notice that we repeat the variable <code class="literal">temperatures_mix_at_shop</code> at the end of the cell. This is not a typo. The IPython notebook, by default, assumes that the output of a cell is the last expression computed in the cell. It is a common idiom to list the variables one wants to have displayed, at the end of the cell. We will later see how to display fancier, nicely formatted output.</p></div></div><p>As usual, type <a class="indexterm" id="id32"/>all the commands in a single code cell and then press <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>Enter</em></span> to run the whole cell. We first set the initial temperatures and volumes for the coffee and the cream. Then, we call the <code class="literal">temp_mixture()</code> function to calculate the initial temperature of the mixture. Finally, we use<a class="indexterm" id="id33"/> the <code class="literal">cooling_law()</code> function to compute the temperatures<a class="indexterm" id="id34"/> for different walking times, storing the result in the <code class="literal">temperatures_mix_at_shop</code> variable. The preceding command lines produce the following output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>array([ 168.88888889,  128.3929    ,  104.48042352,   90.36034528,</strong></span>
<span class="strong"><strong>         82.02258029])</strong></span>
</pre></div><p>Remember that the <code class="literal">times</code> array specifies times from <code class="literal">0</code> to <code class="literal">20</code> with intervals of 5 minutes. So, the preceding output gives the temperatures at these times, assuming that the cream was mixed in the shop.</p><p>To compute the temperatures when considering that the cream is mixed after walking back to our office, execute the following commands in the cell:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>temperatures_unmixed_coffee = cooling_law(temp_coffee, times)</strong></span>
<span class="strong"><strong>temperatures_mix_at_office = temp_mixture(temperatures_unmixed_coffee, vol_coffee, temp_cream, vol_cream)</strong></span>
<span class="strong"><strong>temperatures_mix_at_office</strong></span>
</pre></div><p>We again use the <code class="literal">cooling_law()</code> function, but using the initial coffee temperature <code class="literal">temp_coffee</code> (without mixing the cream) as the first input variable. We store the results in the <code class="literal">temperatures_unmixed_coffee</code> variable.</p><p>To compute the effect of mixing the cream in after walking, we call the <code class="literal">temp_mixture()</code> function. Notice that the main difference in the two computations is the order in which the functions <code class="literal">cooling_law()</code> and <code class="literal">temp_mixture()</code> are called. The preceding command lines produce the following output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>array([ 168.88888889,  127.02786667,  102.30935165,   87.71331573,</strong></span>
<span class="strong"><strong>         79.09450247])</strong></span>
</pre></div><p>Let's now plot the two temperature arrays. Execute the following command lines in a single cell:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>plot(times, temperatures_mix_at_shop, 'o')</strong></span>
<span class="strong"><strong>plot(times, temperatures_mix_at_office, 'D', color='r')</strong></span>
</pre></div><p>The first <code class="literal">plot()</code> function call is the same as before. The second is similar, but we want the<a class="indexterm" id="id35"/> plotting symbol to be a filled diamond, indicated by the argument <code class="literal">'D'</code>. The <code class="literal">color='r'</code> option makes the markings red. This produces the following plot:</p><div class="mediaobject"><img alt="Example – the coffee cooling problem" src="graphics/8341OS_01_05.jpg"/></div><p>Notice that, by default, all graphs created in a single code cell will be drawn on the same set of axes. As a conclusion, we can see that, for the data parameters used in this example, mixing the cream at the coffee shop is always better no matter what the walking time is. The reader should feel free to change the parameters and observe what happens in different situations.</p><p>Scientific plots should make clear what is being represented, the variables being plotted, as well as the units being used. This can be nicely handled by adding annotations to the plot. It is fairly easy to add annotations in <code class="literal">matplotlib</code>, as shown in the following code:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>plot(times, temperatures_mix_at_shop, 'o')</strong></span>
<span class="strong"><strong>plot(times, temperatures_mix_at_office, 'D', color='r')</strong></span>
<span class="strong"><strong>title('Coffee temperatures for different walking times')</strong></span>
<span class="strong"><strong>xlabel('Waking time (min)')</strong></span>
<span class="strong"><strong>ylabel('Temperature (F)')</strong></span>
<span class="strong"><strong>legend([</strong></span><span class="strong"><strong>'</strong></span><span class="strong"><strong>Mix at shop', </strong></span><span class="strong"><strong>'</strong></span><span class="strong"><strong>Mix at office']) </strong></span>
</pre></div><p>After <a class="indexterm" id="id36"/>plotting the arrays again, we call the appropriate functions to add the title (<code class="literal">title()</code>), horizontal axis label (<code class="literal">xlabel()</code>), vertical axis label (<code class="literal">ylabel()</code>), and legend (<code class="literal">legend()</code>). The arguments to all this functions are strings or a list of strings as in the case of <code class="literal">legend()</code>. The following graph is what we get as an output for the preceding command lines:</p><div class="mediaobject"><img alt="Example – the coffee cooling problem" src="graphics/8341OS_01_06.jpg"/></div><p>There is something unsatisfactory about the way we conducted this analysis; our office, supposedly, is at a fixed distance from the coffee shop. The main factor in the situation is the outside temperature. Should we use different strategies during summer and winter? In order to investigate this, we start by defining a function that accepts as input both the cream temperature and outside temperature. The return value of the function is the difference of final temperatures when we get back to the office.</p><p>The function is defined as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>temp_coffee = 185.</strong></span>
<span class="strong"><strong>vol_coffee = 8.</strong></span>
<span class="strong"><strong>vol_cream = 1.</strong></span>
<span class="strong"><strong>walk_time = 10.0</strong></span>
<span class="strong"><strong>r = 0.9</strong></span>
<span class="strong"><strong>def temperature_difference(temp_cream, temp_out):</strong></span>
<span class="strong"><strong>    temp_start = temp_mixture(temp_coffee,vol_coffee,temp_cream,vol_cream)</strong></span>
<span class="strong"><strong>    temp_mix_at_shop = temp_out + (temp_start - temp_out) * r ** walk_time</strong></span>
<span class="strong"><strong>    temp_start = temp_coffee</strong></span>
<span class="strong"><strong>    temp_unmixed =  temp_out + (temp_start - temp_out) * r ** walk_time</strong></span>
<span class="strong"><strong>    temp_mix_at_office = temp_mixture(temp_unmixed, vol_coffee, temp_cream, vol_cream)</strong></span>
<span class="strong"><strong>    return temp_mix_at_shop - temp_mix_at_office</strong></span>
</pre></div><p>In the <a class="indexterm" id="id37"/>preceding function, we first set the values of the variables that will be considered constant in the analysis, that is, the temperature of the coffee, the volumes of coffee and cream, the walking time, and the rate of cooling. Then, we defined the <code class="literal">temperature_difference</code> function using the same formulas<a class="indexterm" id="id38"/> we discussed previously. We can now use this function to compute a matrix with the temperature differences for several different values of the cream temperature and outside temperature:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>cream_temperatures = arange(40.,51.,1.)</strong></span>
<span class="strong"><strong>outside_temperatures = arange(35.,60.,1.)</strong></span>
<span class="strong"><strong>cream_values, outside_values = meshgrid(cream_temperatures, outside_temperatures)</strong></span>
<span class="strong"><strong>temperature_differences = temperature_difference(cream_values, outside_values)</strong></span>
</pre></div><p>The first two lines in the cell use the <code class="literal">arange()</code> function to define arrays that contain equally spaced <a class="indexterm" id="id39"/>values for the cream temperatures and outside temperatures. We<a class="indexterm" id="id40"/> then call the convenience function, <code class="literal">meshgrid()</code>. This function returns two arrays that are convenient to calculate data for three-dimensional graphs and are stored in the variables <code class="literal">cream_values</code> and <code class="literal">outside_values</code>. Finally, we call the <code class="literal">temperature_difference()</code> function, and store the <a class="indexterm" id="id41"/>return value in the <code class="literal">temperature_differences</code> array. This will be a two-dimensional array (that is, a matrix).</p><p>We are now ready to create a three dimensional plot of the temperature differences:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>from mpl_toolkits.mplot3d import Axes3D</strong></span>
<span class="strong"><strong>fig = figure()</strong></span>
<span class="strong"><strong>fig.set_size_inches(7,5)</strong></span>
<span class="strong"><strong>ax = fig.add_subplot(111, projection='3d')</strong></span>
<span class="strong"><strong>ax.plot_surface(cream_values, outside_values, temperature_differences, rstride=1, cstride=1, cmap=cm.coolwarm, linewidth=0)</strong></span>
<span class="strong"><strong>xlabel('Cream temperature')</strong></span>
<span class="strong"><strong>ylabel('Outside temperature')</strong></span>
<span class="strong"><strong>title(</strong></span><span class="strong"><strong>'</strong></span><span class="strong"><strong>Temperature difference') </strong></span>
</pre></div><p>In the preceding code segment, we started by importing the <code class="literal">Axes3D</code> class using the following line:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>from mpl_toolkits.mplot3d import Axes3D</strong></span>
</pre></div><p>This<a class="indexterm" id="id42"/> class, located in the <code class="literal">mpl_toolkits.mplot3d</code> module, is not automatically loaded. So, it must be explicitly imported.</p><p>Then we create an object <code class="literal">fig</code> of the class <code class="literal">figure</code>, set its size, and generate an object <code class="literal">ax</code> that is an object of the class <code class="literal">Axes3D</code>. Finally, we call the <code class="literal">ax.plot_surface()</code> method to generate the plot. The last three command lines set the axis labels and the title.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note10"/>Note</h3><p>In this explanation, we used some terms that are common in object-oriented programming. A Python <span class="strong"><strong>object</strong></span><a class="indexterm" id="id43"/> is simply a data structure that can be handled in<a class="indexterm" id="id44"/> some specialized way. Every object is an <span class="strong"><strong>instance</strong></span> of a <span class="strong"><strong>class</strong></span><a class="indexterm" id="id45"/> that defines the object's data. The class also defines <span class="strong"><strong>methods</strong></span>, which<a class="indexterm" id="id46"/> are functions specialized to work with objects belonging to the class.</p></div></div><p>The output of the preceding command lines will produce the following graph:</p><div class="mediaobject"><img alt="Example – the coffee cooling problem" src="graphics/8341OS_01_07.jpg"/></div><p>Notice <a class="indexterm" id="id47"/>the <code class="literal">cmap=cm.coolwarm</code> argument in the call to <code class="literal">ax.plot_surface()</code>. This sets the color map of the plot to <code class="literal">cm.coolwarm</code>. This color map conveniently uses a blue-red gradient for the function values. As a result, negative temperature differences are shown in blue and positive temperatures in red. Notice that there seems to be a straight line that defines where the temperature difference transitions from negative to positive. This actually corresponds to values where the outside temperature and the cream temperature are equal. It turns out that if the cream temperature is lower than the outside temperature, we should mix the cream into the coffee at the coffee shop. Otherwise, the cream should be poured in the office.</p></div>
<div class="section" title="Exercises"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Exercises</h1></div></div></div><p>The <a class="indexterm" id="id48"/>following are some practice questions that will help you to understand and apply the concepts learned in this chapter:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">In our example, we discussed how to determine the cooling rate <span class="emphasis"><em>r</em></span>. Modify the example to plot the temperature evolution for several values of <span class="emphasis"><em>r</em></span>, keeping all other variables fixed.</li><li class="listitem" style="list-style-type: disc">Search<a class="indexterm" id="id49"/> the <span class="strong"><strong>matplotlib</strong></span> documentation at <a class="ulink" href="http://matplotlib.org">http://matplotlib.org</a> to figure out how to generate a contour plot of the temperature differences.<p>Our<a class="indexterm" id="id50"/> analysis ignores the fact that the cream will also change temperature as we walk. Change the notebook so that this factor is taken into account</p></li></ul></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Summary</h1></div></div></div><p>In this chapter, we set up an IPython environment with Anaconda, accessed the IPython notebook online through Wakari, created a notebook, and learned the basics of editing and executing commands, and lastly, we went through an extensively applied example featuring the basic notebook capabilities.</p><p>In the next chapter, we will delve more deeply in the facilities provided by the notebook interface—including notebook navigation and editing facilities, interfacing with the operating system, loading and saving data, and running scripts.</p></div></body></html>