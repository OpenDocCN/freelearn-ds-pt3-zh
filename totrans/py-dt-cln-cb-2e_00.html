<html><head></head><body>
  <div id="_idContainer006">
    <h1 id="_idParaDest-4" class="mainHeading">Preface</h1>
    <p class="normal">This book is a practical guide to data cleaning, broadly defined as all tasks necessary to prepare data for analysis. It is organized by the tasks usually completed during the data-cleaning process: importing data, viewing data diagnostically, identifying outliers and unexpected values, imputing values, tidying data, and so on. Each recipe walks the reader from raw data through the completion of a specific data-cleaning task.</p>
    <p class="normal">There are already a number of very good pandas books. Unsurprisingly, there is some overlap between those texts and this one. However, the emphasis here is different. I focus as much on the why as on the how in this book.</p>
    <p class="normal">Since pandas is still relatively new, the lessons I have learned about cleaning data have been shaped by my experiences with other tools. Before settling into my current work routine with Python and R about 10 years ago, I relied mostly on C# and T-SQL in the early 2000s, SAS and Stata in the 90s, and FORTRAN and Pascal in the 80s. Most readers of this text probably have experience with a variety of data-cleaning and analysis tools. In many ways the specific tool is less significant than the data preparation task and the attributes of the data. I would have covered pretty much the same topics if I had been asked to write <em class="italic">The SAS Data Cleaning Cookbook</em> or <em class="italic">The R Data Cleaning Cookbook</em>. I just take a Python/pandas-specific approach to the same data-cleaning challenges that analysts have faced for decades.</p>
    <p class="normal">I start each chapter with how to think about the particular data-cleaning task at hand before discussing how to approach it with a tool from the Python ecosystem—pandas, NumPy, Matplotlib, and so on. This is reinforced in each recipe by a discussion of the implications of what we are uncovering in the data. I try to connect tool to purpose. For example, concepts like skewness and kurtosis matter as much for handling outliers as does knowing how to update pandas Series values.</p>
    <h1 id="_idParaDest-5" class="heading-1">New in the Second Edition</h1>
    <p class="normal">Readers of the first edition will recognize that this book is substantially longer than that one. That is partly because there are two new chapters—a chapter devoted to treating missing values and another one on pre-processing data for predictive analysis. The insufficient coverage of missing values, and the absence of coverage of pre-processing data for machine learning applications were important omissions. The pre-processing coverage is further improved by new recipes on data pipelines in the final chapter that take the reader from raw data to model evaluation.</p>
    <p class="normal">The recipes in all chapters have been revised. This is to make sure that they all work well with the most recent versions of pandas. pandas went from version 1.5.3 to 2.2.1 during the writing of this book. I have tried to make sure that all code works fine on all versions of pandas released from January 2023 through February 2024. Since AI tools are becoming increasingly common in our work, I have included discussion of OpenAI tools in four of the chapters. Altogether, 22 of the 82 recipes are new. All of the datasets used have also been updated.</p>
    <h1 id="_idParaDest-6" class="heading-1">Who this book is for</h1>
    <p class="normal">I had multiple audiences in mind as I wrote this book, but I most consistently thought about a dear friend of mine who bought a Transact-SQL book 30 years ago and quickly developed great confidence in her database work, ultimately building a career around those skills. I would love it if someone just starting their career as a data scientist or analyst worked through this book and had a similar experience as my friend. More than anything else, I want you to feel good and excited about what you can do as a result of reading this book.</p>
    <p class="normal">I also hope this book will be a useful reference for folks who have been doing this kind of work for a while. Here, I imagine someone opening the book and wondering to themself, “What’s an approach to handling missing data that maintains the variance of my variable?”</p>
    <p class="normal">In keeping with the hands-on nature of this text, every bit of output is reproducible with code in this book. I also stuck to a rule throughout, even when it was challenging. Every recipe starts with raw data largely unchanged from the original downloaded file. You go from data file to better prepared data in each recipe. If you have forgotten how a particular object was created, all you will ever need to do is turn back a page or two to see.</p>
    <p class="normal">Readers who have some knowledge of pandas and NumPy will have an easier time with some code blocks, as will folks with some knowledge of Python and introductory statistics. None of that is essential though. There are just some recipes you might want to pause over longer.</p>
    <h1 id="_idParaDest-7" class="heading-1">What this book covers</h1>
    <p class="normal"><em class="chapterRef">Chapter 1</em>, <em class="italic">Anticipating Data Cleaning Issues When Importing Tabular Data with pandas</em>, explores tools for loading CSV files, Excel files, relational database tables, SAS, SPSS, Stata, and R files into pandas DataFrames.</p>
    <p class="normal"><em class="chapterRef">Chapter 2</em>, <em class="italic">Anticipating Data Cleaning Issues When Working with HTML, JSON, and Spark Data</em>, discusses techniques for reading and normalizing JSON data, web scraping, and working with big data using Spark. It also explores techniques for persisting data, including with versioning.</p>
    <p class="normal"><em class="chapterRef">Chapter 3</em>, <em class="italic">Taking the Measure of Your Data</em>, introduces common techniques for navigating around a DataFrame, selecting columns and rows, and generating summary statistics. The use of OpenAI tools for examining dataset structure and generating statistics is introduced.</p>
    <p class="normal"><em class="chapterRef">Chapter 4</em>, <em class="italic">Identifying Outliers in Subsets of Data</em>, explores a wide range of strategies to identify outliers across a whole DataFrame and by selected groups.</p>
    <p class="normal"><em class="chapterRef">Chapter 5</em>, <em class="italic">Using Visualizations for the Identification of Unexpected Values</em>, demonstrates the use of the Matplotlib and Seaborn tools to visualize how key variables are distributed, including with histograms, boxplots, scatter plots, line plots, and violin plots.</p>
    <p class="normal"><em class="chapterRef">Chapter 6</em>, <em class="italic">Cleaning and Exploring Data with Series Operations</em>, discusses updating pandas Series with scalars, arithmetic operations, and conditional statements based on the values of one or more Series.</p>
    <p class="normal"><em class="chapterRef">Chapter 7</em>, <em class="italic">Identifying and Fixing Missing Values</em>, goes over strategies for identifying missing values across rows and columns, and over subsets of data. It explores strategies for imputing values, such as setting values to the overall mean or the mean for a given category and forward filling. It also examines multivariate techniques for imputing values for missing values and discusses when they are appropriate.</p>
    <p class="normal"><em class="chapterRef">Chapter 8</em>, <em class="italic">Encoding, Transforming, and Scaling Features</em>, covers a range of variable transformation techniques to prepare features and targets for predictive analysis. This includes the most common kinds of encoding—one-hot, ordinal, and hashing encoding; transformations to improve the distribution of variables; and binning and scaling approaches to address skewness, kurtosis, and outliers and to adjust for features with widely different ranges.</p>
    <p class="normal"><em class="chapterRef">Chapter 9</em>, <em class="italic">Fixing Messy Data When Aggregating</em>, demonstrates multiple approaches to aggregating data by group, including looping through data with <code class="inlineCode">itertuples</code> or NumPy arrays, dropping duplicate rows, and using pandas’ groupby and pivot tables. It also discusses when to choose one approach over the others.</p>
    <p class="normal"><em class="chapterRef">Chapter 10</em>, <em class="italic">Addressing Data Issues When Combining DataFrames</em>, examines different strategies for concatenating and merging data, and how to anticipate common data challenges when combining data.</p>
    <p class="normal"><em class="chapterRef">Chapter 11</em>, <em class="italic">Tidying and Reshaping Data</em>, introduces several strategies for de-duplicating, stacking, melting, and pivoting data.</p>
    <p class="normal"><em class="chapterRef">Chapter 12</em>, <em class="italic">Automate Data Cleaning with User-Defined Functions and Classes and Pipelines</em>, examines how to turn many of the techniques from the first 11 chapters into reuseable code.</p>
    <h2 id="_idParaDest-8" class="heading-2">Download the example code files</h2>
    <p class="normal">The code bundle for the book is hosted on GitHub at <a href="https://github.com/PacktPublishing/Python-Data-Cleaning-Cookbook-Second-Edition"><span class="url">https://github.com/PacktPublishing/Python-Data-Cleaning-Cookbook-Second-Edition</span></a>. We also have other code bundles from our rich catalog of books and videos available at <a href="https://github.com/PacktPublishing/"><span class="url">https://github.com/PacktPublishing/</span></a>. Check them out!</p>
    <h2 id="_idParaDest-9" class="heading-2">Download the color images</h2>
    <p class="normal">We also provide a PDF file that has color images of the screenshots/diagrams used in this book. You can download it here: <a href="https://packt.link/gbp/9781803239873"><span class="url">https://packt.link/gbp/9781803239873</span></a>.</p>
    <h1 id="_idParaDest-10" class="heading-1">Conventions used</h1>
    <p class="normal">There are a number of text conventions used throughout this book.</p>
    <p class="normal"><code class="inlineCode">Code in text</code>: Indicates code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. Here is an example: “Mount the downloaded <code class="inlineCode">WebStorm-10*.dmg</code> disk image file as another disk in your system.”</p>
    <p class="normal">A block of code is set as follows:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> sys
nls97 = pd.read_csv(<span class="hljs-string">"data/nls97g.csv"</span>, low_memory=<span class="hljs-literal">False</span>)
nls97.set_index(<span class="hljs-string">'personid'</span>, inplace=<span class="hljs-literal">True</span>)
</code></pre>
    <p class="normal">Any output from the code will appear like this:</p>
    <pre class="programlisting con"><code class="hljs-con">       satverbal  satmath
min           14        7
per15        390      390
qr1          430      430
med          500      500
qr3          570      580
per85        620      621
max          800      800
count      1,406    1,407
mean         500      501
iqr          140      150
</code></pre>
    <p class="normal"><strong class="keyWord">Bold</strong>: Indicates a new term, an important word, or words that you see onscreen. For example, words in menus or dialog boxes appear in the text like this. Here is an example: “Select <strong class="keyWord">System info</strong> from the <strong class="keyWord">Administration</strong> panel.”</p>
    <div class="note">
      <p class="normal">Warnings or important notes appear like this.</p>
    </div>
    <div class="packt_tip">
      <p class="normal">Tips and tricks appear like this.</p>
    </div>
    <h1 id="_idParaDest-11" class="heading-1">Get in touch</h1>
    <p class="normal">Feedback from our readers is always welcome.</p>
    <p class="normal"><strong class="keyWord">General feedback</strong>: Email <code class="inlineCode">feedback@packtpub.com</code> and mention the book’s title in the subject of your message. If you have questions about any aspect of this book, please email us at <code class="inlineCode">questions@packtpub.com</code>.</p>
    <p class="normal"><strong class="keyWord">Errata</strong>: Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you reported this to us. Please visit <a href="http://www.packtpub.com/submit-errata"><span class="url">http://www.packtpub.com/submit-errata</span></a>, click <strong class="keyWord">Submit Errata</strong>, and fill in the form.</p>
    <p class="normal"><strong class="keyWord">Piracy</strong>: If you come across any illegal copies of our works in any form on the internet, we would be grateful if you would provide us with the location address or website name. Please contact us at <code class="inlineCode">copyright@packtpub.com</code> with a link to the material.</p>
    <p class="normal"><strong class="keyWord">If you are interested in becoming an author</strong>: If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, please visit <a href="http://authors.packtpub.com"><span class="url">http://authors.packtpub.com</span></a>.</p>
  </div>
  <div id="_idContainer007" class="Basic-Text-Frame">
    <p class="eop"/>
    <h1 id="_idParaDest-12" class="heading-1">Share your thoughts</h1>
    <p class="normal">Once you’ve read <em class="italic">Python Data Cleaning Cookbook, Second Edition</em>, we’d love to hear your thoughts! Please <a href="https://packt.link/r/1803239875"><span class="url">click here to go straight to the Amazon review page</span></a> for this book and share your feedback.</p>
    <p class="normal">Your review is important to us and the tech community and will help us make sure we’re delivering excellent quality content.</p>
  </div>
  <div id="_idContainer009" class="Basic-Text-Frame">
    <p class="eop"/>
    <h1 id="_idParaDest-13" class="heading-1">Download a free PDF copy of this book</h1>
    <p class="normal">Thanks for purchasing this book!</p>
    <p class="normal">Do you like to read on the go but are unable to carry your print books everywhere?</p>
    <p class="normal">Is your eBook purchase not compatible with the device of your choice?</p>
    <p class="normal">Don’t worry, now with every Packt book you get a DRM-free PDF version of that book at no cost.</p>
    <p class="normal">Read anywhere, any place, on any device. Search, copy, and paste code from your favorite technical books directly into your application.</p>
    <p class="normal">The perks don’t stop there, you can get exclusive access to discounts, newsletters, and great free content in your inbox daily.</p>
    <p class="normal">Follow these simple steps to get the benefits:</p>
    <ol>
      <li class="numberedList" value="1">Scan the QR code or visit the link below:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B18596_Free_PDF_QR.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">https://packt.link/free-ebook/9781803239873</p>
    <ol>
      <li class="numberedList" value="2">Submit your proof of purchase.</li>
      <li class="numberedList">That’s it! We’ll send your free PDF and other benefits to your email directly.</li>
    </ol>
  </div>
</body></html>