<html><head></head><body>
<div epub:type="chapter" id="_idContainer181">
<h1 class="chapter-number" id="_idParaDest-210"><a id="_idTextAnchor211"/><span class="koboSpan" id="kobo.1.1">11</span></h1>
<h1 id="_idParaDest-211"><a id="_idTextAnchor212"/><span class="koboSpan" id="kobo.2.1">Recent Developments in  Time Series Analysis</span></h1>
<p><span class="koboSpan" id="kobo.3.1">As we reach the last chapter of this book, let’s do a brief recap of the journey we have been through. </span><span class="koboSpan" id="kobo.3.2">Starting with an introduction to time series and its components in </span><a href="B18568_01.xhtml#_idTextAnchor016"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.4.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.5.1">, we looked at the different use cases for time series analysis in </span><a href="B18568_02.xhtml#_idTextAnchor044"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.6.1">Chapter 2</span></em></span></a><span class="koboSpan" id="kobo.7.1">. </span><span class="koboSpan" id="kobo.7.2">We were then introduced to Apache Spark, its architecture, and how it works in </span><a href="B18568_03.xhtml#_idTextAnchor063"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.8.1">Chapter 3</span></em></span></a><span class="koboSpan" id="kobo.9.1">. </span><span class="koboSpan" id="kobo.9.2">Before delving into the details of how Apache Spark is used for time series analysis, we stepped back, in </span><a href="B18568_04.xhtml#_idTextAnchor087"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.10.1">Chapter 4</span></em></span></a><span class="koboSpan" id="kobo.11.1">, to look at the big picture of an end-to-end time series project. </span><span class="koboSpan" id="kobo.11.2">We then turned our focus to each of the main stages of a project from </span><a href="B18568_05.xhtml#_idTextAnchor103"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.12.1">Chapter 5</span></em></span></a><span class="koboSpan" id="kobo.13.1"> to </span><a href="B18568_09.xhtml#_idTextAnchor169"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.14.1">Chapter 9</span></em></span></a><span class="koboSpan" id="kobo.15.1">, covering data preparation, exploratory data analysis, model development, testing, scaling, and going to production. </span><span class="koboSpan" id="kobo.15.2">In </span><a href="B18568_10.xhtml#_idTextAnchor190"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.16.1">Chapter 10</span></em></span></a><span class="koboSpan" id="kobo.17.1">, we covered ways to go further with Apache Spark by using a managed data and AI platform such </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">as Databricks.</span></span></p>
<p><span class="koboSpan" id="kobo.19.1">In this concluding chapter, we will explore recent developments in the field of time series analysis, covering emerging methodologies, tools, and trends. </span><span class="koboSpan" id="kobo.19.2">We will cover an approach from the exciting field of generative AI applied to time series forecasting. </span><span class="koboSpan" id="kobo.19.3">Having a forecasting mechanism in place is great but not enough. </span><span class="koboSpan" id="kobo.19.4">Another area of interesting development is how forecasting is served and made available on demand to data analysts and applications. </span><span class="koboSpan" id="kobo.19.5">End users can also benefit from new approaches to making the outcome of time series analysis accessible to them in </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">non-technical ways.</span></span></p>
<p><span class="koboSpan" id="kobo.21.1">In this chapter, we’re going to cover the following </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">main topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.23.1">Generative AI for </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">time series</span></span></li>
<li><span class="koboSpan" id="kobo.25.1">Serving forecasts </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">via API</span></span></li>
<li><span class="koboSpan" id="kobo.27.1">Democratizing access to time </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">series analysis</span></span></li>
</ul>
<h1 id="_idParaDest-212"><a id="_idTextAnchor213"/><span class="koboSpan" id="kobo.29.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.30.1">We will be using a Databricks environment for the platform infrastructure. </span><span class="koboSpan" id="kobo.30.2">To set up the environment, follow the instructions in the </span><em class="italic"><span class="koboSpan" id="kobo.31.1">Environment setup</span></em><span class="koboSpan" id="kobo.32.1"> section of </span><a href="B18568_10.xhtml#_idTextAnchor190"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.33.1">Chapter 10</span></em></span></a><span class="No-Break"><span class="koboSpan" id="kobo.34.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.35.1">The code for this chapter can be found at </span><span class="No-Break"><span class="koboSpan" id="kobo.36.1">this URL:</span></span></p>
<p><a href="https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/tree/main/ch11"><span class="No-Break"><span class="koboSpan" id="kobo.37.1">https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/tree/main/ch11</span></span></a></p>
<h1 id="_idParaDest-213"><a id="_idTextAnchor214"/><span class="koboSpan" id="kobo.38.1">Generative AI for time series analysis</span></h1>
<p><span class="koboSpan" id="kobo.39.1">While effective, traditional time series models have limitations in performance and accuracy, especially </span><a id="_idIndexMarker873"/><span class="koboSpan" id="kobo.40.1">with large-scale data or </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">complex patterns.</span></span></p>
<p><span class="koboSpan" id="kobo.42.1">Generative AI, and </span><a id="_idIndexMarker874"/><span class="koboSpan" id="kobo.43.1">particularly </span><strong class="bold"><span class="koboSpan" id="kobo.44.1">time series transformers</span></strong><span class="koboSpan" id="kobo.45.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.46.1">TSTs</span></strong><span class="koboSpan" id="kobo.47.1">), offers a solution to these challenges. </span><span class="koboSpan" id="kobo.47.2">Similar to the transformer models in </span><strong class="bold"><span class="koboSpan" id="kobo.48.1">natural language processing</span></strong><span class="koboSpan" id="kobo.49.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.50.1">NLP</span></strong><span class="koboSpan" id="kobo.51.1">), TSTs are adept at capturing complex, non-linear </span><a id="_idIndexMarker875"/><span class="koboSpan" id="kobo.52.1">dependencies over long sequences. </span><span class="koboSpan" id="kobo.52.2">This capability makes them suitable for real-world data that includes missing values, seasonality, and irregular patterns. </span><span class="koboSpan" id="kobo.52.3">TSTs use a self-attention mechanism to analyze time series data and identify seasonal patterns. </span><span class="koboSpan" id="kobo.52.4">These models are pre-trained on vast datasets to create foundation models, which can then be fine-tuned for specific time </span><span class="No-Break"><span class="koboSpan" id="kobo.53.1">series applications.</span></span></p>
<p><span class="koboSpan" id="kobo.54.1">Recently, several pre-built TSTs have been released enabling us to leverage their capabilities without requiring effort to engineer such solutions. </span><span class="koboSpan" id="kobo.54.2">Examples include Chronos, Moira, TimesFM, and TimeGPT, </span><span class="No-Break"><span class="koboSpan" id="kobo.55.1">among others.</span></span></p>
<p><span class="koboSpan" id="kobo.56.1">In the next section, we will examine the practicalities of using one of these </span><span class="No-Break"><span class="koboSpan" id="kobo.57.1">with TimesFM.</span></span></p>
<h2 id="_idParaDest-214"><a id="_idTextAnchor215"/><span class="koboSpan" id="kobo.58.1">Introduction to TimesFM</span></h2>
<p><strong class="bold"><span class="koboSpan" id="kobo.59.1">TimesFM</span></strong><span class="koboSpan" id="kobo.60.1">, short for </span><strong class="bold"><span class="koboSpan" id="kobo.61.1">Time Series Foundation Model</span></strong><span class="koboSpan" id="kobo.62.1">, is an open source forecasting model </span><a id="_idIndexMarker876"/><span class="koboSpan" id="kobo.63.1">developed by Google Research, designed </span><a id="_idIndexMarker877"/><span class="koboSpan" id="kobo.64.1">specifically for time series data. </span><span class="koboSpan" id="kobo.64.2">Built on a transformer-based architecture, TimesFM is versatile, handling a wide range of forecasting tasks from short-term to long-term predictions. </span><span class="koboSpan" id="kobo.64.3">Unlike models such as Chronos, which treat time series similarly to natural language, TimesFM includes specialized mechanisms for time series data, such as seasonality handling, support for missing values, and capturing </span><span class="No-Break"><span class="koboSpan" id="kobo.65.1">multivariate dependencies.</span></span></p>
<p><span class="koboSpan" id="kobo.66.1">Pre-trained on over 100 billion real-world time series points, TimesFM generalizes effectively to new datasets, often providing accurate zero-shot predictions without additional training. </span><span class="koboSpan" id="kobo.66.2">This extensive pre-training allows TimesFM to recognize both short- and </span><a id="_idIndexMarker878"/><span class="koboSpan" id="kobo.67.1">long-term dependencies in time series data, making it highly useful for applications requiring an understanding of seasonal patterns </span><span class="No-Break"><span class="koboSpan" id="kobo.68.1">and trends.</span></span></p>
<p><span class="koboSpan" id="kobo.69.1">For an </span><a id="_idIndexMarker879"/><span class="koboSpan" id="kobo.70.1">overview of the TimesFM architecture and a detailed explanation, we recommend consulting the original research paper, </span><em class="italic"><span class="koboSpan" id="kobo.71.1">A decoder-only foundation model for time-series </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.72.1">forecasting</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.73.1">, here:</span></span></p>
<p><a href="https://research.google/blog/a-decoder-only-foundation-model-for-time-series-forecasting/"><span class="No-Break"><span class="koboSpan" id="kobo.74.1">https://research.google/blog/a-decoder-only-foundation-model-for-time-series-forecasting/</span></span></a></p>
<p><span class="koboSpan" id="kobo.75.1">We will see TimesFM in action with a forecasting example in the </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">next section.</span></span></p>
<h2 id="_idParaDest-215"><a id="_idTextAnchor216"/><span class="koboSpan" id="kobo.77.1">Forecasting</span></h2>
<p><span class="koboSpan" id="kobo.78.1">For the </span><a id="_idIndexMarker880"/><span class="koboSpan" id="kobo.79.1">time series forecasting example in this section, we will be using the Databricks environment as set up in the </span><em class="italic"><span class="koboSpan" id="kobo.80.1">Technical requirements</span></em><span class="koboSpan" id="kobo.81.1"> section. </span><span class="koboSpan" id="kobo.81.2">The code for this section can be uploaded into the Databricks workspace from the </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">following URL:</span></span></p>
<p><a href="https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch11/ts_spark_ch11_timesFM.dbc"><span class="No-Break"><span class="koboSpan" id="kobo.83.1">https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch11/ts_spark_ch11_timesFM.dbc</span></span></a></p>
<p><span class="koboSpan" id="kobo.84.1">You can use the Databricks serverless compute to execute the code, as we did in </span><a href="B18568_10.xhtml#_idTextAnchor190"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.85.1">Chapter 10</span></em></span></a><span class="koboSpan" id="kobo.86.1">. </span><span class="koboSpan" id="kobo.86.2">Alternatively, you can use the Databricks Runtime for ML. </span><span class="koboSpan" id="kobo.86.3">Version 14.3 is required for compatibility with the version of Python supported by TimesFM at the time </span><span class="No-Break"><span class="koboSpan" id="kobo.87.1">of writing.</span></span></p>
<p><span class="koboSpan" id="kobo.88.1">We will go through the steps to install and use TimesFM here, with code extracts. </span><span class="koboSpan" id="kobo.88.2">Refer to the notebook for the </span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">full code:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.90.1">Install the following necessary libraries: </span><strong class="source-inline"><span class="koboSpan" id="kobo.91.1">timesfm[torch]</span></strong><span class="koboSpan" id="kobo.92.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.93.1">torch</span></strong><span class="koboSpan" id="kobo.94.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.95.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.96.1">sktime</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.97.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.98.1">Specify the hyperparameters (</span><strong class="source-inline"><span class="koboSpan" id="kobo.99.1">hparams</span></strong><span class="koboSpan" id="kobo.100.1">) and load the TimesFM model from a checkpoint in Hugging Face (</span><strong class="source-inline"><span class="koboSpan" id="kobo.101.1">huggingface_repos_id</span></strong><span class="koboSpan" id="kobo.102.1">). </span><span class="koboSpan" id="kobo.102.2">Note that </span><strong class="source-inline"><span class="koboSpan" id="kobo.103.1">500m</span></strong><span class="koboSpan" id="kobo.104.1"> refers to </span><a id="_idIndexMarker881"/><span class="koboSpan" id="kobo.105.1">the 500 million parameters supported by the model, and we will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.106.1">pytorch</span></strong><span class="koboSpan" id="kobo.107.1"> version due to compatibility </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">with Databricks:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.109.1">
# Initialize the TimesFm model with specified hyperparameters 
# and load from checkpoint
model = timesfm.TimesFm(
    </span><strong class="bold"><span class="koboSpan" id="kobo.110.1">hparams</span></strong><span class="koboSpan" id="kobo.111.1"> = timesfm.TimesFmHparams(
        backend="gpu",
        per_core_batch_size=32,
        horizon_len=128,
        num_layers=50,
        use_positional_embedding=False,
        context_len=2048,
    ),
    checkpoint = timesfm.TimesFmCheckpoint(
        </span><strong class="bold"><span class="koboSpan" id="kobo.112.1">huggingface_repo_id</span></strong><span class="koboSpan" id="kobo.113.1">="google/timesfm-2.0-</span><strong class="bold"><span class="koboSpan" id="kobo.114.1">500m</span></strong><span class="koboSpan" id="kobo.115.1">-</span><strong class="bold"><span class="koboSpan" id="kobo.116.1">pytorch</span></strong><span class="koboSpan" id="kobo.117.1">"
    )
)</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.118.1">While we have used the default values for the hyperparameters, you will need to experiment to find the best ones to use depending on your </span><span class="No-Break"><span class="koboSpan" id="kobo.119.1">forecasting requirement.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.120.1">With the TimesFM model loaded, we can bring in the dataset for forecasting. </span><span class="koboSpan" id="kobo.120.2">We will reuse the energy consumption dataset from </span><a href="B18568_10.xhtml#_idTextAnchor190"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.121.1">Chapter 10</span></em></span></a><span class="koboSpan" id="kobo.122.1">. </span><span class="koboSpan" id="kobo.122.2">Before proceeding with the next step, you must execute the code example, including the feature engineering pipeline from the </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">previous chapter.</span></span></p></li> <li><span class="koboSpan" id="kobo.124.1">We will read from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.125.1">features_aggr_power_consumption</span></strong><span class="koboSpan" id="kobo.126.1"> table and convert </span><a id="_idIndexMarker882"/><span class="koboSpan" id="kobo.127.1">the Spark DataFrame into a pandas DataFrame, which is required by TimesFM. </span><span class="koboSpan" id="kobo.127.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.128.1">Date</span></strong><span class="koboSpan" id="kobo.129.1"> column is renamed to </span><strong class="source-inline"><span class="koboSpan" id="kobo.130.1">date</span></strong><span class="koboSpan" id="kobo.131.1"> and converted to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.132.1">datetime</span></strong><span class="koboSpan" id="kobo.133.1"> format, as expected by </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">the model:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.135.1">
# Define catalog, schema, and table names
CATALOG_NAME = "ts_spark"
SCHEMA_NAME = "ch10"
ACTUALS_TABLE_NAME = f"{CATALOG_NAME}.{SCHEMA_NAME}.</span><strong class="bold"><span class="koboSpan" id="kobo.136.1">features_aggr_power_consumption</span></strong><span class="koboSpan" id="kobo.137.1">"
FORECAST_TABLE_NAME = f"{CATALOG_NAME}.{SCHEMA_NAME}.forecast"
# Load data from the actuals table into a Spark DataFrame
sdf = spark.sql(f"""
    SELECT * FROM {ACTUALS_TABLE_NAME}
""")
# Convert Spark DataFrame to Pandas DataFrame
df = sdf.toPandas()
# Convert 'Date' column to datetime format
df['</span><strong class="bold"><span class="koboSpan" id="kobo.138.1">date</span></strong><span class="koboSpan" id="kobo.139.1">'] = pd.to_</span><strong class="bold"><span class="koboSpan" id="kobo.140.1">datetime</span></strong><span class="koboSpan" id="kobo.141.1">(df['</span><strong class="bold"><span class="koboSpan" id="kobo.142.1">Date</span></strong><span class="koboSpan" id="kobo.143.1">'])</span></pre></li> <li><span class="koboSpan" id="kobo.144.1">As the forecasting is done in batches, we must convert the DataFrame using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.145.1">get_batched_data_fn</span></strong><span class="koboSpan" id="kobo.146.1"> function. </span><span class="koboSpan" id="kobo.146.2">The important part, shown in the following </span><a id="_idIndexMarker883"/><span class="koboSpan" id="kobo.147.1">code extract, is the mapping of </span><strong class="source-inline"><span class="koboSpan" id="kobo.148.1">inputs</span></strong><span class="koboSpan" id="kobo.149.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.150.1">outputs</span></strong><span class="koboSpan" id="kobo.151.1">. </span><span class="koboSpan" id="kobo.151.2">The code is based on an adaptation of an example </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">from TimesFM</span></span><p class="list-inset"><span class="koboSpan" id="kobo.153.1">(</span><a href="https://github.com/google-research/timesfm/blob/master/notebooks/covariates.ipynb"><span class="No-Break"><span class="koboSpan" id="kobo.154.1">https://github.com/google-research/timesfm/blob/master/notebooks/covariates.ipynb</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.155.1">):</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.156.1">
# Function to create a data pipeline for batching time series
# data
def </span><strong class="bold"><span class="koboSpan" id="kobo.157.1">get_batched_data_fn</span></strong><span class="koboSpan" id="kobo.158.1">(
    …
    examples["</span><strong class="bold"><span class="koboSpan" id="kobo.159.1">inputs</span></strong><span class="koboSpan" id="kobo.160.1">"].append(
        sub_df["hourly_Global_active_power"][
            start:(context_end := start + context_len)
        ].tolist())
    …
    examples["</span><strong class="bold"><span class="koboSpan" id="kobo.161.1">outputs</span></strong><span class="koboSpan" id="kobo.162.1">"].append(
        sub_df["hourly_Global_active_power"][
            context_end:(context_end + horizon_len)
        ].tolist())
    …</span></pre></li> <li><span class="koboSpan" id="kobo.163.1">We can then iterate over the batches of input data to generate the forecast using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.164.1">forecast</span></strong><span class="koboSpan" id="kobo.165.1"> function, as in the following </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">code extract:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.167.1">
# Iterate over the batches of data
for i, example in enumerate(input_data()):
    # Generate raw forecast using the model
    raw_forecast, _ = model.</span><strong class="bold"><span class="koboSpan" id="kobo.168.1">forecast</span></strong><span class="koboSpan" id="kobo.169.1">(
        inputs=example["inputs"],
        freq=[0] * len(example["inputs"])
    )</span></pre></li> <li><span class="koboSpan" id="kobo.170.1">We evaluate </span><a id="_idIndexMarker884"/><span class="koboSpan" id="kobo.171.1">the forecast using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.172.1">mdape</span></strong><span class="koboSpan" id="kobo.173.1"> metric, as we have done in the previous chapters.  </span><span class="koboSpan" id="kobo.173.2">This is comparable to </span><a href="B18568_10.xhtml#_idTextAnchor190"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.174.1">Chapter 10</span></em></span></a><span class="No-Break"><span class="koboSpan" id="kobo.175.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.176.1">
# Calculate and store the evaluation metric for the forecast
metrics["eval_mdape_timesfm"].extend([
    </span><strong class="bold"><span class="koboSpan" id="kobo.177.1">mdape</span></strong><span class="koboSpan" id="kobo.178.1">(
        pd.DavtaFrame(raw_forecast[:, :horizon_len]),
        pd.DataFrame(example["outputs"])
    )
])</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.179.1">This gives the </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">following result:</span></span></p><pre class="source-code"><strong class="bold"><span class="koboSpan" id="kobo.181.1">eval_mdape_timesfm: 0.36983413500008916</span></strong></pre></li> </ol>
<p><span class="koboSpan" id="kobo.182.1">As we have seen in this section, using a pre-trained transformer-based foundation model such as TimesFM, with default hyperparameters, gives us comparable accuracy to the different approaches we have used in the previous chapters. </span><span class="koboSpan" id="kobo.182.2">With hyperparameter tuning and the use of covariates, which will be discussed next, we can seek to further </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">improve accuracy.</span></span></p>
<h2 id="_idParaDest-216"><a id="_idTextAnchor217"/><span class="koboSpan" id="kobo.184.1">Support for covariates</span></h2>
<p><span class="koboSpan" id="kobo.185.1">An important </span><a id="_idIndexMarker885"/><span class="koboSpan" id="kobo.186.1">feature of TimesFM is its </span><a id="_idIndexMarker886"/><span class="koboSpan" id="kobo.187.1">support for external </span><strong class="bold"><span class="koboSpan" id="kobo.188.1">covariates</span></strong><span class="koboSpan" id="kobo.189.1">, as time series rarely occur in isolation. </span><span class="koboSpan" id="kobo.189.2">Various factors, such as economic indicators or weather conditions, can correlate with a time series, and incorporating these into the analysis can improve prediction accuracy. </span><span class="koboSpan" id="kobo.189.3">Put simply, a covariate is a separate variable that can help us forecast a </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">time series.</span></span></p>
<p><span class="koboSpan" id="kobo.191.1">TimesFM accommodates both univariate and multivariate forecasting with covariates, enabling it to capture correlations between the target series and these external variables. </span><span class="koboSpan" id="kobo.191.2">By inputting covariates as parallel sequences, the model learns how they relate to future values over time, enhancing its adaptability to real-world scenarios where external factors significantly impact outcomes. </span><span class="koboSpan" id="kobo.191.3">For example, we can investigate using the </span><a id="_idIndexMarker887"/><span class="koboSpan" id="kobo.192.1">estimation of road traffic to forecast pollution levels. </span><span class="koboSpan" id="kobo.192.2">This capability to support covariates gives TimesFM a predictive edge over traditional time series models and other foundational models that do not incorporate </span><span class="No-Break"><span class="koboSpan" id="kobo.193.1">these variables.</span></span></p>
<p><span class="koboSpan" id="kobo.194.1">You can find </span><a id="_idIndexMarker888"/><span class="koboSpan" id="kobo.195.1">more information on covariates support with an </span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">example here:</span></span></p>
<p><a href="https://community.databricks.com/t5/technical-blog/genai-for-time-series-analysis-with-timesfm/ba-p/95507"><span class="No-Break"><span class="koboSpan" id="kobo.197.1">https://community.databricks.com/t5/technical-blog/genai-for-time-series-analysis-with-timesfm/ba-p/95507</span></span></a></p>
<h2 id="_idParaDest-217"><a id="_idTextAnchor218"/><span class="koboSpan" id="kobo.198.1">Other generative AI models and Many Model Forecasting</span></h2>
<p><span class="koboSpan" id="kobo.199.1">You can test other generative models to find the best one for your use case. </span><span class="koboSpan" id="kobo.199.2">One way to do this </span><a id="_idIndexMarker889"/><span class="koboSpan" id="kobo.200.1">is with the </span><strong class="bold"><span class="koboSpan" id="kobo.201.1">Many Model Forecasting</span></strong><span class="koboSpan" id="kobo.202.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.203.1">MMF</span></strong><span class="koboSpan" id="kobo.204.1">) Solution Accelerator by Databricks. </span><span class="koboSpan" id="kobo.204.2">This offers a solution for organizations needing to </span><a id="_idIndexMarker890"/><span class="koboSpan" id="kobo.205.1">create forecasts </span><a id="_idIndexMarker891"/><span class="koboSpan" id="kobo.206.1">across numerous time series, such as for sales, demand, or inventory predictions. </span><span class="koboSpan" id="kobo.206.2">The repository provides a scalable approach using Databricks </span><a id="_idIndexMarker892"/><span class="koboSpan" id="kobo.207.1">to deploy and manage many forecasting models simultaneously. </span><span class="koboSpan" id="kobo.207.2">It includes resources such as notebooks, model templates, and data pipelines that streamline the process of training, evaluating, and deploying time series models on a </span><span class="No-Break"><span class="koboSpan" id="kobo.208.1">large scale.</span></span></p>
<p><span class="koboSpan" id="kobo.209.1">You can find more </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">information here:</span></span></p>
<p><a href="https://github.com/databricks-industry-solutions/many-model-forecasting"><span class="No-Break"><span class="koboSpan" id="kobo.211.1">https://github.com/databricks-industry-solutions/many-model-forecasting</span></span></a></p>
<p><span class="koboSpan" id="kobo.212.1">With generative AI and MMF now part of our time series analysis toolkit, let's explore how we can enhance the availability of forecasts for applications and </span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">data analysts.</span></span></p>
<h1 id="_idParaDest-218"><a id="_idTextAnchor219"/><span class="koboSpan" id="kobo.214.1">Serving forecasts via API</span></h1>
<p><span class="koboSpan" id="kobo.215.1">The main part of this book has focused on preparing and analyzing a time series dataset. </span><span class="koboSpan" id="kobo.215.2">We also </span><a id="_idIndexMarker893"/><span class="koboSpan" id="kobo.216.1">covered presenting the analysis’s outcomes in tables and graphs in notebooks and reporting dashboards. </span><span class="koboSpan" id="kobo.216.2">However, in many cases, forecasts must be served on-demand to data analysts and applications. </span><span class="koboSpan" id="kobo.216.3">We will now explore ways to </span><span class="No-Break"><span class="koboSpan" id="kobo.217.1">achieve this.</span></span></p>
<h2 id="_idParaDest-219"><a id="_idTextAnchor220"/><span class="koboSpan" id="kobo.218.1">Forecasting simplified with ai_forecast</span></h2>
<p><span class="koboSpan" id="kobo.219.1">In this situation, the data analyst has access to time series data and wants to provide this as </span><a id="_idIndexMarker894"/><span class="koboSpan" id="kobo.220.1">input to get a forecast without first having to develop a model. </span><span class="koboSpan" id="kobo.220.2">By abstracting the forecast behind a function such as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.221.1">ai_forecast</span></strong><span class="koboSpan" id="kobo.222.1"> function on </span><a id="_idIndexMarker895"/><span class="koboSpan" id="kobo.223.1">the Databricks platform, the ability to forecast can be greatly simplified for someone without knowledge of forecasting models </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">and algorithms.</span></span></p>
<p><span class="koboSpan" id="kobo.225.1">You can see this action with a simple example at the </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">following URL:</span></span></p>
<p><a href="https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch11/ts_spark_ch11_aiforecast.dbc"><span class="No-Break"><span class="koboSpan" id="kobo.227.1">https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch11/ts_spark_ch11_aiforecast.dbc</span></span></a></p>
<p><span class="koboSpan" id="kobo.228.1">This code is based on the example in the documentation, the link to which is provided at the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.229.1">this section:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.230.1">
SELECT *
FROM </span><strong class="bold"><span class="koboSpan" id="kobo.231.1">AI_FORECAST</span></strong><span class="koboSpan" id="kobo.232.1">(
    TABLE(aggregated),
    horizon =&gt; '2016-03-31',
    time_col =&gt; 'ds',
    value_col =&gt; 'revenue'
)</span></pre> <p><span class="koboSpan" id="kobo.233.1">The output of running this example is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.234.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.235.1">.1</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.236.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer171">
<span class="koboSpan" id="kobo.237.1"><img alt="" src="image/B18568_11_1.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.238.1">Figure 11.1: Example output of ai_forecast</span></p>
<p><span class="koboSpan" id="kobo.239.1">You can find and zoom in on a digital version of </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.240.1">Figure </span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.241.1">11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.242.1">.1</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.243.1"> here:</span></span></p>
<p><span class="No-Break"><span class="koboSpan" id="kobo.244.1">https://packt.link/vg87q</span></span></p>
<p><span class="koboSpan" id="kobo.245.1">Note that </span><a id="_idIndexMarker896"/><span class="koboSpan" id="kobo.246.1">this feature is in public preview at the time of this writing, so you may need to request access from Databricks to </span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">try it.</span></span></p>
<p><span class="koboSpan" id="kobo.248.1">You can find more </span><span class="No-Break"><span class="koboSpan" id="kobo.249.1">information here:</span></span></p>
<p><a href="https://docs.databricks.com/en/sql/language-manual/functions/ai_forecast.html"><span class="No-Break"><span class="koboSpan" id="kobo.250.1">https://docs.databricks.com/en/sql/language-manual/functions/ai_forecast.html</span></span></a></p>
<p><span class="koboSpan" id="kobo.251.1">While a simplified </span><a id="_idIndexMarker897"/><span class="koboSpan" id="kobo.252.1">and predefined function such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.253.1">ai_function</span></strong><span class="koboSpan" id="kobo.254.1"> is a great way to quickly generate a forecast, we may want to make our own custom-developed forecasting model accessible easily to other applications, as we will </span><span class="No-Break"><span class="koboSpan" id="kobo.255.1">cover next.</span></span></p>
<h2 id="_idParaDest-220"><a id="_idTextAnchor221"/><span class="koboSpan" id="kobo.256.1">Model Serving</span></h2>
<p><span class="koboSpan" id="kobo.257.1">In some cases, we need to programmatically get a forecast from our model from another </span><a id="_idIndexMarker898"/><span class="koboSpan" id="kobo.258.1">application. </span><span class="koboSpan" id="kobo.258.2">For such application-to-application integration, the use of a REST API is a common practice. </span><span class="koboSpan" id="kobo.258.3">One way to provide a REST API interface </span><a id="_idIndexMarker899"/><span class="koboSpan" id="kobo.259.1">to our model is by using Databricks’ </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.260.1">Model Serving</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.262.1">Databricks’ Model Serving provides the functionality for deploying, governing, and querying ML and AI models, for both real-time and batch inference. </span><span class="koboSpan" id="kobo.262.2">The deployed model is accessible via a REST API, which enables integration into web or client applications. </span><span class="koboSpan" id="kobo.262.3">Various model types are supported, including custom Python models packaged in the MLflow format and open foundation models provided. </span><span class="koboSpan" id="kobo.262.4">This service is designed for high availability and low latency, automatically scaling to </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">changing demand.</span></span></p>
<p><span class="koboSpan" id="kobo.264.1">Here’s an overview of the steps to serve a model. </span><span class="koboSpan" id="kobo.264.2">Note that this is not a working example. </span><span class="koboSpan" id="kobo.264.3">The screenshots shown here are to illustrate the </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">steps only:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.266.1">Access the model in Unity Catalog as per </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.267.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.268.1">.2</span></em><span class="koboSpan" id="kobo.269.1"> and click the </span><strong class="bold"><span class="koboSpan" id="kobo.270.1">Serve this model</span></strong><span class="koboSpan" id="kobo.271.1"> button at the </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">top right.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer172">
<span class="koboSpan" id="kobo.273.1"><img alt="" src="image/B18568_11_2.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.274.1">Figure 11.2: Model in Unity Catalog</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.275.1">Create a </span><a id="_idIndexMarker900"/><span class="koboSpan" id="kobo.276.1">serving endpoint as per </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.277.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.278.1">.3</span></em><span class="koboSpan" id="kobo.279.1">. </span><span class="koboSpan" id="kobo.279.2">This will show the URL to use to access the REST API to invoke </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">the model.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer173">
<span class="koboSpan" id="kobo.281.1"><img alt="" src="image/B18568_11_3.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.282.1">Figure 11.3: Create serving endpoint</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.283.1">When creating the serving endpoint, we can enable an inference table, as per </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.284.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.285.1">.4</span></em><span class="koboSpan" id="kobo.286.1">, to store all the input and output of interactions with the model </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">REST API.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer174">
<span class="koboSpan" id="kobo.288.1"><img alt="" src="image/B18568_11_4.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.289.1">Figure 11.4: Inference tables</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.290.1">Once created, the </span><a id="_idIndexMarker901"/><span class="koboSpan" id="kobo.291.1">serving endpoint will be shown with the status of </span><strong class="bold"><span class="koboSpan" id="kobo.292.1">Ready</span></strong><span class="koboSpan" id="kobo.293.1">, as per </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.294.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.295.1">.5</span></em><span class="koboSpan" id="kobo.296.1">, and can </span><span class="No-Break"><span class="koboSpan" id="kobo.297.1">be used.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer175">
<span class="koboSpan" id="kobo.298.1"><img alt="" src="image/B18568_11_5.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.299.1">Figure 11.5: Serving endpoint is ready</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.300.1">As the serving endpoint is used, its metrics can be monitored, as per </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.301.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.302.1">.6</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.303.1">.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer176">
<span class="koboSpan" id="kobo.304.1"><img alt="" src="image/B18568_11_6.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.305.1">Figure 11.6: Service endpoint metrics</span></p>
<p><span class="koboSpan" id="kobo.306.1">You can </span><a id="_idIndexMarker902"/><span class="koboSpan" id="kobo.307.1">find more information on Model </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">Serving here:</span></span></p>
<p><a href="https://docs.databricks.com/en/machine-learning/serve-models.html"><span class="No-Break"><span class="koboSpan" id="kobo.309.1">https://docs.databricks.com/en/machine-learning/serve-models.html</span></span></a></p>
<p><span class="koboSpan" id="kobo.310.1">As we have seen in this section, exposing our time series analysis model via a REST API makes it easier to integrate the analysis with other applications. </span><span class="koboSpan" id="kobo.310.2">Continuing on the accessibility of time series analysis, we will look next at how to facilitate this for end users </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">as well.</span></span></p>
<h1 id="_idParaDest-221"><a id="_idTextAnchor222"/><span class="koboSpan" id="kobo.312.1">Democratizing access to time series analysis</span></h1>
<p><span class="koboSpan" id="kobo.313.1">In this section, we will explore how innovative approaches to accessing the outcome of time </span><a id="_idIndexMarker903"/><span class="koboSpan" id="kobo.314.1">series can benefit non-technical users. </span><span class="koboSpan" id="kobo.314.2">This allows us to democratize time series analysis for the benefit of an even </span><span class="No-Break"><span class="koboSpan" id="kobo.315.1">broader audience.</span></span></p>
<h2 id="_idParaDest-222"><a id="_idTextAnchor223"/><span class="koboSpan" id="kobo.316.1">Genie spaces</span></h2>
<p><span class="koboSpan" id="kobo.317.1">In the </span><a id="_idIndexMarker904"/><span class="koboSpan" id="kobo.318.1">first approach, we will be using a natural language </span><a id="_idIndexMarker905"/><span class="koboSpan" id="kobo.319.1">chatbot-like interface on Databricks called </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.320.1">Genie spaces</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.322.1">The Databricks Genie spaces is a conversational UI enabling business users to ask questions in natural language and receive analytical insights without requiring technical expertise. </span><span class="koboSpan" id="kobo.322.2">This works by configuring Genie spaces with relevant datasets, sample queries, and instructions. </span><span class="koboSpan" id="kobo.322.3">Users can then interact in natural language, asking questions and visualizations about the data. </span><span class="koboSpan" id="kobo.322.4">Genie uses annotated table and column metadata to translate the </span><a id="_idIndexMarker906"/><span class="koboSpan" id="kobo.323.1">user queries into SQL statements. </span><span class="koboSpan" id="kobo.323.2">These are used to query the data so that Genie can provide responses </span><span class="No-Break"><span class="koboSpan" id="kobo.324.1">to users.</span></span></p>
<p><span class="koboSpan" id="kobo.325.1">To see </span><a id="_idIndexMarker907"/><span class="koboSpan" id="kobo.326.1">this in practice, we will use the dashboard that we created in </span><a href="B18568_10.xhtml#_idTextAnchor190"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.327.1">Chapter 10</span></em></span></a><span class="koboSpan" id="kobo.328.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.329.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.330.1">.7</span></em><span class="koboSpan" id="kobo.331.1">. </span><span class="koboSpan" id="kobo.331.2">This is one way to access Genie – from the dashboard, we can click on the top-left </span><strong class="bold"><span class="koboSpan" id="kobo.332.1">Ask Genie</span></strong><span class="koboSpan" id="kobo.333.1"> button. </span><span class="koboSpan" id="kobo.333.2">This opens a chatbot-like interface at the bottom right, where we can start typing questions in natural language. </span><span class="koboSpan" id="kobo.333.3">Alternatively, we can choose to open the Genie space in a </span><span class="No-Break"><span class="koboSpan" id="kobo.334.1">full screen.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer177">
<span class="koboSpan" id="kobo.335.1"><img alt="" src="image/B18568_11_7.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.336.1">Figure 11.7: Access to Genie space from the dashboard</span></p>
<p><span class="koboSpan" id="kobo.337.1">In </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.338.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.339.1">.8</span></em><span class="koboSpan" id="kobo.340.1">, we can see the complete Genie space with a query, the results, and the generated SQL used to get </span><span class="No-Break"><span class="koboSpan" id="kobo.341.1">the results.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer178">
<span class="koboSpan" id="kobo.342.1"><img alt="" src="image/B18568_11_8.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.343.1">Figure 11.8: Genie spaces query and results</span></p>
<p><span class="koboSpan" id="kobo.344.1">The query </span><a id="_idIndexMarker908"/><span class="koboSpan" id="kobo.345.1">in this example is to show </span><strong class="bold"><span class="koboSpan" id="kobo.346.1">Forecasted vs. </span><span class="koboSpan" id="kobo.346.2">Actual</span></strong><span class="koboSpan" id="kobo.347.1">, which can also </span><a id="_idIndexMarker909"/><span class="koboSpan" id="kobo.348.1">be requested as a visualization, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.349.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.350.1">.9</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.351.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer179">
<span class="koboSpan" id="kobo.352.1"><img alt="" src="image/B18568_11_9.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.353.1">Figure 11.9: Genie spaces visualization</span></p>
<p><span class="koboSpan" id="kobo.354.1">You can </span><a id="_idIndexMarker910"/><span class="koboSpan" id="kobo.355.1">find more information on Databricks Genie spaces </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">here: </span></span><a href="https://docs.databricks.com/en/genie/index.html"><span class="No-Break"><span class="koboSpan" id="kobo.357.1">https://docs.databricks.com/en/genie/index.html</span></span></a></p>
<h2 id="_idParaDest-223"><a id="_idTextAnchor224"/><span class="koboSpan" id="kobo.358.1">Apps</span></h2>
<p><span class="koboSpan" id="kobo.359.1">In cases where more application-like interactivity is required, a dashboard or chatbot interface </span><a id="_idIndexMarker911"/><span class="koboSpan" id="kobo.360.1">is not sufficient to meet the users’ needs. </span><span class="koboSpan" id="kobo.360.2">Databricks Apps provides a platform to build and deploy applications directly within the </span><a id="_idIndexMarker912"/><span class="koboSpan" id="kobo.361.1">Databricks environment. </span><span class="koboSpan" id="kobo.361.2">Currently in public preview, Databricks Apps supports development frameworks such as Dash, Shiny, Gradio, Streamlit, and Flask, for the creation of data visualizations, AI applications, self-service analytics, and other </span><span class="No-Break"><span class="koboSpan" id="kobo.362.1">data applications.</span></span></p>
<p><span class="koboSpan" id="kobo.363.1">You can </span><a id="_idIndexMarker913"/><span class="koboSpan" id="kobo.364.1">find more information on Databricks Apps </span><span class="No-Break"><span class="koboSpan" id="kobo.365.1">here: </span></span><a href="https://www.databricks.com/blog/introducing-databricks-apps"><span class="No-Break"><span class="koboSpan" id="kobo.366.1">https://www.databricks.com/blog/introducing-databricks-apps</span></span></a></p>
<h1 id="_idParaDest-224"><a id="_idTextAnchor225"/><span class="koboSpan" id="kobo.367.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.368.1">In this final chapter, we delved into recent advancements in time series analysis, focusing on emerging methodologies, tools, and trends. </span><span class="koboSpan" id="kobo.368.2">We tried the innovative approach from the dynamic field of generative AI applied to time series forecasting. </span><span class="koboSpan" id="kobo.368.3">To answer the growing requirement for forecasts via API, we explored ways to provide on-demand forecasting to data analysts and applications. </span><span class="koboSpan" id="kobo.368.4">We concluded with the use of an AI chatbot and Databricks Apps to democratize access to time series analysis for </span><span class="No-Break"><span class="koboSpan" id="kobo.369.1">non-technical users.</span></span></p>
<p><span class="koboSpan" id="kobo.370.1">As we arrive at the end of the book, looking back at our journey and the skills we acquired, we have built a solid foundation on the multiple stages of time series analysis projects with Apache Spark and other components. </span><span class="koboSpan" id="kobo.370.2">Armed with the multiple use cases discussed in </span><a href="B18568_02.xhtml#_idTextAnchor044"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.371.1">Chapter 2</span></em></span></a><span class="koboSpan" id="kobo.372.1">, the practical skills gained throughout the book, and the recent advancements in this chapter, we have the necessary ingredients to succeed in production-ready, scalable, and future-proofed time series analysis projects </span><span class="No-Break"><span class="koboSpan" id="kobo.373.1">across industries.</span></span></p>
<p><span class="koboSpan" id="kobo.374.1">We began this book with Pericles' wise counsel on the importance of time—now, at the end of this book, we have the ability to uncover the valuable insights hidden in time series and use them to our benefit. </span><span class="koboSpan" id="kobo.374.2">May this knowledge empower you to tackle challenges with new ideas and confidence. </span><span class="koboSpan" id="kobo.374.3">Wishing you happy learning and success on your journey with time series analysis and </span><span class="No-Break"><span class="koboSpan" id="kobo.375.1">Apache Spark!</span></span></p>
<h1 id="_idParaDest-225"><a id="_idTextAnchor226"/><span class="koboSpan" id="kobo.376.1">Join our community on Discord</span></h1>
<p><span class="koboSpan" id="kobo.377.1">Join our community’s Discord space for discussions with the authors and </span><span class="No-Break"><span class="koboSpan" id="kobo.378.1">other readers:</span></span></p>
<p><a href="https://packt.link/ds"><span class="No-Break"><span class="koboSpan" id="kobo.379.1">https://packt.link/ds</span></span></a></p>
<div>
<div class="IMG---Figure" id="_idContainer180">
<span class="koboSpan" id="kobo.380.1"><img alt="Join our community on Discord " src="image/ds_(1).jpg"/></span>
</div>
</div>
</div>
</body></html>