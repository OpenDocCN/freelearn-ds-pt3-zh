["```py\n    import pandas as pd\n    import numpy as np\n    nls97 = pd.read_csv(\"data/nls97.csv\")\n    covidtotals = pd.read_csv(\"data/covidtotals.csv\",\n    ...   parse_dates=['lastdate']) \n    ```", "```py\nnls97.set_index(\"personid\", inplace=True)\nnls97.index \n```", "```py\nIndex([100061, 100139, 100284, 100292, 100583, 100833,             \t\t...\n            999543, 999698, 999963],\n           dtype='int64', name='personid', length=8984) \n```", "```py\nnls97.shape \n```", "```py\n(8984, 88) \n```", "```py\nnls97.index.nunique() \n```", "```py\n8984 \n```", "```py\n    nls97.info() \n    ```", "```py\n    <class 'pandas.core.frame.DataFrame'>\n    Int64Index: 8984 entries, 100061 to 999963\n    Data columns (total 88 columns):\n     #   Column                Non-Null Count\t\tDtype \n    ---  ------                --------------\t\t----- \n     0   gender\t\t\t8984 non-null\t\tobject\n     1   birthmonth\t\t8984 non-null\t\tint64 \n     2   birthyear\t\t8984 non-null\t\tint64 \n     3   highestgradecompleted\t6663 non-null\t\tfloat64\n     4   maritalstatus\t\t6672 non-null\t\tobject\n     5   childathome\t\t4791 non-null\t\tfloat64\n     6   childnotathome\t\t4791 non-null\t\tfloat64\n     7   wageincome\t\t5091 non-null\t\tfloat64\n     8   weeklyhrscomputer\t6710 non-null\t\tobject\n     9   weeklyhrstv\t\t6711 non-null\t\tobject\n     10  nightlyhrssleep\t6706 non-null\t\tfloat64\n     11  satverbal\t\t1406 non-null\t\tfloat64\n     12  satmath\t\t\t1407 non-null\t\tfloat64\n    ...\n     83  colenroct15\t\t7469 non-null\t\tobject\n     84  colenrfeb16\t\t7036 non-null\t\tobject\n     85  colenroct16\t\t6733 non-null\t\tobject\n     86  colenrfeb17\t\t6733 non-null\t\tobject\n     87  colenroct17\t\t6734 non-null\t\tobject\n    dtypes: float64(29), int64(2), object(57)\n    memory usage: 6.1+ MB \n    ```", "```py\nnls97.head(2).T \n```", "```py\npersonid\t\t\t100061\t\t\t100139\ngender\t\t\tFemale\t\t\tMale\nbirthmonth\t\t\t5\t\t\t9\nbirthyear\t\t\t1980\t\t\t1983\nhighestgradecompleted\t13\t\t\t12\nmaritalstatus\t\tMarried\t\t\tMarried\n...\t                     \t...           \t\t...\ncolenroct15\t\t\t1\\. Not enrolled\t1\\. Not enrolled\ncolenrfeb16\t\t\t1\\. Not enrolled\t1\\. Not enrolled\ncolenroct16\t\t\t1\\. Not enrolled\t1\\. Not enrolled\ncolenrfeb17\t\t\t1\\. Not enrolled\t1\\. Not enrolled\ncolenroct17\t\t\t1\\. Not enrolled\t1\\. Not enrolled \n```", "```py\ncovidtotals.set_index(\"iso_code\", inplace=True)\ncovidtotals.index \n```", "```py\nIndex(['AFG', 'ALB', 'DZA', 'ASM', 'AND', 'AGO', 'AIA', 'ATG', 'ARG',\n       'ARM',\n       ...\n       'URY', 'UZB', 'VUT', 'VAT', 'VEN', 'VNM', 'WLF', 'YEM', 'ZMB',\n       'ZWE'],\n      dtype='object', name='iso_code', length=231) \n```", "```py\ncovidtotals.shape \n```", "```py\n(231, 16) \n```", "```py\ncovidtotals.index.nunique() \n```", "```py\n231 \n```", "```py\n    covidtotals.info() \n    ```", "```py\n    <class 'pandas.core.frame.DataFrame'>\n    Index: 231 entries, AFG to ZWE\n    Data columns (total 16 columns):\n     #\tColumn\t\t\tNon-Null Count  \tDtype        \n    ---  ------\t\t\t--------------  \t-----        \n     0\tlastdate\t\t231 non-null\t\tdatetime64[ns]\n     1\tlocation\t\t231 non-null\t\tobject       \n     2\ttotal_cases\t\t231 non-null\t\tfloat64      \n     3\ttotal_deaths\t\t231 non-null\t\tfloat64      \n     4\ttotal_cases_pm\t\t231 non-null\t\tfloat64      \n     5\ttotal_deaths_pm\t231 non-null\t\tfloat64      \n     6\tpopulation\t\t231 non-null\t\tint64        \n     7\tpop_density\t\t209 non-null\t\tfloat64      \n     8\tmedian_age\t\t194 non-null\t\tfloat64      \n     9\tgdp_per_capita\t\t191 non-null\t\tfloat64      \n     10\thosp_beds\t\t170 non-null\t\tfloat64      \n     11\tvac_per_hund\t\t13 non-null\t\tfloat64      \n     12\taged_65_older\t\t188 non-null\t\tfloat64      \n     13\tlife_expectancy\t227 non-null\t\tfloat64      \n     14\thum_dev_ind\t\t187 non-null\t\tfloat64      \n     15\tregion\t\t\t231 non-null\t\tobject       \n    dtypes: datetime64[ns](1), float64(12), int64(1), object(2)\n    memory usage: 38.8+ KB \n    ```", "```py\n    covidtotals.sample(2, random_state=1).T \n    ```", "```py\n    iso_code\t\tGHA\t\tNIU\n    lastdate\t\t2023-12-03\t2023-12-31\n    location\t\tGhana\t\tNiue\n    total_cases\t\t171,834\t\t993\n    total_deaths\t\t1,462\t\t0\n    total_cases_pm\t5,133\t\t508,709\n    total_deaths_pm\t44\t\t0\n    population\t\t33475870\t1952\n    pop_density\t\t127\t\tNaN\n    median_age\t\t21\t\tNaN\n    gdp_per_capita\t4,228\t\tNaN\n    hosp_beds\t\t1\t\tNaN\n    vac_per_hund\t\tNaN\t\tNaN\n    aged_65_older\t3\t\tNaN\n    life_expectancy\t64\t\t74\n    hum_dev_ind\t\t1\t\tNaN\n    region\t\tWest Africa\tOceania / Aus \n    ```", "```py\nimport pandas as pd\nimport numpy as np\nnls97 = pd.read_csv(\"data/nls97.csv\")\nnls97.set_index(\"personid\", inplace=True)\nnls97[nls97.select_dtypes(['object']).columns] = \\\n  nls97.select_dtypes(['object']). \\\n  transform(lambda x: x.astype('category')) \n```", "```py\nanalysisdemo = nls97['gender']\ntype(analysisdemo) \n```", "```py\n<class 'pandas.core.series.Series'> \n```", "```py\nanalysisdemo = nls97[['gender']]\ntype(analysisdemo) \n```", "```py\n<class 'pandas.core.frame.DataFrame'> \n```", "```py\nanalysisdemo = nls97.loc[:,['gender']]\ntype(analysisdemo) \n```", "```py\n<class 'pandas.core.frame.DataFrame'> \n```", "```py\nanalysisdemo = nls97.iloc[:,[0]]\ntype(analysisdemo) \n```", "```py\n<class 'pandas.core.frame.DataFrame'> \n```", "```py\nanalysisdemo = nls97[['gender','maritalstatus',\n...  'highestgradecompleted']]\nanalysisdemo.shape \n```", "```py\n(8984, 3) \n```", "```py\nanalysisdemo.head() \n```", "```py\n gender\t\tmaritalstatus\t\thighestgradecompleted\npersonid                                             \n100061\tFemale\t\tMarried\t\t\t13\n100139\tMale\t\tMarried\t\t\t12\n100284\tMale\t\tNever-married\t\t7\n100292\tMale\t\tNaN\t\t\tnan\n100583\tMale\t\tMarried\t\t\t13 \n```", "```py\nanalysisdemo = nls97.loc[:,['gender','maritalstatus',\n...  'highestgradecompleted']]\nanalysisdemo.shape \n```", "```py\n(8984, 3) \n```", "```py\nanalysisdemo.head() \n```", "```py\n gender  \tmaritalstatus\t\thighestgradecompleted\npersonid                                             \n100061\tFemale\t\tMarried\t\t\t13\n100139\tMale\t\tMarried\t\t\t12\n100284\tMale\t\tNever-married\t\t7\n100292\tMale\t\tNaN\t\t\tnan\n100583\tMale\t\tMarried\t\t\t13 \n```", "```py\nkeyvars = ['gender','maritalstatus',\n...  'highestgradecompleted','wageincome',\n...  'gpaoverall','weeksworked17','colenroct17']\nanalysiskeys = nls97[keyvars]\nanalysiskeys.info() \n```", "```py\n<class 'pandas.core.frame.DataFrame'>\nInt64Index: 8984 entries, 100061 to 999963\nData columns (total 7 columns):\n #   Column\t\t\tNon-Null Count\t\tDtype  \n---  ------\t\t\t--------------\t\t-----  \n 0   gender\t\t\t8984 non-null\t\tcategory\n 1   maritalstatus\t\t6672 non-null\t\tcategory\n 2   highestgradecompleted\t6663 non-null\t\tfloat64\n 3   wageincome\t\t5091 non-null\t\tfloat64\n 4   gpaoverall\t\t6004 non-null\t\tfloat64\n 5   weeksworked17\t\t6670 non-null\t\tfloat64\n 6   colenroct17\t\t6734 non-null\t\tcategory\ndtypes: category(3), float64(4)\nmemory usage: 377.7 KB \n```", "```py\nanalysiswork = nls97.filter(like=\"weeksworked\")\nanalysiswork.info() \n```", "```py\n<class 'pandas.core.frame.DataFrame'>\nInt64Index: 8984 entries, 100061 to 999963\nData columns (total 18 columns):\n #   Column         Non-Null Count  Dtype \n---  ------         --------------  ----- \n 0   weeksworked00  8603 non-null   float64\n 1   weeksworked01  8564 non-null   float64\n 2   weeksworked02  8556 non-null   float64\n 3   weeksworked03  8490 non-null   float64\n 4   weeksworked04  8458 non-null   float64\n 5   weeksworked05  8403 non-null   float64\n 6   weeksworked06  8340 non-null   float64\n 7   weeksworked07  8272 non-null   float64\n 8   weeksworked08  8186 non-null   float64\n 9   weeksworked09  8146 non-null   float64\n 10  weeksworked10  8054 non-null   float64\n 11  weeksworked11  7968 non-null   float64\n 12  weeksworked12  7747 non-null   float64\n 13  weeksworked13  7680 non-null   float64\n 14  weeksworked14  7612 non-null   float64\n 15  weeksworked15  7389 non-null   float64\n 16  weeksworked16  7068 non-null   float64\n 17  weeksworked17  6670 non-null   float64\ndtypes: float64(18)\nmemory usage: 1.3 MB \n```", "```py\nanalysiscats = nls97.select_dtypes(include=[\"category\"])\nanalysiscats.info() \n```", "```py\n<class 'pandas.core.frame.DataFrame'>\nInt64Index: 8984 entries, 100061 to 999963\nData columns (total 57 columns):\n #   Column\t\t\tNon-Null Count\t\tDtype  \n---  ------\t\t\t--------------\t\t-----  \n 0   gender\t\t\t8984 non-null\t\tcategory\n 1   maritalstatus\t\t6672 non-null\t\tcategory\n 2   weeklyhrscomputer\t6710 non-null\t\tcategory\n 3   weeklyhrstv\t\t6711 non-null\t\tcategory\n 4   highestdegree\t\t8953 non-null\t\tcategory\n...\n 49  colenrfeb14\t\t7624 non-null\t\tcategory\n 50  colenroct14\t\t7469 non-null\t\tcategory\n 51  colenrfeb15\t\t7469 non-null\t\tcategory\n 52  colenroct15\t\t7469 non-null\t\tcategory\n 53  colenrfeb16\t\t7036 non-null\t\tcategory\n 54  colenroct16\t\t6733 non-null\t\tcategory\n 55  colenrfeb17\t\t6733 non-null\t\tcategory\n 56  colenroct17\t\t6734 non-null\t\tcategory\ndtypes: category(57)\nmemory usage: 580.0 KB \n```", "```py\ndemo = ['gender','birthmonth','birthyear']\nhighschoolrecord = ['satverbal','satmath','gpaoverall',\n...  'gpaenglish','gpamath','gpascience']\ngovresp = ['govprovidejobs','govpricecontrols',\n...   'govhealthcare','govelderliving','govindhelp',\n...   'govunemp','govincomediff','govcollegefinance',\n...   'govdecenthousing','govprotectenvironment']\ndemoadult = ['highestgradecompleted','maritalstatus',\n...   'childathome','childnotathome','wageincome',\n...   'weeklyhrscomputer','weeklyhrstv','nightlyhrssleep',\n...   'highestdegree']\nweeksworked = ['weeksworked00','weeksworked01',\n...   'weeksworked02','weeksworked03','weeksworked04',\n       ...\n      'weeksworked14','weeksworked15','weeksworked16',\n...   'weeksworked17']\ncolenr = ['colenrfeb97','colenroct97','colenrfeb98',\n...   'colenroct98','colenrfeb99','colenroct99',\n       .\n...   'colenrfeb15','colenroct15','colenrfeb16',...   'colenroct16','colenrfeb17','colenroct17'] \n```", "```py\n    nls97 = nls97[demoadult + demo + highschoolrecord + \\\n    ...   govresp + weeksworked + colenr]\n    nls97.dtypes \n    ```", "```py\n    highestgradecompleted\tfloat64\n    maritalstatus\t\tcategory\n    childathome\t\t\tfloat64\n    childnotathome\t\tfloat64\n    wageincome\t\t\tfloat64\n                               ...  \n    colenroct15\t\t\tcategory\n    colenrfeb16\t\t\tcategory\n    colenroct16\t\t\tcategory\n    colenrfeb17\t\t\tcategory\n    colenroct17\t\t\tcategory\n    Length: 88, dtype: object \n    ```", "```py\nnls97.select_dtypes(exclude=[\"category\"]).info() \n```", "```py\n<class 'pandas.core.frame.DataFrame'>\nInt64Index: 8984 entries, 100061 to 999963\nData columns (total 31 columns):\n #   Column\t\t\t\tNon-Null Count\t\tDtype \n---  ------\t\t\t\t--------------\t\t----- \n 0   highestgradecompleted\t\t6663 non-null\t\tfloat64\n 1   childathome\t\t\t4791 non-null\t\tfloat64\n 2   childnotathome\t\t4\t791 non-null\t\tfloat64\n 3   wageincome\t\t\t5091 non-null\t\tfloat64\n 4   nightlyhrssleep\t\t6706 non-null\t\tfloat64\n 5   birthmonth\t\t\t8984 non-null\t\tint64 \n 6   birthyear\t\t\t8984 non-null\t\tint64 \n...\n 25  weeksworked12\t\t\t7747 non-null\t\tfloat64\n 26  weeksworked13\t\t\t7680 non-null\t\tfloat64\n 27  weeksworked14\t\t\t7612 non-null\t\tfloat64\n 28  weeksworked15\t\t\t7389 non-null\t\tfloat64\n 29  weeksworked16\t\t\t7068 non-null\t\tfloat64\n 30  weeksworked17\t\t\t6670 non-null\t\tfloat64\ndtypes: float64(29), int64(2)\nmemory usage: 2.2 MB \n```", "```py\nnls97.filter(regex='income') \n```", "```py\n wageincome\tgovincomediff\npersonid                         \n100061\t12,500\t\tNaN\n100139\t120,000\t\tNaN\n100284\t58,000\t\tNaN\n100292\tnan\t\tNaN\n100583\t30,000\t\tNaN\n...\t\t...\t\t...\n999291\t35,000\t\tNaN\n999406\t116,000\t\tNaN\n999543\tnan\t\tNaN\n999698\tnan\t\tNaN\n999963\t50,000\t\tNaN \n```", "```py\n    import pandas as pd\n    import numpy as np\n    nls97 = pd.read_csv(\"data/nls97.csv\")\n    nls97.set_index(\"personid\", inplace=True) \n    ```", "```py\nnls97[1000:1004].T \n```", "```py\npersonid                 195884  195891           195970           195996\ngender                   Male    Male             Female           Female\nbirthmonth               12      9                3                9\nbirthyear                1981    1980             1982             1980\nhighestgradecompleted    NaN     12               17               NaN\nmaritalstatus            NaN     Never-married    Never-married    NaN\n...                      ...     ...              ...              ...colenroct15              NaN     1\\. Not enrolled  1\\. Not enrolled  NaN\ncolenrfeb16              NaN     1\\. Not enrolled  1\\. Not enrolled  NaN\ncolenroct16              NaN     1\\. Not enrolled  1\\. Not enrolled  NaN\ncolenrfeb17              NaN     1\\. Not enrolled  1\\. Not enrolled  NaN\ncolenroct17              NaN     1\\. Not enrolled  1\\. Not enrolled  NaN \n```", "```py\nnls97[1000:1004:2].T \n```", "```py\npersonid\t\t\t195884\t\t195970\ngender\t\t\tMale\t\tFemale\nbirthmonth\t\t\t12\t\t3\nbirthyear\t\t\t1981\t\t1982\nhighestgradecompleted\tNaN\t\t17\nmaritalstatus\t\tNaN\t\tNever-married\n...\t\t\t\t...\t\t...\ncolenroct15\t\t\tNaN\t\t1\\. Not enrolled\ncolenrfeb16\t\t\tNaN\t\t1\\. Not enrolled\ncolenroct16\t\t\tNaN\t\t1\\. Not enrolled\ncolenrfeb17\t\t\tNaN\t\t1\\. Not enrolled\ncolenroct17\t\t\tNaN\t\t1\\. Not enrolled \n```", "```py\nnls97[:3].T \n```", "```py\npersonid\t100061           100139           100284\ngender\tFemale           Male             Male\nbirthmonth\t5                9                11\nbirthyear\t1980             1983             1984\n...          ...              ...              ...\ncolenroct15\t1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\ncolenrfeb16  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\ncolenroct16  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\ncolenrfeb17  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\ncolenroct17  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled \n```", "```py\n    nls97[-3:].T \n    ```", "```py\n    personid\t999543\t999698\t999963\n    gender\tFemale\tFemale\tFemale\n    birthmonth\t8\t5\t9\n    birthyear\t1984\t1983\t1982\n    ...                      ...              ...              ...\n    colenroct15  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\n    colenrfeb16  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\n    colenroct16  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\n    colenrfeb17  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\n    colenroct17  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled \n    ```", "```py\nnls97.loc[[195884,195891,195970]].T \n```", "```py\npersonid\t\t     195884 195891\t\t195970\ngender\t\t     Male   Male\t\tFemale\nbirthmonth\t\t     12     9\t\t\t3\nbirthyear\t\t     1981   1980\t\t1982\nhighestgradecompleted    NaN    12\t\t\t17\nmaritalstatus            NaN    Never-married    Never-married\n...                      ...   ...              ...\ncolenroct15              NaN    1\\. Not enrolled  1\\. Not enrolled\ncolenrfeb16              NaN    1\\. Not enrolled  1\\. Not enrolled\ncolenroct16              NaN    1\\. Not enrolled  1\\. Not enrolled\ncolenrfeb17              NaN    1\\. Not enrolled  1\\. Not enrolled\ncolenroct17              NaN    1\\. Not enrolled  1\\. Not enrolled \n```", "```py\nnls97.loc[195884:195970].T \n```", "```py\npersonid\t\t     195884  195891\t\t 195970\ngender\t\t     Male    Male\t\t Female\nbirthmonth\t\t     12      9\t\t\t 3\nbirthyear\t\t     1981    1980\t\t 1982\nhighestgradecompleted    NaN     12\t\t 17\nmaritalstatus            NaN     Never-married    Never-married\n...                      ...     ...              ...\ncolenroct15              NaN     1\\. Not enrolled  1\\. Not enrolled\ncolenrfeb16              NaN     1\\. Not enrolled  1\\. Not enrolled\ncolenroct16              NaN     1\\. Not enrolled  1\\. Not enrolled\ncolenrfeb17              NaN     1\\. Not enrolled  1\\. Not enrolled\ncolenroct17              NaN     1\\. Not enrolled  1\\. Not enrolled \n```", "```py\nnls97.iloc[[0]].T \n```", "```py\npersonid\t\t\t100061\ngender\t\t\tFemale\nbirthmonth\t\t\t5\nbirthyear\t\t\t1980\nhighestgradecompleted\t13\nmaritalstatus\t\tMarried\n...                                ...\ncolenroct15\t\t\t1\\. Not enrolled\ncolenrfeb16\t\t\t1\\. Not enrolled\ncolenroct16\t\t\t1\\. Not enrolled\ncolenrfeb17\t\t\t1\\. Not enrolled\ncolenroct17\t\t\t1\\. Not enrolled \n```", "```py\nnls97.iloc[[0,1,2]].T \n```", "```py\npersonid      100061            100139            100284\ngender        Female            Male              Male\nbirthmonth    5                 9                 11\nbirthyear     1980              1983              1984\n...           ...               ...               ...\ncolenroct15   1\\. Not enrolled   1\\. Not enrolled   1\\. Not enrolled\ncolenrfeb16   1\\. Not enrolled   1\\. Not enrolled   1\\. Not enrolled\ncolenroct16   1\\. Not enrolled   1\\. Not enrolled   1\\. Not enrolled\ncolenrfeb17   1\\. Not enrolled   1\\. Not enrolled   1\\. Not enrolled\ncolenroct17   1\\. Not enrolled   1\\. Not enrolled   1\\. Not enrolled \n```", "```py\nnls97.iloc[[-3,-2,-1]].T \n```", "```py\npersonid\t999543           999698           999963\ngender\tFemale           Female           Female\nbirthmonth\t8                5                9\nbirthyear\t1984             1983             1982\n...          ...              ...              ...\ncolenroct15  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\ncolenrfeb16  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\ncolenroct16  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\ncolenrfeb17  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled\ncolenroct17  1\\. Not enrolled  1\\. Not enrolled  1\\. Not enrolled \n```", "```py\nnls97.nightlyhrssleep.quantile(0.05) \n```", "```py\n4.0 \n```", "```py\nnls97.nightlyhrssleep.count() \n```", "```py\n6706 \n```", "```py\nsleepcheckbool = nls97.nightlyhrssleep<=4\nsleepcheckbool \n```", "```py\npersonid\n100061    False\n100139    False\n100284    False\n100292    False\n100583    False\n          ... \n999291    False\n999406    False\n999543    False\n999698    False\n999963    False\nName: nightlyhrssleep, Length: 8984, dtype: bool \n```", "```py\nlowsleep = nls97.loc[sleepcheckbool]\nlowsleep.shape \n```", "```py\n(364, 88) \n```", "```py\nlowsleep.childathome.describe() \n```", "```py\ncount\t\t293.00\nmean\t\t1.79\nstd\t\t1.40\nmin\t\t0.00\n25%\t\t1.00\n50%\t\t2.00\n75%\t\t3.00\nmax\t\t9.00 \n```", "```py\nlowsleep3pluschildren = nls97.loc[(nls97.nightlyhrssleep<=4) & (nls97.childathome>=3)]\nlowsleep3pluschildren.shape \n```", "```py\n(82, 88) \n```", "```py\nlowsleep3pluschildren = nls97.loc[(nls97.nightlyhrssleep<=4) & (nls97.childathome>=3), ['nightlyhrssleep','childathome']]\nlowsleep3pluschildren \n```", "```py\n nightlyhrssleep\tchildathome\npersonid                             \n119754\t4\t\t\t4\n141531\t4\t\t\t5\n152706\t4\t\t\t4\n156823\t1\t\t\t3\n158355\t4\t\t\t4\n...         ...\t\t\t...\n905774\t4\t\t\t3\n907315\t4\t\t\t3\n955166\t3\t\t\t3\n956100\t4\t\t\t6\n991756\t4\t\t\t3 \n```", "```py\nnls97.loc[(nls97.nightlyhrssleep<=4) & (nls97.childathome>=3), ['nightlyhrssleep','childathome']] \n```", "```py\nimport pandas as pd\nnls97 = pd.read_csv(\"data/nls97.csv\")\nnls97.set_index(\"personid\", inplace=True)\nnls97[nls97.select_dtypes(['object']).columns] = \\\n  nls97.select_dtypes(['object']). \\\n  transform(lambda x: x.astype('category')) \n```", "```py\ncatcols = nls97.select_dtypes(include=[\"category\"]).columns\nnls97[catcols].isnull().sum() \n```", "```py\ngender\t\t0\nmaritalstatus\t2312\nweeklyhrscomputer\t2274\nweeklyhrstv\t\t2273\nhighestdegree\t31\n                    ...\ncolenroct15\t\t1515\ncolenrfeb16\t\t1948\ncolenroct16\t\t2251\ncolenrfeb17\t\t2251\ncolenroct17\t\t2250\nLength: 57, dtype: int64 \n```", "```py\n    nls97.maritalstatus.value_counts() \n    ```", "```py\n    Married\t\t3066\n    Never-married\t2766\n    Divorced\t\t663\n    Separated\t\t154\n    Widowed\t\t23\n    Name: maritalstatus, dtype: int64 \n    ```", "```py\n    nls97.maritalstatus.value_counts(sort=False) \n    ```", "```py\n    Divorced\t\t663\n    Married\t\t3066\n    Never-married\t2766\n    Separated\t\t154\n    Widowed\t\t23\n    Name: maritalstatus, dtype: int64 \n    ```", "```py\n    nls97.maritalstatus.value_counts(sort=False, normalize=True) \n    ```", "```py\n    Divorced\t\t0.10\n    Married\t\t0.46\n    Never-married\t0.41\n    Separated\t\t0.02\n    Widowed\t\t0.00\n    Name: maritalstatus, dtype: float64 \n    ```", "```py\nnls97.filter(like=\"gov\").apply(pd.Series.value_counts, normalize=True) \n```", "```py\n govprovidejobs\t\tgovpricecontrols\t...  \\\n1\\. Definitely\t0.25\t\t\t0.54\t\t\t...  \n2\\. Probably\t\t0.34\t\t\t0.33\t\t\t...  \n3\\. Probably not\t0.25\t\t\t0.09\t\t\t...  \n4\\. Definitely not\t0.16\t\t\t0.04\t\t\t...  \n                    govdecenthousing\tgovprotectenvironment \n1\\. Definitely\t0.44\t\t\t0.67 \n2\\. Probably\t\t0.43\t\t\t0.29 \n3\\. Probably not\t0.10\t\t\t0.03 \n4\\. Definitely not\t0.02\t\t\t0.02 \n```", "```py\nnls97[nls97.maritalstatus==\"Married\"].\\\n... filter(like=\"gov\").\\\n... apply(pd.Series.value_counts, normalize=True) \n```", "```py\n govprovidejobs\t\tgovpricecontrols\t...  \\\n1\\. Definitely\t0.17\t\t\t0.46\t\t\t...  \n2\\. Probably\t\t0.33\t\t\t0.38\t\t\t...  \n3\\. Probably not\t0.31\t\t\t0.11\t\t\t...  \n4\\. Definitely not\t0.18\t\t\t0.05\t\t\t...  \n                    govdecenthousing\tgovprotectenvironment \n1\\. Definitely\t0.36\t\t\t0.64 \n2\\. Probably\t\t0.49\t\t\t0.31 \n3\\. Probably not\t0.12\t\t\t0.03 \n4\\. Definitely not\t0.03\t\t\t0.01 \n```", "```py\nfor col in nls97.\\\n  select_dtypes(include=[\"category\"]):\n    print(col, \"----------------------\",\n      \"frequencies\",\n    nls97[col].value_counts(sort=False),\n      \"percentages\",\n    nls97[col].value_counts(normalize=True,\n      sort=False),\n    sep=\"\\n\\n\", end=\"\\n\\n\\n\", file=freqout)\nfreqout.close() \n```", "```py\ngender\n----------------------\nfrequencies\nFemale\t4385\nMale\t\t4599\nName: gender, dtype: int64\npercentages\nFemale\t0.49\nMale\t\t0.51\nName: gender, dtype: float64 \n```", "```py\n    import pandas as pd\n    import numpy as np\n    import matplotlib.pyplot as plt\n    covidtotals = pd.read_csv(\"data/covidtotals.csv\",\n    ...   parse_dates=['lastdate'])\n    covidtotals.set_index(\"iso_code\", inplace=True) \n    ```", "```py\n    covidtotals.shape \n    ```", "```py\n    (231, 16) \n    ```", "```py\n    covidtotals.sample(1, random_state=1).T \n    ```", "```py\n    iso_code\t\tGHA  \\\n    lastdate\t\t2023-12-03 00:00:00  \n    location\t\tGhana  \n    total_cases\t\t171,834.00  \n    total_deaths\t\t1,462.00  \n    total_cases_pm\t5,133.07  \n    total_deaths_pm\t43.67  \n    population\t\t33475870  \n    pop_density\t\t126.72  \n    median_age\t\t21.10  \n    gdp_per_capita\t4,227.63  \n    hosp_beds\t\t0.90  \n    vac_per_hund\t\tNaN  \n    aged_65_older\t3.38  \n    life_expectancy\t64.07  \n    hum_dev_ind\t\t0.61  \n    region\t\tWest Africa \n    ```", "```py\n    covidtotals.dtypes \n    ```", "```py\n    lastdate\t\tdatetime64[ns]\n    location\t\tobject\n    total_cases\t\tfloat64\n    total_deaths\t\tfloat64\n    total_cases_pm\tfloat64\n    total_deaths_pm\tfloat64\n    population\t\tint64\n    pop_density\t\tfloat64\n    median_age\t\tfloat64\n    gdp_per_capita\tfloat64\n    hosp_beds\t\tfloat64\n    vac_per_hund\t\tfloat64\n    aged_65_older\tfloat64\n    life_expectancy\tfloat64\n    hum_dev_ind\t\tfloat64\n    region\t\tobject\n    dtype: object \n    ```", "```py\n    totvars = ['total_cases',\n      'total_deaths','total_cases_pm',\n      'total_deaths_pm']\n    covidtotals[totvars].describe() \n    ```", "```py\n     total_cases  total_deaths  total_cases_pm  total_deaths_pm\n    count         231.0         231.0           231.0            231.0\n    mean    3,351,598.6      30,214.2       206,177.8          1,261.8\n    std    11,483,211.8     104,778.9       203,858.1          1,315.0\n    min             4.0           0.0           354.5              0.0\n    25%        25,671.5         177.5        21,821.9            141.2\n    50%       191,496.0       1,937.0       133,946.3            827.0\n    75%     1,294,286.0      14,150.0       345,689.8          1,997.5\n    max   103,436,829.0   1,127,152.0       763,475.4          6,507.7 \n    ```", "```py\ncovidtotals[totvars].\\\n  quantile(np.arange(0.0, 1.1, 0.1)) \n```", "```py\n total_cases\t\ttotal_deaths\t\ttotal_cases_pm \\\n0.0\t\t4.0\t\t\t0.0\t\t\t354.5  \n0.1\t\t8,359.0\t\t\t31.0\t\t\t3,138.6  \n0.2\t\t17,181.0\t\t126.0\t\t\t10,885.7  \n0.3\t\t38,008.0\t\t294.0\t\t\t35,834.6  \n0.4\t\t74,129.0\t\t844.0\t\t\t86,126.2  \n0.5\t\t191,496.0\t\t1,937.0\t\t\t133,946.3  \n0.6\t\t472,755.0\t\t4,384.0\t\t\t220,429.4  \n0.7\t\t1,041,111.0\t\t9,646.0\t\t\t293,737.4  \n0.8\t\t1,877,065.0\t\t21,218.0\t\t416,608.1  \n0.9\t\t5,641,992.0\t\t62,288.0\t\t512,388.4  \n1.0\t\t103,436,829.0\t\t1,127,152.0\t\t763,475.4  \n\t\ttotal_deaths_pm \n0.0\t\t0.0 \n0.1\t\t32.9 \n0.2\t\t105.3 \n0.3\t\t210.5 \n0.4\t\t498.8 \n0.5\t\t827.0 \n0.6\t\t1,251.3 \n0.7\t\t1,697.6 \n0.8\t\t2,271.7 \n0.9\t\t3,155.9 \n1.0\t\t6,507.7 \n```", "```py\n    plt.hist(covidtotals['total_cases']/1000, bins=12)\n    plt.title(\"Total COVID-19 Cases (in thousands)\")\n    plt.xlabel('Cases')\n    plt.ylabel(\"Number of Countries\")\n    plt.show() \n    ```", "```py\n    import pandas as pd\n    from pandasai.llm.openai import OpenAI\n    from pandasai import SmartDataframe \n    ```", "```py\n    covidtotals = pd.read_csv(\"data/covidtotals.csv\",\n      parse_dates=['lastdate'])\n    covidtotals.set_index(\"iso_code\", inplace=True)\n    llm = OpenAI(api_token=\"Your API Key\")\n    covidtotalssdf = SmartDataframe(covidtotals, config={\"llm\": llm}) \n    ```", "```py\n    covidtotalssdf.chat(\"Show me some information about the data\") \n    ```", "```py\n    <class 'pandas.core.frame.DataFrame'>\n    RangeIndex: 231 entries, 0 to 230\n    Data columns (total 17 columns):\n     #   Column           Non-Null Count  Dtype        \n    ---  ------           --------------  -----        \n     0   iso_code         231 non-null    object       \n     1   lastdate         231 non-null    datetime64[ns]\n     2   location         231 non-null    object       \n     3   total_cases      231 non-null    float64      \n     4   total_deaths     231 non-null    float64      \n     5   total_cases_pm   231 non-null    float64      \n     6   total_deaths_pm  231 non-null    float64      \n     7   population       231 non-null    int64        \n     8   pop_density      209 non-null    float64      \n     9   median_age       194 non-null    float64      \n     10  gdp_per_capita   191 non-null    float64      \n     11  hosp_beds        170 non-null    float64      \n     12  vac_per_hund     13 non-null     float64      \n     13  aged_65_older    188 non-null    float64      \n     14  life_expectancy  227 non-null    float64      \n     15  hum_dev_ind      187 non-null    float64      \n     16  region           231 non-null    object       \n    dtypes: datetime64[ns](1), float64(12), int64(1), object(3)\n    memory usage: 30.8+ KB \n    ```", "```py\n    covidtotalssdf.chat(\"Show first five rows.\") \n    ```", "```py\n     lastdate\t    location  \t\ttotal_cases       ...  \\\n    iso_code                                                           ...  \n    AFG\t\t2024-02-04\t    Afghanistan\t231,539           ...  \n    ALB\t\t2024-01-28\t    Albania\t\t334,863           ...  \n    DZA\t\t2023-12-03\t    Algeria\t\t272,010           ...  \n    ASM\t\t2023-09-17\t    American Samoa\t8,359             ...  \n    AND\t\t2023-05-07\t    Andorra\t\t48,015            ...  \n    \t\tlife_expectancy   hum_dev_ind\t\tregion \n    iso_code                                               \n    AFG\t\t65\t\t   1\t\t\tSouth Asia \n    ALB\t\t79\t\t   1\t\t\tEastern Europe \n    DZA\t\t77\t\t   1\t\t\tNorth Africa \n    ASM\t\t74\t\t   NaN\t\t\tOceania / Aus \n    AND\t\t84\t\t   1\t\t\tWestern Europe \n    [5 rows x 16 columns] \n    ```", "```py\n    covidtotalssdf.chat(\"Show total cases for locations with the five most total cases.\") \n    ```", "```py\n     location\t\ttotal_cases\n    iso_code                           \n    USA\t\tUnited States\t\t103,436,829\n    CHN\t\tChina\t\t\t99,329,249\n    IND\t\tIndia\t\t\t45,026,139\n    FRA\t\tFrance\t\t\t38,997,490\n    DEU\t\tGermany\t\t\t38,437,756 \n    ```", "```py\ncovidtotalssdf.chat(\"Show total cases pm, total deaths pm, and location for locations with the 10 highest total cases pm.\") \n```", "```py\n total_cases_pm\t  total_deaths_pm\tlocation\niso_code                                                \nBRN\t  763,475\t\t  396\t\t\tBrunei\nCYP\t  760,161\t\t  1,523\t\t\tCyprus\nSMR\t  750,727\t\t  3,740\t\t\tSan Marino\nAUT\t  680,263\t\t  2,521\t\t\tAustria\nKOR\t  667,207\t\t  693\t\t\tSouth Korea\nFRO\t  652,484\t\t  527\t\t\tFaeroe Islands\nSVN\t  639,408\t\t  4,697\t\t\tSlovenia\nGIB\t  628,883\t\t  3,458\t\t\tGibraltar\nMTQ\t  626,793\t\t  3,004\t\t\tMartinique\nLUX\t  603,439\t\t  1,544\t\t\tLuxembourg \n```", "```py\n    covidtotalsabb = covidtotalssdf.chat(\"Select total cases pm, total deaths pm, and location.\")\n    type(covidtotalsabb) \n    ```", "```py\n    pandasai.smart_dataframe.SmartDataframe \n    ```", "```py\n    covidtotalsabb \n    ```", "```py\n     total_cases_pm\t  total_deaths_pm\tlocation\n    iso_code                                                   \n    AFG\t\t5,630\t\t  194\t\t\tAfghanistan\n    ALB\t\t117,813\t\t  1,268\t\t\tAlbania\n    DZA\t\t6,058\t\t  153\t\t\tAlgeria\n    ASM\t\t188,712\t\t  768\t\t\tAmerican Samoa\n    AND\t\t601,368\t\t  1,991\t\t\tAndorra\n    \t\t...\t\t  ...\t\t\t...\n    VNM\t\t118,387\t\t  440\t\t\tVietnam\n    WLF\t\t306,140\t\t  690\t\t\tWallis and Futuna\n    YEM\t\t354\t\t  64\t\t\tYemen\n    ZMB\t\t17,450\t\t  203\t\t\tZambia\n    ZWE\t\t16,315\t\t  352\t\t\tZimbabwe\n    [231 rows x 3 columns] \n    ```", "```py\n    covidtotalsabb = covidtotalssdf.chat(\"Grab total cases pm, total deaths pm, and location.\")\n    covidtotalsabb \n    ```", "```py\n     total_cases_pm\ttotal_deaths_pm\tlocation\n    iso_code                                                   \n    AFG\t  5,630\t\t\t194\t\t\tAfghanistan\n    ALB\t  117,813\t\t1,268\t\t\tAlbania\n    DZA\t  6,058\t\t\t153\t\t\tAlgeria\n    ASM\t  188,712\t\t768\t\t\tAmerican Samoa\n    AND\t  601,368\t\t1,991\t\t\tAndorra\n    \t  ...\t\t\t...\t\t\t...\n    VNM\t  118,387\t\t440\t\t\tVietnam\n    WLF\t  306,140\t\t690\t\t\tWallis and Futuna\n    YEM\t  354\t\t\t64\t\t\tYemen\n    ZMB\t  17,450\t\t203\t\t\tZambia\n    ZWE\t  16,315\t\t352\t\t\tZimbabwe\n    [231 rows x 3 columns] \n    ```", "```py\n    covidtotalssdf.chat(\"Show total cases pm and location where total cases pm greater than 95th percentile.\") \n    ```", "```py\n     location\ttotal_cases_pm\n    iso_code                               \n    AND\t\tAndorra\t\t601,368\n    AUT\t\tAustria\t\t680,263\n    BRN\t\tBrunei\t\t763,475\n    CYP\t\tCyprus\t\t760,161\n    FRO\t\tFaeroe\t\tIslands\t652,484\n    FRA\t\tFrance\t\t603,428\n    GIB\t\tGibraltar\t628,883\n    LUX\t\tLuxembourg\t603,439\n    MTQ\t\tMartinique\t626,793\n    SMR\t\tSan Marino\t750,727\n    SVN\t\tSlovenia\t639,408\n    KOR\t\tSouth Korea\t667,207 \n    ```", "```py\n    covidtotalssdf.chat(\"Summarize values for total cases pm and total deaths pm.\").T \n    ```", "```py\n     total_cases_pm\t\ttotal_deaths_pm\n    count\t\t231\t\t\t231\n    mean\t\t206,178\t\t\t1,262\n    std\t\t203,858\t\t\t1,315\n    min\t\t354\t\t\t0\n    25%\t\t21,822\t\t\t141\n    50%\t\t133,946\t\t\t827\n    75%\t\t345,690\t\t\t1,998\n    max\t\t763,475\t\t\t6,508 \n    ```", "```py\n    covidtotalssdf.chat(\"Show sum of total cases and total deaths by region.\") \n    ```", "```py\n     region\t\t\ttotal_cases\ttotal_deaths\n    0\tCaribbean\t\t4,258,031\t32,584\n    1\tCentral Africa\t\t640,579\t\t8,128\n    2\tCentral America\t4,285,644\t54,500\n    3\tCentral Asia\t\t3,070,921\t40,365\n    4\tEast Africa\t\t2,186,107\t28,519\n    5\tEast Asia\t\t205,704,775\t604,355\n    6\tEastern Europe\t\t62,360,832\t969,011\n    7\tNorth Africa\t\t3,727,507\t83,872\n    8\tNorth America\t\t115,917,286\t1,516,239\n    9\tOceania / Aus\t\t14,741,706\t31,730\n    10\tSouth America\t\t68,751,186\t1,354,440\n    11\tSouth Asia\t\t51,507,806\t632,374\n    12\tSouthern Africa\t5,627,277\t126,376\n    13\tWest Africa\t\t953,756\t\t12,184\n    14\tWest Asia\t\t41,080,675\t360,258\n    15\tWestern Europe\t\t189,405,185\t1,124,545 \n    ```", "```py\n    covidtotalssdf.chat(\"Plot the total_cases_pm column data distribution\") \n    ```", "```py\n    covidtotalssdf.chat( \"Plot total cases pm values against total deaths pm values\") \n    ```", "```py\n    covidtotalssdf.chat(\"Use regplot to show total deaths pm against total cases pm\") \n    ```", "```py\n    covidtotalssdf.chat(\"Use regplot to show total deaths pm against total cases pm without extreme values\") \n    ```"]