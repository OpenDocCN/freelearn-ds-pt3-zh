<html><head></head><body><div class="appendix" title="Appendix&#xA0;B.&#xA0;A Brief Review of Python"><div class="titlepage"><div><div><h1 class="title"><a id="appB"/>Appendix B. A Brief Review of Python</h1></div></div></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec36"/>Introduction</h1></div></div></div><p>This appendix will give you a brief tour of the Python syntax. This is not intended to be a course on Python programming, but can be used by readers who are unfamiliar with the language as a quick introduction. The following topics will be covered in this appendix:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Basic types, expressions, and variables and their assignment</li><li class="listitem" style="list-style-type: disc">Sequence types</li><li class="listitem" style="list-style-type: disc">Dictionaries</li><li class="listitem" style="list-style-type: disc">Control structures</li><li class="listitem" style="list-style-type: disc">Functions, objects, and methods</li></ul></div></div></div>
<div class="section" title="Basic types, expressions, and variables and their assignment"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec37"/>Basic types, expressions, and variables and their assignment</h1></div></div></div><p>Any <a class="indexterm" id="id466"/>data <a class="indexterm" id="id467"/>that can be referred to in a Python code is <a class="indexterm" id="id468"/>considered an <span class="strong"><strong>object</strong></span>. Objects are used to represent<a class="indexterm" id="id469"/> everything from <span class="emphasis"><em>atomic</em></span> data, such as numbers, to very complex data structures, such as multidimensional arrays, database connections, and documents in several formats.</p><p>At the root of the object hierarchy are the numeric data types. These include the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Integers</strong></span>: There <a class="indexterm" id="id470"/>are three types of integers in <a class="indexterm" id="id471"/>Python.<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Plain integers</strong></span>: They <a class="indexterm" id="id472"/>are represented<a class="indexterm" id="id473"/> in the native architecture, which, in most systems, will be either 32- or 64-bit signed values.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Long integers</strong></span>: They are integers with unlimited range, subject to<a class="indexterm" id="id474"/> available memory. Most of <a class="indexterm" id="id475"/>the time, the programmer does not need to be concerned with the distinction between plain and long integers. Python deals with conversions between the types in a transparent way.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Booleans</strong></span>: They<a class="indexterm" id="id476"/> represent the values<a class="indexterm" id="id477"/> <code class="literal">False</code> and <code class="literal">True</code>. In most situations, they are equivalent to <code class="literal">0</code> and <code class="literal">1</code>, respectively.</li></ul></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Floats</strong></span>: They<a class="indexterm" id="id478"/> represent the native double-precision<a class="indexterm" id="id479"/> floating-point <a class="indexterm" id="id480"/>numbers.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Complex</strong></span>: They <a class="indexterm" id="id481"/>represent complex numbers, represented<a class="indexterm" id="id482"/> as <a class="indexterm" id="id483"/>a pair <a class="indexterm" id="id484"/>of <a class="indexterm" id="id485"/>double-precision floating-point numbers.</li></ul></div><p>The following<a class="indexterm" id="id486"/> table has examples of <span class="strong"><strong>literals</strong></span> (that is, <span class="strong"><strong>constants</strong></span>) for each data type:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Data type</p>
</th><th style="text-align: left" valign="bottom">
<p>Literals</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<span class="strong"><strong>Integers</strong></span>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">0</code>, <code class="literal">2</code>, <code class="literal">4</code>, …, <code class="literal">43882838388</code>
</p>
<p>
<code class="literal">5L</code>, <code class="literal">5l</code> (long integer)</p>
<p>
<code class="literal">0xFE4</code> (hexadecimal)</p>
<p>
<code class="literal">03241</code> (octal)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<span class="strong"><strong>Real numbers (float)</strong></span>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">5.34</code>, <code class="literal">1.2</code>, <code class="literal">3.</code>, <code class="literal">0</code>
</p>
<p>
<code class="literal">1.4e-32</code> (scientific notation)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<span class="strong"><strong>Complex</strong></span>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">1.0+3.4j</code>, <code class="literal">1+2j</code>, <code class="literal">1j</code>, <code class="literal">0j</code>, <code class="literal">complex(4.3, 2.5)</code>
</p>
</td></tr></tbody></table></div><p>The imaginary unit is represented by <code class="literal">j</code>, but only if it follows a number literal (otherwise, it represents the variable named <code class="literal">j</code>). So, to represent the imaginary unit we must use <code class="literal">1j</code> and the complex zero is <code class="literal">0j</code>. The real and imaginary part of a complex number are always stored as double-precision floating-point values.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note23"/>Note</h3><p>Note that the set of numeric types is greatly extended by <code class="literal">NumPy</code> to allow efficient numeric computations.</p></div></div><p>The assignment statement is used to store values in variables, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a = 3</strong></span>
<span class="strong"><strong>b = 2.28</strong></span>
<span class="strong"><strong>c = 12</strong></span>
<span class="strong"><strong>d = 1+2j</strong></span>
</pre></div><p>Python supports <span class="emphasis"><em>multiple simultaneous assignments</em></span> of values, so the previous four lines of code could be equivalently written in a single line as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a, b, c, d = 3, 2.28, 12, 1+2j</strong></span>
</pre></div><p>In a<a class="indexterm" id="id487"/> multiple assignment, all expressions in the right-hand side are evaluated<a class="indexterm" id="id488"/> before the assignments are made. For example, a common<a class="indexterm" id="id489"/> idiom to exchange the values of two variables is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>v, w = w, v</strong></span>
</pre></div><p>As an exercise, the reader can try to predict the result of the following statement, given the preceding variable assignments:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a, b, c = a + b, c + d, a * b * c * d</strong></span>
<span class="strong"><strong>print a, b, c, d</strong></span>
</pre></div><p>The following example shows how to compute the two solutions of a quadratic equation:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a, b, c = 2., -1., -4.</strong></span>
<span class="strong"><strong>x1, x2 = .5 * (-b - (b ** 2 - 4 * a * c) ** 0.5), .5 * (-b + (b ** 2 - 4 * a * c) ** 0.5)</strong></span>
<span class="strong"><strong>print x1, x2</strong></span>
</pre></div><p>Note that we force the variables <code class="literal">a</code>, <code class="literal">b</code>, and <code class="literal">c</code> to be floating-point values by using a decimal point. This is good practice when performing numerical computations. The following table contains a partial list of Python operators:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Operators</p>
</th><th style="text-align: left" valign="bottom">
<p>Python operators</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<span class="strong"><strong>Arithmetic</strong></span>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">+</code> (Addition)</p>
<p>
<code class="literal">-</code> (Subtraction, unary<a class="indexterm" id="id490"/> minus)</p>
<p>
<code class="literal">*</code> (Multiplication)</p>
<p>
<code class="literal">/</code> (Division, <span class="emphasis"><em>see the note below the table</em></span>)</p>
<p>
<code class="literal">//</code> (Integer<a class="indexterm" id="id491"/> division)</p>
<p>
<code class="literal">%</code> (Remainder)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<span class="strong"><strong>Comparison</strong></span>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">==</code> (Equal <a class="indexterm" id="id492"/>to)</p>
<p>
<code class="literal">&gt;</code> (Greater<a class="indexterm" id="id493"/> than)</p>
<p>
<code class="literal">&lt;</code> (Less than)</p>
<p>
<code class="literal">&gt;=</code> (Greater than or equal to)</p>
<p>
<code class="literal">&lt;=</code> (Less<a class="indexterm" id="id494"/> than <a class="indexterm" id="id495"/>or equal to)</p>
<p>
<code class="literal">!=</code> (Not <a class="indexterm" id="id496"/>equal<a class="indexterm" id="id497"/> to)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<span class="strong"><strong>Boolean</strong></span>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">and</code>
</p>
<p>
<code class="literal">or</code>
</p>
<p>
<code class="literal">not</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<span class="strong"><strong>Bitwise Boolean</strong></span>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">&amp;</code> (AND)</p>
<p>
<code class="literal">|</code> (OR)</p>
<p>
<code class="literal">^</code> (XOR)</p>
<p>
<code class="literal">~</code> (NOT)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<span class="strong"><strong>Bitwise shift</strong></span>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">&lt;&lt;</code> (Left <a class="indexterm" id="id498"/>shift)</p>
<p>
<code class="literal">&gt;&gt;</code> (Right <a class="indexterm" id="id499"/>shift)</p>
</td></tr></tbody></table></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note24"/>Note</h3><p>Care should be taken with the division operator (<code class="literal">/</code>). If the operands are integers, the result of this operation is the integer quotient. For example, <code class="literal">34/12</code> results <code class="literal">2</code>. To get the floating point result, we must either enter floating point operands, as in <code class="literal">34./12.</code>, or add the following statement:</p><div class="informalexample"><pre class="programlisting">from __future__ import division</pre></div><p>The <code class="literal">//</code> operator always represents integer division.</p></div></div><p>Arithmetic <a class="indexterm" id="id500"/>operators follow the rules for the order of operations<a class="indexterm" id="id501"/> that may be altered with the use of parenthesis. Comparison <a class="indexterm" id="id502"/>operators have lower precedence than arithmetic operators, and the <code class="literal">or</code>, <code class="literal">and</code>, and <code class="literal">not</code> operators have even lower precedence. So, an expression like the following one produces the expected result:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>2 + 3 &lt; 5 ** 2 and 4 * 3 != 13</strong></span>
</pre></div><p>In other words, the preceding command line is parsed as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>(((2 + 3) &lt; (5 ** 2)) and ((4 * 3) != 13))</strong></span>
</pre></div><p>The logical operators <code class="literal">and</code> and <code class="literal">or</code> short circuit, so, for example, the second comparison is never evaluated in the command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>2 &lt; 3 or 4 &gt; 5</strong></span>
</pre></div><p>The precedence rules for the bitwise and shift operators may not be as intuitive, so it is recommended to always use parenthesis to specify the order of operations, which also adds clarity to the code.</p><p>Python also supports augmented assignments. For example, the following command lines first assign the value <code class="literal">5</code> to <code class="literal">a</code>, and then increment the value of <code class="literal">a</code> by one:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a = 5</strong></span>
<span class="strong"><strong>a += 1</strong></span>
</pre></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note26"/>Note</h3><p>Python does not have increment/decrement operators, such as a++ and ++a, as in the C language.</p></div></div><p>All Python<a class="indexterm" id="id503"/> operators<a class="indexterm" id="id504"/> have a corresponding <a class="indexterm" id="id505"/>augmented assignment statement. The general semantic for any operator <code class="literal">$</code> is the following statement:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>v $= &lt;expression&gt;</strong></span>
</pre></div><p>The preceding statement is equivalent to the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>v = v $ (&lt;expression&gt;)</strong></span>
</pre></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note27"/>Note</h3><p>Note that <code class="literal">$</code> is not a valid Python operator, it is just being used as a placeholder for a generic operator.</p></div></div></div>
<div class="section" title="Sequence types"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec38"/>Sequence types</h1></div></div></div><p>Python <a class="indexterm" id="id506"/>sequence types are used to represent ordered collections of objects. They are <a class="indexterm" id="id507"/>classified into <span class="strong"><strong>mutable</strong></span> and <span class="strong"><strong>immutable</strong></span> sequence<a class="indexterm" id="id508"/> types. Here, we will only discuss <code class="literal">lists</code> (mutable) and <code class="literal">tuples</code> and <code class="literal">strings</code> (both immutable). Other sequence types are mentioned at the end of this section.</p><div class="section" title="Lists"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec27"/>Lists</h2></div></div></div><p>The following <a class="indexterm" id="id509"/>example shows how to construct a list in Python and<a class="indexterm" id="id510"/> assign it to a variable:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>numbers = [0, 1.2, 234259399992, 4+3j]</strong></span>
</pre></div><p>Individual entries in the list are accessed with index notation as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>numbers[2]</strong></span>
</pre></div><p>Notice that indexing always starts with <code class="literal">0</code>. Negative indices are allowed and they represent positions starting at the end of the list. For example, <code class="literal">numbers[-1]</code> is the last entry, <code class="literal">numbers[-2]</code> is the next-to-last entry, and so forth.</p><p>Since lists are a mutable sequence type, we are allowed to modify the entries in-place:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>numbers[0] = -3</strong></span>
<span class="strong"><strong>numbers[2] += numbers[0]</strong></span>
<span class="strong"><strong>print numbers</strong></span>
</pre></div><p>Another important way to refer to elements in a Python sequence type is slices, which allow the extraction of sublists from a list. Since this topic is very important for <code class="literal">NumPy</code> arrays, we defer the discussion to <a class="link" href="apc.html" title="Appendix C. NumPy Arrays">Appendix C</a>, <span class="emphasis"><em>NumPy Arrays</em></span>.</p><p>Python lists <a class="indexterm" id="id511"/>have a nice set of features, a few of which are illustrated in<a class="indexterm" id="id512"/> the following code examples:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">To find the length of a list, use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>len(numbers)</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To reverse a list in place, use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>numbers.reverse()</strong></span>
<span class="strong"><strong>print numbers</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To append a new element, use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>numbers.append(35)</strong></span>
<span class="strong"><strong>print numbers</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To sort the list in-place, use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>values = [1.2, 0.5, -3.4, 12.6, 3.5]</strong></span>
<span class="strong"><strong>values.sort()</strong></span>
<span class="strong"><strong>print values</strong></span>
<span class="strong"><strong>values.sort(reverse=True)</strong></span>
<span class="strong"><strong>print values</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To insert a value at a position, use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>values.insert(3, 6.8)</strong></span>
<span class="strong"><strong>print values</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To extend a list, use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>values.extend([7,8,9])</strong></span>
<span class="strong"><strong>print values</strong></span>
</pre></div></li></ul></div><p>Python has a few handy ways to construct frequently used lists. The <code class="literal">range()</code> function returns a<a class="indexterm" id="id513"/> list of equally spaced integers. The simplest form returns a list of successive integers starting at <code class="literal">0</code>:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>range(10)</strong></span>
</pre></div><p>The preceding command returns the following list:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</strong></span>
</pre></div><p>Note that the last element is one less than the argument given in the function call. The rule of thumb is that <code class="literal">range(n)</code> returns a list with <code class="literal">n</code> elements starting at zero so that the last element is <code class="literal">n-1</code>. To start at a nonzero value, use the two-argument version as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>range(3, 17)</strong></span>
</pre></div><p>A third argument specifies an <span class="emphasis"><em>increment</em></span>. The following command line produces a list of all positive multiples of 6 that are less than 100:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>range(6,100,6)</strong></span>
</pre></div><p>Negative<a class="indexterm" id="id514"/> increments can also be used:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>range(20, 2, -3)</strong></span>
</pre></div><p>Lists support <a class="indexterm" id="id515"/>concatenation, which is represented by the <code class="literal">+</code> operator:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>l1 = range(1, 10)</strong></span>
<span class="strong"><strong>l2 = range(10, 0, -1)</strong></span>
<span class="strong"><strong>l3 = l1 + l2</strong></span>
<span class="strong"><strong>print l3</strong></span>
</pre></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note28"/>Note</h3><p>Note that for the <code class="literal">NumPy</code> arrays, the <code class="literal">+</code> operator is redefined to represent vector/matrix addition.</p></div></div><p>The multiplication operator (<code class="literal">*</code>) can be used to construct a list by repeating the elements of a given list, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>l4 = 3*[4,-1,5]</strong></span>
<span class="strong"><strong>print l4</strong></span>
</pre></div><p>The most flexible way to construct a list in Python is to use a list comprehension. A full discussion is beyond the scope of this appendix, but the following examples illustrate some of the possibilities:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">To display the list of the squares of the integers from <code class="literal">0</code> to <code class="literal">10</code> (inclusive), use the following command line:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[n ** 2 for n in range(11)]</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To display the list of divisors of an integer, use the following command lines:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>k = 60</strong></span>
<span class="strong"><strong>[d for d in range(1, k+1) if k % d == 0]</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To display the list of prime numbers up to 100, use the following command line (very inefficient):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[k for k in range(2,101) if len([d for d in range(1, k+1) if k % d == 0])==2]</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To display the list of tuples of points with integers coordinates and their distances to the origin, use the following command line:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[(i,j,(i*i+j*j)**0.5) for i in range(5) for j in range(6)]</strong></span>
</pre></div></li></ul></div></div><div class="section" title="Tuples"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec28"/>Tuples</h2></div></div></div><p>Tuples are <a class="indexterm" id="id516"/>similar to lists, but are immutable—once created, their <a class="indexterm" id="id517"/>elements cannot </p><p>be changed. The following command lines will result in an error message:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>t1 = (2,3,5,7)</strong></span>
<span class="strong"><strong>t1[2] = -4</strong></span>
</pre></div><p>Tuples have a few specialized uses in Python. They can be used as indexes in dictionaries (because they are immutable). They also consist of the mechanism that Python uses to return more <a class="indexterm" id="id518"/>than one value from a function. For example, the built-in function <code class="literal">divmod()</code> returns both the integer quotient and remainder in a tuple:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>divmod(213, 43)</strong></span>
</pre></div><p>Tuples support the same sequence interface as lists, except for methods that would modify the tuple. For example, there is no method named <code class="literal">sort()</code> that sorts a tuple in place.</p></div><div class="section" title="Strings"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec29"/>Strings</h2></div></div></div><p>A Python <a class="indexterm" id="id519"/>string represents an immutable sequence of characters. There<a class="indexterm" id="id520"/> are two <a class="indexterm" id="id521"/>string types: <code class="literal">str</code>, representing ASCII <a class="indexterm" id="id522"/>strings, and <code class="literal">unicode</code>, representing Unicode strings.</p><p>A string literal is a sequence of characters enclosed by either single quotes or double quotes, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>s1 = 'I am a string'</strong></span>
<span class="strong"><strong>s2 = "I am a string"</strong></span>
<span class="strong"><strong>print s1</strong></span>
<span class="strong"><strong>print s2</strong></span>
</pre></div><p>There is no semantic difference between single quotes and double quotes, except that a single-quoted string can contain double quotes and a double quoted string can contain single quotes. For example, the following command lines are correct:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>s3 = "I'm a string"</strong></span>
<span class="strong"><strong>print s3</strong></span>
</pre></div><p>Strings are used for two main purposes: as dictionary indexes and to print messages. When printing messages, strings <a class="indexterm" id="id523"/>have the <code class="literal">format()</code> method that allows easy display of information. We use this feature frequently to add annotations to graphics. Here is an example:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>n = 3</strong></span>
<span class="strong"><strong>message = 'The square root of {:d} is approximately {:8.5f}.'.format(n, n ** 0.5)</strong></span>
<span class="strong"><strong>print message</strong></span>
</pre></div><p>In the preceding example, there are two format specifiers:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">{:d}</code>: This <a class="indexterm" id="id524"/>specifies a decimal format for an integer value</li><li class="listitem" style="list-style-type: disc"><code class="literal">{:8.5f}</code>: This <a class="indexterm" id="id525"/>specifies a field of width <code class="literal">8</code> and <code class="literal">5</code> decimals for a floating-point value</li></ul></div><p>The format <a class="indexterm" id="id526"/>specifications are matched (in order) with the arguments, in this case <code class="literal">n</code> and <code class="literal">n ** 0.5</code>.</p><p>Strings have <a class="indexterm" id="id527"/>a rich interface. If you need to code something with strings, it is very likely that there is a built-in function that does the job with very little modification. A list <a class="indexterm" id="id528"/>of all available string methods, as well as formatting features, is available at <a class="ulink" href="https://docs.python.org/2/library/stdtypes.html#string-methods">https://docs.python.org/2/library/stdtypes.html#string-methods</a>.</p></div></div>
<div class="section" title="Dictionaries"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec39"/>Dictionaries</h1></div></div></div><p>Python<a class="indexterm" id="id529"/> dictionaries are a data structure that contains key-item pairs. The keys must be immutable types, usually strings or tuples. Here is an example that shows how to construct a dictionary:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>grades = {'Pete':87, 'Annie':92, 'Jodi':78}</strong></span>
</pre></div><p>To access an item, we provide the key as an index as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>print grades['Annie']</strong></span>
</pre></div><p>Dictionaries are mutable, so we can change the item values using them. If Jodi does extra work to improve her grade, we can change it as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>grades['Jodi'] += 10</strong></span>
<span class="strong"><strong>print grades['Jodi']</strong></span>
</pre></div><p>To add an entry to a dictionary, just assign a value to a new key:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>grades['Ivan']=94</strong></span>
</pre></div><p>However, attempting to access a nonexistent key yields an error.</p><p>An important<a class="indexterm" id="id530"/> point to realize is that dictionaries are not ordered. The following code is a standard idiom to iterate over a dictionary:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>for key, item in grades.iteritems():</strong></span>
<span class="strong"><strong>    print "{:s}'s grade in the test is {:d}".format(key, item)</strong></span>
</pre></div><p>The main point here is that the output is not at all related to the order in which the entries were added to the dictionary.</p><p>For more <a class="indexterm" id="id531"/>details on the dictionary interface, you can refer to <a class="ulink" href="https://docs.python.org/2/library/stdtypes.html#mapping-types-dict">https://docs.python.org/2/library/stdtypes.html#mapping-types-dict</a>.</p></div>
<div class="section" title="Control structures"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec40"/>Control structures</h1></div></div></div><p>Control <a class="indexterm" id="id532"/>structures allow changes to the flow of the execution of code. There are two types of structures that are of interest to us: <span class="strong"><strong>branching</strong></span> and <span class="strong"><strong>looping</strong></span>.</p><p>Branching <a class="indexterm" id="id533"/>allows the execution of different code depending on the result <a class="indexterm" id="id534"/>of a test. The following example shows an improved version of code to solve quadratic equations. An <code class="literal">if-then-else</code> structure is used to handle the cases of real and imaginary solutions, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a, b, c = 2., -4., 5.</strong></span>
<span class="strong"><strong>discr = b ** 2 - 4 * a * c</strong></span>
<span class="strong"><strong>if discr &gt;= 0:</strong></span>
<span class="strong"><strong>    sqroot = discr ** 0.5</strong></span>
<span class="strong"><strong>    x1 = 0.5 * (-b + sqroot)</strong></span>
<span class="strong"><strong>    x2 = 0.5 * (-b - sqroot)</strong></span>
<span class="strong"><strong>else:</strong></span>
<span class="strong"><strong>    sqroot = (-discr) ** 0.5</strong></span>
<span class="strong"><strong>    x1 = 0.5 * (-b + sqroot * 1j)</strong></span>
<span class="strong"><strong>    x2 = 0.5 * (-b - sqroot * 1j)</strong></span>
<span class="strong"><strong>print x1, x2</strong></span>
</pre></div><p>The preceding code starts by computing the discriminant of the quadratic. Then, an <code class="literal">if-then-else</code> statement is used to decide if the roots are real or imaginary, according to the sign of the discriminant. Note the indentation of the code. Indentation is used in Python to define the boundaries of blocks of statements. The general form of the <code class="literal">if-then-else</code> structure is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>if &lt;condition&gt;:</strong></span>
<span class="strong"><strong>     &lt;statement block T&gt;</strong></span>
<span class="strong"><strong>else:</strong></span>
<span class="strong"><strong>     &lt;statement block F&gt;</strong></span>
</pre></div><p>First, the condition <code class="literal">&lt;condition&gt;</code> is evaluated. If it is <code class="literal">True</code>, the statement <code class="literal">&lt;statement block T&gt;</code> is executed. Otherwise, <code class="literal">&lt;statement block F&gt; </code>is executed. The <code class="literal">else:</code> clause can be omitted.</p><p>The most common looping structure in Python is the <code class="literal">for</code> statement. Here is an example:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>numbers = [2, 4, 3, 6, 2, 1, 5, 10]</strong></span>
<span class="strong"><strong>for n in numbers:</strong></span>
<span class="strong"><strong>    r = n % 2</strong></span>
<span class="strong"><strong>    if r == 0:</strong></span>
<span class="strong"><strong>        print 'The integer {:d} is even'.format(n)</strong></span>
<span class="strong"><strong>    else:</strong></span>
<span class="strong"><strong>        print 'The integer {:d} is odd'.format(n)</strong></span>
</pre></div><p>We start by <a class="indexterm" id="id535"/>defining a list of integers. The <code class="literal">for</code> statement makes the variable <code class="literal">n</code> assume each value in the list numbers in succession and execute the indented block for each value. Note that there is an <code class="literal">if-then-else</code> structure inside the <code class="literal">for</code> loop. Also, the <code class="literal">print</code> statements <a class="indexterm" id="id536"/>are doubly-indented.</p><p>A <code class="literal">for</code> loop<a class="indexterm" id="id537"/> is frequently used to perform simple searches. A common scenario is the need to step out of the loop when a certain condition is met. The following code finds the first perfect square in a range of integers:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>for n in range(30, 90):</strong></span>
<span class="strong"><strong>    if int(n ** 0.5) ** 2 == n:</strong></span>
<span class="strong"><strong>        print n</strong></span>
<span class="strong"><strong>        break</strong></span>
</pre></div><p>For each value of <code class="literal">n</code> in the given range, we take the square root of <code class="literal">n</code>, take the integer part, and then calculate its square. If the result is equal to <code class="literal">n</code>, then we go into the <code class="literal">if</code> block, print<code class="literal"> n</code>, and then break out of the loop.</p><p>What if there are no perfect squares in the range? Change the preceding function, <code class="literal">range(30, 60)</code>, to <code class="literal">range(125, 140)</code>. When the command line is run, nothing is printed, since there are no perfect squares between <code class="literal">125</code> and <code class="literal">140</code>. Now, change the command line to the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>for n in range(125, 140):</strong></span>
<span class="strong"><strong>    if int(n ** 0.5) ** 2 == n:</strong></span>
<span class="strong"><strong>        print n</strong></span>
<span class="strong"><strong>        break</strong></span>
<span class="strong"><strong>else:</strong></span>
<span class="strong"><strong>    print 'There are no perfect squares in the range'</strong></span>
</pre></div><p>The <code class="literal">else</code> clause<a class="indexterm" id="id538"/> is only executed if the execution does not break out of the loop, in which case the message is printed.</p><p>Another frequent situation is when some values in the iteration must be skipped. In the following example, we print the square roots of a sequence of random numbers between <code class="literal">-1</code> and <code class="literal">1</code>, but only if the numbers are positive:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>import random</strong></span>
<span class="strong"><strong>numbers = [-1 + 2 * rand() for _ in range(20)]</strong></span>
<span class="strong"><strong>for n in numbers:</strong></span>
<span class="strong"><strong>    if n &lt; 0:</strong></span>
<span class="strong"><strong>        continue</strong></span>
<span class="strong"><strong>    print 'The square root of {:8.6} is {:8.6}'.format(n, n ** 0.5)</strong></span>
</pre></div><p>When Python meets the <code class="literal">continue</code> statement in a loop, it skips the rest of the execution block and continues with the next value of the control variable.</p><p>Another control structure that is frequently used is the <code class="literal">while</code> loop. This structure executes a block of commands as long as a condition is true. For example, suppose we want to compute the running sum <a class="indexterm" id="id539"/>of a list of randomly generated values, but only until the sum is above a certain value. This can be done with the following code:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>import random</strong></span>
<span class="strong"><strong>bound = 10.</strong></span>
<span class="strong"><strong>acc = 0.</strong></span>
<span class="strong"><strong>n = 0</strong></span>
<span class="strong"><strong>while acc &lt; bound:</strong></span>
<span class="strong"><strong>    v = random.random()</strong></span>
<span class="strong"><strong>    acc += v</strong></span>
<span class="strong"><strong>    print 'v={:5.4}, acc={:6.4}'.format(v, acc)</strong></span>
</pre></div><p>Another<a class="indexterm" id="id540"/> common situation that occurs more often than one might expect requires a pattern known as the <span class="strong"><strong>forever loop</strong></span>. This happens when the condition to be checked is not available at the beginning of the loop. The following code, for example, implements the famous <code class="literal">3n+1</code> game:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>n = 7</strong></span>
<span class="strong"><strong>while True:</strong></span>
<span class="strong"><strong>    if n % 2 == 0:</strong></span>
<span class="strong"><strong>        n /= 2</strong></span>
<span class="strong"><strong>    else:</strong></span>
<span class="strong"><strong>        n = 3 * n + 1</strong></span>
<span class="strong"><strong>    print n</strong></span>
<span class="strong"><strong>    if n == 1:</strong></span>
<span class="strong"><strong>        break</strong></span>
</pre></div><p>The game starts with an arbitrary integer, <code class="literal">7</code> in this case. Then, in each iteration, we test whether <code class="literal">n</code> is even. If it is, we divide it by <code class="literal">2</code>; otherwise, multiply it by <code class="literal">3</code> and add <code class="literal">1</code>. Then, we check<a class="indexterm" id="id541"/> whether we reached <code class="literal">1</code>. If yes, we break from the loop. Since we don't know if we have to break until the end of the loop, we use a forever loop as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>while True:</strong></span>
<span class="strong"><strong>   &lt;statements&gt;</strong></span>
<span class="strong"><strong>   if &lt;condition&gt;:</strong></span>
<span class="strong"><strong>        break</strong></span>
<span class="strong"><strong>   &lt;possibly more statements&gt;</strong></span>
</pre></div><p>Some programmers avoid this construct, since it may easily lead to infinite loops if one is careless. However, it turns out to be very handy in certain situations. By the way, it is an open problem if the loop in the <code class="literal">3n+1</code> problem stops for all initial values! Readers may have some fun trying the initial value <code class="literal">n=27</code>.</p><div class="section" title="Functions, objects, and methods"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec30"/>Functions, objects, and methods</h2></div></div></div><p>We now <a class="indexterm" id="id542"/>come to the constructs that really make Python so<a class="indexterm" id="id543"/> flexible and powerful, its object-oriented features. We have<a class="indexterm" id="id544"/> already seen some examples of object-oriented code in the previous sections (the object-oriented paradigm is so integral to Python that is hardly possible to write any code without using it), but now we will have a more specific treatment of these features.</p><div class="section" title="Functions"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec01"/>Functions</h3></div></div></div><p>We have <a class="indexterm" id="id545"/>already seen many examples of functions being used. For example, the <code class="literal">len()</code> function<a class="indexterm" id="id546"/> is used to compute the length of a list:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>lst = range(1000)</strong></span>
<span class="strong"><strong>print len(lst)</strong></span>
</pre></div><p>The most basic syntax for calling a function is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>function_name(arg1, arg2, …, argn)</strong></span>
</pre></div><p>In this <a class="indexterm" id="id547"/>case, <code class="literal">arg1</code>, <code class="literal">arg2</code>, …, <code class="literal">argn</code> are called <span class="strong"><strong>positional arguments</strong></span>, since they are matched according to the position in which they appear. As an example, let's consider the built-in function, <code class="literal">pow()</code>. This function takes up to three arguments:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>pow(b, n, m)</strong></span>
</pre></div><p>In this form, the preceding function uses an optimized algorithm to compute <code class="literal">b</code> raised to the power <code class="literal">n</code> modulo <code class="literal">m</code>. (If you are wondering, this is an important operation in public key cryptography, for example.) The arguments <code class="literal">b</code>, <code class="literal">n</code>, and <code class="literal">m</code> are associated by their position. For example, to compute <code class="literal">12</code> raised to the tenth power modulo <code class="literal">15</code>, we use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>pow(12, 10, 15)</strong></span>
</pre></div><p>Python also supports sequences of arguments of arbitrary size. For example, the <code class="literal">max()</code> function computes the maximum of an arbitrary sequence of values:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>max(2,6,8,-3,3,4)</strong></span>
</pre></div><p>The preceding command returns the value <code class="literal">8</code>.</p><p>A third way to pass<a class="indexterm" id="id548"/> arguments to a function is to use <span class="strong"><strong>keyword arguments</strong></span>. This turns out to be very useful, since it is in general difficult to remember the exact order of positional arguments. (I would prefer not to write a function with more than three or four positional arguments, for example.)</p><p>For example, the <a class="indexterm" id="id549"/>built-in <code class="literal">int()</code> function can be used to convert a string to an integer. The optional keyword argument, <code class="literal">base</code>, lets us specify the base for conversion. For example, the following command line assigns to <code class="literal">n</code>, an integer given in base <code class="literal">2</code>:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>n = int('10111010100001', base=2)</strong></span>
<span class="strong"><strong>print n</strong></span>
</pre></div><p>Keyword arguments always have a default value. In our example, if the base is not specified, it is assumed to be <code class="literal">10</code>.</p><p>We often<a class="indexterm" id="id550"/> need to write our own functions. This is done with the keyword, <code class="literal">def</code>. As an example, let's consider writing code to implement the well-known <code class="literal">bisection</code> method<a class="indexterm" id="id551"/> to solve equations numerically. A possible solution is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>def bisection(f, a, b, tol=1e-5, itermax=1000):</strong></span>
<span class="strong"><strong>    fa = f(a)</strong></span>
<span class="strong"><strong>    fb = f(b)</strong></span>
<span class="strong"><strong>    if fa * fb &gt; 0:</strong></span>
<span class="strong"><strong>        raise ValueError('f(a) and f(b) must have opposite signs')</strong></span>
<span class="strong"><strong>    niter = 0</strong></span>
<span class="strong"><strong>    while abs(a-b) &gt; tol and niter &lt; itermax:</strong></span>
<span class="strong"><strong>        m = 0.5 * (a + b)</strong></span>
<span class="strong"><strong>        fm = f(m)</strong></span>
<span class="strong"><strong>        if fm * fa &lt; 0:</strong></span>
<span class="strong"><strong>            b, fb = m, fm</strong></span>
<span class="strong"><strong>        else:</strong></span>
<span class="strong"><strong>            a, fa = m, fm</strong></span>
<span class="strong"><strong>    return min(a, b), max(a, b)</strong></span>
</pre></div><p>The preceding function takes three important and necessary arguments:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">f</code> function<a class="indexterm" id="id552"/> accepts a float value as input and returns a float value as output</li><li class="listitem" style="list-style-type: disc">The floating-point values, <code class="literal">a</code> and <code class="literal">b</code>, which specify an interval that contains a zero of the function</li></ul></div><p>The other two arguments are optional. The <a class="indexterm" id="id553"/>argument <code class="literal">tol</code> specifies the desired tolerance in<a class="indexterm" id="id554"/> the result and <code class="literal">itermax</code> specifies the maximum number of iterations. To <a class="indexterm" id="id555"/>use the <code class="literal">bisection()</code> function, we must first define the function <code class="literal">f</code>. We will take the opportunity to display another way to define a function in Python, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>from math import cos, pi</strong></span>
<span class="strong"><strong>f = lambda x: cos(x) - x</strong></span>
</pre></div><p>We are now ready to call the function with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>bisection(f, 0, pi/2)</strong></span>
</pre></div><p>The preceding function returns the following output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>(0.7390851262506977, 0.7390911183631504)</strong></span>
</pre></div><p>Note that we designed the function to return an interval containing the zero. The length of the interval is less than <code class="literal">tol</code>, unless the maximum number of iterations is reached. If we want a smaller tolerance, we could use the following function:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>bisection(f, 0, pi/2, tol=1E-10)</strong></span>
</pre></div><p>Now, suppose that we are concerned with the time the computation is taking. We can limit the maximum number as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>bisection(f, 0, pi/2, itermax=10, tol=1E-20)</strong></span>
</pre></div><p>Note that<a class="indexterm" id="id556"/> the order in which the keyword arguments are given is irrelevant and the desired tolerance is not reached in the preceding example.</p></div><div class="section" title="Objects and methods"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec02"/>Objects and methods</h3></div></div></div><p>Objects are<a class="indexterm" id="id557"/> the most general data abstraction in Python. Actually, in<a class="indexterm" id="id558"/> Python, everything is an object from the point of view of<a class="indexterm" id="id559"/> the programmer.</p><p>An object is<a class="indexterm" id="id560"/> nothing more than a collection of structured data, together with an interface to operate on this data. Objects are defined using the <code class="literal">class</code> construct, but our goal <a class="indexterm" id="id561"/>here is not to show how to define classes. Although designing a new class is an advanced topic, using existing classes is pretty straightforward.</p><p>As an example, let's explore the built-in type <code class="literal">str</code>. Let's start by defining a <code class="literal">str</code> object we can play with as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>message = 'Mathematics is the queen of science'</strong></span>
</pre></div><p>To start, let's <a class="indexterm" id="id562"/>convert the message to uppercase as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>message.upper()</strong></span>
</pre></div><p>We say <a class="indexterm" id="id563"/>that the preceding statement calls the <code class="literal">upper()</code> method of the <code class="literal">message</code> object. A <a class="indexterm" id="id564"/>method is simply a function that is associated <a class="indexterm" id="id565"/>to an object. The following are a few other methods of the <code class="literal">str</code> objects:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">To find the first occurrence of a substring (returns <code class="literal">-1</code> if the string is not found), use the following command line:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>message.find('queen')</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To split the string in words, use the following command line:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>words = message.split()</strong></span>
<span class="strong"><strong>print words</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To count the number of occurrences of <code class="literal">s</code> substring, use the following command line<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>message.count('e')</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To replace a substring by something else, use the following command line:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>message.replace('Mathematics', 'Mme. Curie')</strong></span>
</pre></div></li></ul></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note29"/>Note</h3><p>Note that the preceding methods do not change the original string object, but return new modified strings. Strings are immutable. For mutable objects, methods are free to change the data in the object.</p></div></div></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec41"/>Summary</h1></div></div></div><p>In this appendix, we gave an overview of the Python syntax and features, covering basic types, expressions, variables, and assignment, basic data structures, functions, objects, and methods.</p></div></body></html>