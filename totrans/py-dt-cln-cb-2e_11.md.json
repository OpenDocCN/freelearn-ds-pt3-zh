["```py\n    import pandas as pd\n    covidcases = pd.read_csv(\"data/covidcases.csv\") \n    ```", "```py\n    dailyvars = ['casedate','new_cases','new_deaths']\n    totvars = ['location','total_cases','total_deaths']\n    demovars = ['population','population_density',\n    ...   'median_age','gdp_per_capita',\n    ...   'hospital_beds_per_thousand','region']\n    covidcases[dailyvars + totvars + demovars].head(2).T \n    ```", "```py\n     0               1\n    casedate                        2020-03-01      2020-03-15\n    new_cases                                1               6\n    new_deaths                               0               0\n    location                       Afghanistan     Afghanistan\n    total_cases                              1               7\n    total_deaths                             0               0\n    population                        41128772        41128772\n    population_density                      54              54\n    median_age                              19              19\n    gdp_per_capita                       1,804           1,804\n    hospital_beds_per_thousand               0               0\n    region                          South Asia      South Asia \n    ```", "```py\n    coviddaily = covidcases[['location'] + dailyvars]\n    coviddaily.shape \n    ```", "```py\n    (36501, 4) \n    ```", "```py\n    coviddaily.head() \n    ```", "```py\n     location       casedate     new_cases     new_deaths\n    0  Afghanistan     2020-03-01             1              0\n    1  Afghanistan     2020-03-15             6              0\n    2  Afghanistan     2020-03-22            17              0\n    3  Afghanistan     2020-03-29            67              2\n    4  Afghanistan     2020-04-05           183              3 \n    ```", "```py\ncovidcases.location.nunique() \n```", "```py\n231 \n```", "```py\ncoviddemo = \\\n  covidcases[['casedate'] + totvars + demovars].\\\n  sort_values(['location','casedate']).\\\n  drop_duplicates(['location'], keep='last').\\\n  rename(columns={'casedate':'lastdate'})\ncoviddemo.shape \n```", "```py\n(231, 10) \n```", "```py\ncoviddemo.head(2).T \n```", "```py\n 204                379\nlastdate                      2024-02-04         2024-01-28\nlocation                     Afghanistan            Albania\ntotal_cases                      231,539            334,863\ntotal_deaths                       7,982              3,605\npopulation                      41128772            2842318\npopulation_density                    54                105\nmedian_age                            19                 38\ngdp_per_capita                     1,804             11,803\nhospital_beds_per_thousand             0                  3\nregion                        South Asia     Eastern Europe \n```", "```py\ncovidtotals = covidcases.groupby(['location'],\n...   as_index=False).\\\n...   agg({'new_cases':'sum','new_deaths':'sum',\n...     'median_age':'last','gdp_per_capita':'last',\n...     'region':'last','casedate':'last',\n...     'population':'last'}).\\\n...   rename(columns={'new_cases':'total_cases',\n...     'new_deaths':'total_deaths',\n...     'casedate':'lastdate'})\ncovidtotals.head(2).T \n```", "```py\n 0                     1\nlocation              Afghanistan               Albania\ntotal_cases               231,539               334,863\ntotal_deaths                7,982                 3,605\nmedian_age                     19                    38\ngdp_per_capita              1,804                11,803\nregion                 South Asia        Eastern Europe\nlastdate               2024-02-04            2024-01-28\npopulation               41128772               2842318 \n```", "```py\n    import pandas as pd\n    cma = pd.read_csv(\"data/cmacollections.csv\")\n    cma['category'] = cma.category.str.strip().str[0:15]\n    cma['title'] = cma.title.str.strip().str[0:30] \n    ```", "```py\ncma.shape \n```", "```py\n(17001, 9) \n```", "```py\ncma.head(4).T \n```", "```py\n 0                      1  \\\nitemid                         75551                  75551  \ncitation             Purrmann, Hans.        <em>Henri Matis  \ncreatorid                      2,130                  2,130  \ncreator              Henri Matisse (        Henri Matisse (  \ntitle                         Tulips                 Tulips  \nbirth_year                      1869                   1869  \ndeath_year                      1954                   1954  \ncategory             Mod Euro - Pain        Mod Euro - Pain  \ncreation_date                   1914                   1914  \n                                   2                      3 \nitemid                         75551                  75551 \ncitation             Flam, Jack D. <        <em>Masters of  \ncreatorid                      2,130                  2,130 \ncreator              Henri Matisse (        Henri Matisse ( \ntitle                         Tulips                 Tulips \nbirth_year                      1869                   1869 \ndeath_year                      1954                   1954 \ncategory             Mod Euro - Pain        Mod Euro - Pain \ncreation_date                   1914                   1914 \n```", "```py\ncma.itemid.nunique() \n```", "```py\n986 \n```", "```py\ncma.drop_duplicates(['itemid','citation']).\\\n  itemid.count() \n```", "```py\n12941 \n```", "```py\ncma.drop_duplicates(['itemid','creatorid']).\\\n  itemid.count() \n```", "```py\n1062 \n```", "```py\ncma.set_index(['itemid'], inplace=True)\ncma.loc[124733, ['title','citation',\n  'creation_date','creator','birth_year']].head(6) \n```", "```py\n title              citation  \\\nitemid                                     \n124733       Dead Blue Roller       Weigel, J. A. G  \n124733       Dead Blue Roller       Weigel, J. A. G  \n124733       Dead Blue Roller       Winkler, Friedr  \n124733       Dead Blue Roller       Winkler, Friedr  \n124733       Dead Blue Roller       Francis, Henry   \n124733       Dead Blue Roller       Francis, Henry   \n            creation_date               creator birth_year \nitemid                                                \n124733               1583       Hans Hoffmann (       1545 \n124733               1583       Albrecht Dürer        1471 \n124733               1583       Hans Hoffmann (       1545 \n124733               1583       Albrecht Dürer        1471 \n124733               1583       Hans Hoffmann (       1545 \n124733               1583       Albrecht Dürer        1471 \n```", "```py\n    collectionsvars = \\\n      ['title','category','creation_date']\n    cmacollections = cma[collectionsvars].\\\n      reset_index().\\\n      drop_duplicates(['itemid']).\\\n      set_index(['itemid'])\n    cmacollections.shape \n    ```", "```py\n    (986, 3) \n    ```", "```py\n    cmacollections.head() \n    ```", "```py\n     title  \\\n    itemid                                  \n    75551                           Tulips  \n    75763   Procession or Pardon at Perros  \n    78982       The Resurrection of Christ  \n    84662                The Orange Christ  \n    86110   Sunset Glow over a Fishing Vil  \n                 category   creation_date \n    itemid                                \n    75551   Mod Euro - Pain          1914 \n    75763   Mod Euro - Pain          1891 \n    78982   P - German befo          1622 \n    84662   Mod Euro - Pain          1889 \n    86110   ASIAN - Hanging   1460s–1550s \n    ```", "```py\n    cmacollections.loc[124733] \n    ```", "```py\n    title            Dead Blue Roller\n    category              DR - German\n    creation_date                1583\n    Name: 124733, dtype: object \n    ```", "```py\ncmacitations = cma[['citation']].\\\n  reset_index().\\\n  drop_duplicates(['itemid','citation']).\\\n  set_index(['itemid'])\ncmacitations.loc[124733] \n```", "```py\n citation\nitemid                     \n124733       Weigel, J. A. G\n124733       Winkler, Friedr\n124733       Francis, Henry\n124733       Kurz, Otto. <em\n124733       Minneapolis Ins\n124733       Pilz, Kurt. \"Ha\n124733       Koschatzky, Wal\n124733       Johnson, Mark M\n124733       Kaufmann, Thoma\n124733        Koreny, Fritz.\n124733       Achilles-Syndra\n124733       Schoch, Rainer,\n124733       DeGrazia, Diane\n124733       Dunbar, Burton \n```", "```py\n    creatorsvars = \\\n      ['creator','birth_year','death_year']\n    cmacreators = cma[creatorsvars].\\\n      reset_index().\\\n      drop_duplicates(['itemid','creator']).\\\n      set_index(['itemid'])\n    cmacreators.loc[124733] \n    ```", "```py\n     creator        birth_year      death_year\n    itemid                                                     \n    124733     Hans Hoffmann (             1545            1592\n    124733     Albrecht Dürer              1471            1528 \n    ```", "```py\ncmacreators['birth_year'] = \\\n  cmacreators.birth_year.str.\\\n  findall(\"\\d+\").str[0].astype(float)\nyoungartists = \\\n  cmacreators.loc[cmacreators.birth_year>1950,\n  ['creator']].assign(creatorbornafter1950='Y')\nyoungartists.shape[0]==youngartists.index.nunique() \n```", "```py\nTrue \n```", "```py\nyoungartists \n```", "```py\n creator creatorbornafter1950\nitemid                                     \n168529  Richard Barnes                     Y\n369885  Simone Leigh (A                    Y\n371392  Belkis Ayón (Cu                    Y\n378931  Teresa Margolle                    Y \n```", "```py\n    cmacollections = \\\n      pd.merge(cmacollections, youngartists,\n      left_on=['itemid'], right_on=['itemid'], how='left')\n    cmacollections.fillna({'creatorbornafter1950':'N'}, inplace=True)\n    cmacollections.shape \n    ```", "```py\n    (986, 9) \n    ```", "```py\n    cmacollections.creatorbornafter1950.value_counts() \n    ```", "```py\n    creatorbornafter1950\n    N    982\n    Y      4\n    Name: count, dtype: int64 \n    ```", "```py\nyoungartists.shape[0]==youngartists.index.nunique() \n```", "```py\n    import pandas as pd\n    nls97 = pd.read_csv(\"data/nls97g.csv\", low_memory=False) \n    ```", "```py\nnls97.set_index(['originalid'], inplace=True)\nweeksworkedcols = ['weeksworked17','weeksworked18',\n  'weeksworked19','weeksworked20','weeksworked21']\nnls97.loc[[2,3],weeksworkedcols].T \n```", "```py\noriginalid          2       3\nweeksworked17      52      52\nweeksworked18      52      52\nweeksworked19      52       9\nweeksworked20      52       0\nweeksworked21      46       0 \n```", "```py\nnls97.shape \n```", "```py\n(8984, 110) \n```", "```py\nweeksworked = nls97[weeksworkedcols].\\\n  stack().\\\n  reset_index().\\\n  rename(columns={'level_1':'year',0:'weeksworked'})\nweeksworked.loc[weeksworked.originalid.isin([2,3])] \n```", "```py\n originalid                year       weeksworked\n5            2       weeksworked17                52\n6            2       weeksworked18                52\n7            2       weeksworked19                52\n8            2       weeksworked20                52\n9            2       weeksworked21                46\n10           3       weeksworked17                52\n11           3       weeksworked18                52\n12           3       weeksworked19                 9\n13           3       weeksworked20                 0\n14           3       weeksworked21                 0 \n```", "```py\nweeksworked['year'] = \\\n  weeksworked.year.str[-2:].astype(int)+2000\nweeksworked.loc[weeksworked.originalid.isin([2,3])] \n```", "```py\n originalid       year       weeksworked\n5                 2       2017                52\n6                 2       2018                52\n7                 2       2019                52\n8                 2       2020                52\n9                 2       2021                46\n10                3       2017                52\n11                3       2018                52\n12                3       2019                 9\n13                3       2020                 0\n14                3       2021                 0 \n```", "```py\nweeksworked.shape \n```", "```py\n(44920, 3) \n```", "```py\nweeksworked = nls97.reset_index().\\\n  loc[:,['originalid'] + weeksworkedcols].\\\n  melt(id_vars=['originalid'],\n  value_vars=weeksworkedcols,\n  var_name='year', value_name='weeksworked')\nweeksworked['year'] = \\\n  weeksworked.year.str[-2:].astype(int)+2000\nweeksworked.set_index(['originalid'], inplace=True)\nweeksworked.loc[[2,3]] \n```", "```py\n year       weeksworked\noriginalid                       \n2                2017                52\n2                2018                52\n2                2019                52\n2                2020                52\n2                2021                46\n3                2017                52\n3                2018                52\n3                2019                 9\n3                2020                 0\n3                2021                 0 \n```", "```py\ncolenrcols = \\\n  ['colenroct17','colenroct18','colenroct19',\n  'colenroct20','colenroct21']\ncolenr = nls97.reset_index().\\\n  loc[:,['originalid'] + colenrcols].\\\n  melt(id_vars=['originalid'], value_vars=colenrcols,\nvar_name='year', value_name='colenr')\ncolenr['year'] = colenr.year.str[-2:].astype(int)+2000\ncolenr.set_index(['originalid'], inplace=True)\ncolenr.loc[[2,3]] \n```", "```py\n year                     colenr\noriginalid                                \n2                2017            1\\. Not enrolled\n2                2018            1\\. Not enrolled\n2                2019            1\\. Not enrolled\n2                2020            1\\. Not enrolled\n2                2021            1\\. Not enrolled\n3                2017            1\\. Not enrolled\n3                2018            1\\. Not enrolled\n3                2019            1\\. Not enrolled\n3                2020            1\\. Not enrolled\n3                2021            1\\. Not enrolled \n```", "```py\n    workschool = \\\n      pd.merge(weeksworked, colenr, on=['originalid','year'], how=\"inner\")\n    workschool.shape \n    ```", "```py\n    (44920, 3) \n    ```", "```py\n    workschool.loc[[2,3]] \n    ```", "```py\n     year       weeksworked                colenr\n    originalid                                        \n    2           2017                52       1\\. Not enrolled\n    2           2018                52       1\\. Not enrolled\n    2           2019                52       1\\. Not enrolled\n    2           2020                52       1\\. Not enrolled\n    2           2021                46       1\\. Not enrolled\n    3           2017                52       1\\. Not enrolled\n    3           2018                52       1\\. Not enrolled\n    3           2019                 9       1\\. Not enrolled\n    3           2020                 0       1\\. Not enrolled\n    3           2021                 0       1\\. Not enrolled \n    ```", "```py\n    import pandas as pd\n    nls97 = pd.read_csv(\"data/nls97g.csv\", low_memory=False)\n    nls97.set_index('personid', inplace=True) \n    ```", "```py\n    weeksworkedcols = ['weeksworked17','weeksworked18',\n      'weeksworked19','weeksworked20','weeksworked21']\n    colenrcols = ['colenroct17','colenroct18',\n       'colenroct19','colenroct20','colenroct21']\n    nls97.loc[nls97.originalid.isin([2,3]),\n      ['originalid'] + weeksworkedcols + colenrcols].T \n    ```", "```py\n    personid                     999406                151672\n    originalid                        2                     3\n    weeksworked17                    52                    52\n    weeksworked18                    52                    52\n    weeksworked19                    52                     9\n    weeksworked20                    52                     0\n    weeksworked21                    46                     0\n    colenroct17         1\\. Not enrolled       1\\. Not enrolled\n    colenroct18         1\\. Not enrolled       1\\. Not enrolled\n    colenroct19         1\\. Not enrolled       1\\. Not enrolled\n    colenroct20         1\\. Not enrolled       1\\. Not enrolled\n    colenroct21         1\\. Not enrolled       1\\. Not enrolled \n    ```", "```py\nworkschool = pd.wide_to_long(nls97[['originalid']\n...   + weeksworkedcols + colenrcols],\n...   stubnames=['weeksworked','colenroct'],\n...   i=['originalid'], j='year').reset_index()\nworkschool['year'] = workschool.year+2000\nworkschool = workschool.\\\n...   sort_values(['originalid','year'])\nworkschool.set_index(['originalid'], inplace=True)\nworkschool.loc[[2,3]] \n```", "```py\n year       weeksworked             colenroct\noriginalid                                        \n2                2017                52       1\\. Not enrolled\n2                2018                52       1\\. Not enrolled\n2                2019                52       1\\. Not enrolled\n2                2020                52       1\\. Not enrolled\n2                2021                46       1\\. Not enrolled\n3                2017                52       1\\. Not enrolled\n3                2018                52       1\\. Not enrolled\n3                2019                 9       1\\. Not enrolled\n3                2020                 0       1\\. Not enrolled\n3                2021                 0       1\\. Not enrolled \n```", "```py\nweeksworkedcols = ['weeksworked16','weeksworked18',\n  'weeksworked19','weeksworked20','weeksworked21']\nworkschool = pd.wide_to_long(nls97[['originalid']\n...   + weeksworkedcols + colenrcols],\n...   stubnames=['weeksworked','colenroct'],\n...   i=['originalid'], j='year').reset_index()\nworkschool['year'] = workschool.year+2000\nworkschool = workschool.sort_values(['originalid','year'])\nworkschool.set_index(['originalid'], inplace=True)\nworkschool.loc[[2,3]] \n```", "```py\n year       weeksworked             colenroct\noriginalid                                                  \n2                2016                53                   NaN\n2                2017               NaN       1\\. Not enrolled\n2                2018                52       1\\. Not enrolled\n2                2019                52       1\\. Not enrolled\n2                2020                52       1\\. Not enrolled\n2                2021                46       1\\. Not enrolled\n3                2016                53                   NaN\n3                2017               NaN       1\\. Not enrolled\n3                2018                52       1\\. Not enrolled\n3                2019                 9       1\\. Not enrolled\n3                2020                 0       1\\. Not enrolled\n3                2021                 0       1\\. Not enrolled \n```", "```py\n    import pandas as pd\n    nls97 = pd.read_csv(\"data/nls97g.csv\", low_memory=False)\n    nls97.set_index(['originalid'], inplace=True) \n    ```", "```py\nweeksworkedcols = ['weeksworked17','weeksworked18',\n  'weeksworked19','weeksworked20','weeksworked21']\nweeksworkedstacked = nls97[weeksworkedcols].\\\n  stack()\nweeksworkedstacked.loc[[2,3]] \n```", "```py\noriginalid              \n2           weeksworked17        52\n            weeksworked18        52\n            weeksworked19        52\n            weeksworked20        52\n            weeksworked21        46\n3           weeksworked17        52\n            weeksworked18        52\n            weeksworked19         9\n            weeksworked20         0\n            weeksworked21         0\ndtype: float64 \n```", "```py\nweeksworkedmelted = nls97.reset_index().\\\n...   loc[:,['originalid'] + weeksworkedcols].\\\n...   melt(id_vars=['originalid'],\n...   value_vars=weeksworkedcols,\n...   var_name='year', value_name='weeksworked')\nweeksworkedmelted.loc[weeksworkedmelted.\\\n  originalid.isin([2,3])].\\\n  sort_values(['originalid','year']) \n```", "```py\n originalid                year       weeksworked\n1                    2       weeksworked17                52\n8985                 2       weeksworked18                52\n17969                2       weeksworked19                52\n26953                2       weeksworked20                52\n35937                2       weeksworked21                46\n2                    3       weeksworked17                52\n8986                 3       weeksworked18                52\n17970                3       weeksworked19                 9\n26954                3       weeksworked20                 0\n35938                3       weeksworked21                 0 \n```", "```py\n    weeksworked = weeksworkedstacked.unstack()\n    weeksworked.loc[[2,3]].T \n    ```", "```py\n    originalid          2       3\n    weeksworked17      52      52\n    weeksworked18      52      52\n    weeksworked19      52       9\n    weeksworked20      52       0\n    weeksworked21      46       0 \n    ```", "```py\nweeksworked = weeksworkedmelted.\\\n...   pivot(index='originalid',\n...   columns='year', values=['weeksworked']).\\\n...   reset_index()\nweeksworked.columns = ['originalid'] + \\\n...   [col[1] for col in weeksworked.columns[1:]]\nweeksworked.loc[weeksworked.originalid.isin([2,3])].T \n```", "```py\n 1       2\noriginalid          2       3\nweeksworked17      52      52\nweeksworked18      52      52\nweeksworked19      52       9\nweeksworked20      52       0\nweeksworked21      46       0 \n```"]