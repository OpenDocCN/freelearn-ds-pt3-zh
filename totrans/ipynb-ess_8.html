<html><head></head><body><div class="appendix" title="Appendix&#xA0;C.&#xA0;NumPy Arrays"><div class="titlepage"><div><div><h1 class="title"><a id="appC"/>Appendix C. NumPy Arrays</h1></div></div></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec42"/>Introduction</h1></div></div></div><p>Arrays are the fundamental data structure introduced by <code class="literal">NumPy</code>, and they are the base of all libraries for scientific computing and data analysis we discussed in this book. This appendix will give a brief overview of the following array features:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Array creation and member access</li><li class="listitem" style="list-style-type: disc">Indexing and slicing</li></ul></div></div></div>
<div class="section" title="Array creation and member access"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec43"/>Array creation and member access</h1></div></div></div><p>
<code class="literal">NumPy</code> arrays are objects of the <code class="literal">ndarray</code> class, which represents a fixed-size multidimensional <a class="indexterm" id="id566"/>collection of homogeneous data.</p><p>Here, we <a class="indexterm" id="id567"/>will assume that the <code class="literal">NumPy</code> library has been imported<a class="indexterm" id="id568"/> using the following command line:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>import numpy as np</strong></span>
</pre></div><p>Once we have done that, we can create <code class="literal">ndarray</code> (from now on, informally called <span class="strong"><strong>array object</strong></span><a class="indexterm" id="id569"/> or simply <span class="strong"><strong>array</strong></span>) from a list of lists as indicated in the following command line:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a = np.array([[-2,3,-4,0],[2,-7,0,0],[3,-4,2,1]],dtype=np.float64)</strong></span>
<span class="strong"><strong>print a</strong></span>
</pre></div><p>Contrary to Python lists and tuples, all entries of an array object must be of the same type. The types themselves are represented by <code class="literal">NumPy</code> objects and are referred to as <code class="literal">dtype</code> (from data type) of the array. In the preceding example, we explicitly specify <code class="literal">dtype</code> as <code class="literal">float64</code>, which represents a 64-bit floating-point value.</p><p>Arrays have several attributes that give information about the data layout. The more commonly used ones are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The<a class="indexterm" id="id570"/> shape of the array is computed using the following<a class="indexterm" id="id571"/> command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a.shape</strong></span>
</pre></div><p>The preceding command returns the tuple <code class="literal">(3, 4)</code>, since this is a two-dimensional array with three rows and four columns. Somewhat surprisingly, the shape attribute is not read-only and we can use it to <span class="emphasis"><em>reshape</em></span> the array:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a.shape = (6,2)</strong></span>
<span class="strong"><strong>print a</strong></span>
</pre></div><p>After running the preceding example, run <code class="literal">a.shape(3,4)</code> to return to the original dimensions.</p></li><li class="listitem" style="list-style-type: disc">The number of dimensions of the array is obtained using the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a.ndim</strong></span>
</pre></div><p>This, of course, returns <code class="literal">2</code>. An important notion in <code class="literal">NumPy</code> is the idea of <span class="emphasis"><em>axes</em></span> of an array. A two dimensional array has two axes, numbered 0 and 1. If we think of the array as representing a mathematical matrix, axis 0 is vertical and points down, and axis 1 is horizontal and points to the<a class="indexterm" id="id572"/> right. Certain array methods have an optional <code class="literal">axis</code> keyword argument that lets the user specify along which axis the operation is performed.</p></li><li class="listitem" style="list-style-type: disc">To get the number of elements in the array, we can use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a.size</strong></span>
</pre></div><p>In the preceding example, the output returned is <code class="literal">12</code>, as expected.</p></li><li class="listitem" style="list-style-type: disc">One final attribute of arrays is computing the <span class="emphasis"><em>transpose</em></span> of an array. This can be done using the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>b = a.T</strong></span>
<span class="strong"><strong>print b</strong></span>
</pre></div><p>An important thing that this creates is a <span class="emphasis"><em>view</em></span> of the array <code class="literal">a</code>. The <code class="literal">NumPy</code> package is designed to work efficiently with very large arrays, and in most cases, avoids making copies of data unless absolutely necessary, or is <a class="indexterm" id="id573"/>explicitly directed to do so.</p></li><li class="listitem" style="list-style-type: disc">Run the <a class="indexterm" id="id574"/>following lines of code:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>print a</strong></span>
<span class="strong"><strong>b[1,2] = 11</strong></span>
<span class="strong"><strong>print a</strong></span>
</pre></div><p>Note that the entry <code class="literal">2, 1</code> of the array <code class="literal">a</code> is changed, demonstrating that both variables, <code class="literal">a</code> and <code class="literal">b</code>, point to the same area in memory.</p></li><li class="listitem" style="list-style-type: disc">An array with uninitialized data can be created with the <code class="literal">empty()</code> function as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>c = np.empty(shape=(3,2), dtype=np.float64)</strong></span>
<span class="strong"><strong>print c</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">Using uninitialized data is not recommended, so it is perhaps preferable to use either the <code class="literal">zeros()</code> or <code class="literal">ones()</code> function as follows:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">To use<a class="indexterm" id="id575"/> the <code class="literal">zeros()</code> function, execute the following command lines:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>d = np.zeros(shape=(3,2), dtype=np.float64)</strong></span>
<span class="strong"><strong>print d</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To use <a class="indexterm" id="id576"/>the <code class="literal">ones()</code> function, execute the following command lines:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>e = np.ones(shape=(3,2), dtype=np.float64)</strong></span>
<span class="strong"><strong>print e</strong></span>
</pre></div><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a_like = np.zeros_like(a)</strong></span>
<span class="strong"><strong>print a_like</strong></span>
</pre></div></li></ul></div><p>There are also functions that create new arrays with the same shape and data type of an existing array:</p></li><li class="listitem" style="list-style-type: disc">The<a class="indexterm" id="id577"/> functions <code class="literal">ones_like()</code> and <code class="literal">empty_like()</code> produce <a class="indexterm" id="id578"/>arrays of ones and uninitialized data with the same shape as a given array.</li><li class="listitem" style="list-style-type: disc"><code class="literal">NumPy</code> also has<a class="indexterm" id="id579"/> the <code class="literal">eye()</code> function that returns an <a class="indexterm" id="id580"/>identity <a class="indexterm" id="id581"/>array of the given dimension and <code class="literal">dtype</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>f = np.eye(5, dtype=np.float64)</strong></span>
<span class="strong"><strong>print f</strong></span>
</pre></div><p>The number of rows and columns do not have to be the same. In this case, the resulting matrix will only be a left- or right- identity, as applicable:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>g = np.eye(5, 3, dtype=np.float64)</strong></span>
<span class="strong"><strong>print g</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">Arrays can also be created from existing data. The <code class="literal">copy()</code> function clones an array as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>aa = np.copy(a)</strong></span>
<span class="strong"><strong>print a</strong></span>
<span class="strong"><strong>print aa</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">The <code class="literal">frombuffer()</code> function<a class="indexterm" id="id582"/> creates an array from an object that exposes the (one-dimensional) buffer interface. Here is an example:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>ar = np.arange(0.0, 1.0, 0.1, dtype=np.float64)</strong></span>
<span class="strong"><strong>v = np.frombuffer(ar)</strong></span>
<span class="strong"><strong>v.shape = (2, 5)</strong></span>
<span class="strong"><strong>print v</strong></span>
</pre></div><p>The<a class="indexterm" id="id583"/> <code class="literal">arange()</code> function is a <code class="literal">NumPy</code> extension of the Python range. It has a similar syntax, but allows ranges of floating-point values.</p></li><li class="listitem" style="list-style-type: disc">The <code class="literal">loadtxt()</code> function<a class="indexterm" id="id584"/> reads an array from a text file. Suppose the text file <code class="literal">matrix.txt</code> contains the following data:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong> 1.3  4.6  7.8</strong></span>
<span class="strong"><strong>-3.6  0.4  3.54</strong></span>
<span class="strong"><strong> 2.4  1.7  4.5</strong></span>
</pre></div><p>Then, we can read the data with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>h = np.loadtxt('matrix.txt', dtype=np.float64)</strong></span>
<span class="strong"><strong>print h</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">Arrays<a class="indexterm" id="id585"/> can<a class="indexterm" id="id586"/> also be saved and loaded in the <code class="literal">.npy</code> format:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>np.save('matrix.npy',h)</strong></span>
<span class="strong"><strong>hh = np.load('matrix.npy')</strong></span>
<span class="strong"><strong>print hh</strong></span>
</pre></div></li></ul></div></div>
<div class="section" title="Indexing and Slicing"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec44"/>Indexing and Slicing</h1></div></div></div><p>To illustrate<a class="indexterm" id="id587"/> indexing, let's first create an array with random data using the <a class="indexterm" id="id588"/>following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>import numpy.random</strong></span>
<span class="strong"><strong>a = np.random.rand(6,5)</strong></span>
<span class="strong"><strong>print a</strong></span>
</pre></div><p>This creates an array of dimension <code class="literal">(6,5)</code> that contains random data. Individual elements of the array are accessed with the usual index notation, for example, <code class="literal">a[2,4]</code>.</p><p>An important <a class="indexterm" id="id589"/>technique to manipulate data in <code class="literal">NumPy</code> is the use of <span class="strong"><strong>slices</strong></span>. A slice can be thought of as a subarray of an array. For example, let's say we want to extract a subarray with the middle two rows and first two columns of the array <code class="literal">a</code>. Consider the following command lines:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>b = a[2:4,0:2]</strong></span>
<span class="strong"><strong>print b</strong></span>
</pre></div><p>Now, let's make a very important observation. <span class="emphasis"><em>A slice is simply a view of an array, and no data is actually copied</em></span>. This can be seen by running the following commands:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>b[0,0]=0</strong></span>
<span class="strong"><strong>print a</strong></span>
</pre></div><p>So, changes in <code class="literal">b</code> affect the array <code class="literal">a</code>! If we really need a copy, we need to explicitly say we want one. This can be done using the following command line:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>c = np.copy(a[2:4,0:2])</strong></span>
<span class="strong"><strong>c[0,0] = -1</strong></span>
<span class="strong"><strong>print a</strong></span>
</pre></div><p>In the slice notation <code class="literal">i:j</code>, we can omit either <code class="literal">i</code> or <code class="literal">j</code>, in which case the slice refers to the beginning or end of the corresponding axis:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>print a[:4,3:]</strong></span>
</pre></div><p>Omitting both <code class="literal">i</code> and <code class="literal">j</code> refers to a whole axis:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>print a[:,2:4]</strong></span>
</pre></div><p>Finally, we<a class="indexterm" id="id590"/> can use the notation <code class="literal">i:j:k</code> to specify a stride <code class="literal">k</code> in the slice. In the <a class="indexterm" id="id591"/>following example, we first create a larger random array to illustrate this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>a = np.random.rand(10,6)</strong></span>
<span class="strong"><strong>print a</strong></span>
<span class="strong"><strong>print</strong></span>
<span class="strong"><strong>print a[1:7:2,5:0:-3]</strong></span>
</pre></div><p>Let's now consider slices of higher dimensional arrays. We will start by creating a really large three-dimensional array as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>d1, d2, d3 = 4, 5, 3</strong></span>
<span class="strong"><strong>a = np.random.rand(d1, d2, d3)</strong></span>
<span class="strong"><strong>print a</strong></span>
</pre></div><p>Suppose we want to extract all elements with index <code class="literal">1</code> in the last axis. This can be done easily using an ellipsis object as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>print a[...,1]</strong></span>
</pre></div><p>The preceding command line is equivalent to the following one:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>print a[:,:,1]</strong></span>
</pre></div><p>It is also possible to augment the matrix along an axis when slicing, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>print a[0, :, np.newaxis, 0]</strong></span>
</pre></div><p>Compare the output of the preceding command line with the output of the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>print a[0, :, 0]</strong></span>
</pre></div></div></body></html>